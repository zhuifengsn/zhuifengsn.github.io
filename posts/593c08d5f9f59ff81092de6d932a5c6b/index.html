<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>nfs服务器搭建 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="nfs服务器搭建" />
<meta property="og:description" content="概述 NFS：Network File System（网络文件系统），NFS只是一种文件系统，本身并没有传输功能，是基于RPC协议实现的，为C/S架构。也就是说，NFS也只是文件系统而已，与jffs2,yaffs,ext4等是一类东西。但是NFS的特殊之处在于，它可以通过网络来挂载文件系统，而不用烧写到设备上，从而方便我们调试。这就跟早期的网吧里使用PXE启动来搭建无盘系统一样：每台电脑并没有安装硬盘，而是直接通过PXE启动服务器上的系统，看起来每台电脑都有硬盘，其实都是挂载服务器上的硬盘。
nfs服务器安装 不同的ubuntu，安装nfs的方法不同，本教程使用的是18.04版本，nfs的安装很简单，直接在网上获取并安装即可，见如下命令。
安装服务器端 sudo apt-get install nfs-kernel-server
安装客户端 sudo apt-get install nfs-common
关闭防火墙 ufw disable
root目录创建 创建rootfs文件夹 与tftp有些类似，并不是ubuntu中所有文件夹都可以进行网络传输或访问，必须指定固有的文件夹。因此我们创建一个专用文件夹。
mkdir /home/hudaizhou/sound_code/rootfs/rootfs
修改可执行权限 chmod 777 -R /home/hudaizhou/sound_code/rootfs/rootfs
配置export export是用来指定可以用来做网络传输的文件夹，我们在export文件中添加该目录，如下：
sudo vi /etc/exports
添加：
/home/hudaizhou/sound_code/rootfs/rootfs *(rw,sync,no_root_squash,no_subtree_check)
命令释义：
* 是IP地址rw：读写操作sync: 在应用之前将任何更改写入光盘no_subtree_check：阻止子树检查 导出共享目录 sudo exportfs -a
重启服务器 sudo systemctl restart nfs-kernel-server
查看nfs的rootfs文件夹目录 showmount localhost -e
本地测试 挂载 sudo mount -t nfs -o nolock 192.168.10.51:/home/hudaizhou/sound_code/rootfs/rootfs /opt
到/opt目录查看rootfs的文件是否显示。
卸载 每次用完后需要卸载不然会影响opt目录：
umount /opt" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/593c08d5f9f59ff81092de6d932a5c6b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-30T10:37:56+08:00" />
<meta property="article:modified_time" content="2021-11-30T10:37:56+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">nfs服务器搭建</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:center;"></p> 
<h2 style="margin-left:0px;text-align:left;"><strong>概述</strong></h2> 
<p style="margin-left:0;text-align:left;">        NFS：Network File System（网络文件系统），NFS只是一种文件系统，本身并没有传输功能，是基于RPC协议实现的，为C/S架构。也就是说，NFS也只是文件系统而已，与jffs2,yaffs,ext4等是一类东西。但是NFS的特殊之处在于，它可以通过网络来挂载文件系统，而不用烧写到设备上，从而方便我们调试。这就跟早期的网吧里使用PXE启动来搭建无盘系统一样：每台电脑并没有安装硬盘，而是直接通过PXE启动服务器上的系统，看起来每台电脑都有硬盘，其实都是挂载服务器上的硬盘。</p> 
<h2 style="margin-left:0px;text-align:left;"><strong>nfs服务器安装</strong></h2> 
<p style="margin-left:0;text-align:left;">        不同的ubuntu，安装nfs的方法不同，本教程使用的是18.04版本，nfs的安装很简单，直接在网上获取并安装即可，见如下命令。</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>安装服务器端</strong></h3> 
<p style="margin-left:0;text-align:left;">        sudo apt-get install nfs-kernel-server</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>安装客户端</strong></h3> 
<p style="margin-left:0;text-align:left;">        sudo apt-get install nfs-common</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>关闭防火墙</strong></h3> 
<p style="margin-left:0;text-align:left;">        ufw disable</p> 
<h2 style="margin-left:0px;text-align:left;"><strong>root目录创建</strong></h2> 
<h3 style="margin-left:0px;text-align:left;"><strong>创建rootfs文件夹</strong></h3> 
<p style="margin-left:0;text-align:justify;">        与tftp有些类似，并不是ubuntu中所有文件夹都可以进行网络传输或访问，必须指定固有的文件夹。因此我们创建一个专用文件夹。</p> 
<p style="margin-left:0;text-align:justify;">        mkdir  /home/hudaizhou/sound_code/rootfs/rootfs</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>修改可执行权限</strong></h3> 
<p style="margin-left:0;text-align:justify;">        chmod 777 -R /home/hudaizhou/sound_code/rootfs/rootfs</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>配置export</strong></h3> 
<p style="margin-left:0;text-align:justify;">        export是用来指定可以用来做网络传输的文件夹，我们在<a name="_Hlk77532957" title="export">export</a>文件中添加该目录，如下：</p> 
<p style="margin-left:0;text-align:justify;">        sudo vi /etc/exports</p> 
<p style="margin-left:0;text-align:justify;">添加：</p> 
<p style="margin-left:0;text-align:justify;">/home/hudaizhou/sound_code/rootfs/rootfs *(rw,sync,no_root_squash,no_subtree_check)</p> 
<p style="margin-left:0;text-align:justify;">命令释义：</p> 
<ol><li style="text-align:justify;">* 是IP地址</li><li style="text-align:justify;">rw：读写操作</li><li style="text-align:justify;">sync: 在应用之前将任何更改写入光盘</li><li style="text-align:justify;">no_subtree_check：阻止子树检查</li></ol> 
<h3 style="margin-left:0px;text-align:left;"><strong>导出共享目录</strong></h3> 
<p style="margin-left:0;text-align:justify;">        sudo exportfs -a</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>重启服务器</strong></h3> 
<p style="margin-left:0;text-align:left;">        sudo systemctl restart nfs-kernel-server</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>查看nfs的rootfs文件夹目录</strong></h3> 
<p style="margin-left:0;text-align:left;">        showmount localhost -e</p> 
<h2 style="margin-left:0px;text-align:left;"><strong>本地测试</strong></h2> 
<h3 style="margin-left:0px;text-align:left;"><strong>挂载</strong></h3> 
<p style="margin-left:0;text-align:justify;">sudo mount -t nfs -o nolock 192.168.10.51:/home/hudaizhou/sound_code/rootfs/rootfs   /opt</p> 
<p style="margin-left:0;text-align:justify;">到/opt目录查看rootfs的文件是否显示。</p> 
<h3 style="margin-left:0px;text-align:left;"><strong>卸载</strong></h3> 
<p style="margin-left:0;text-align:justify;">每次用完后需要卸载不然会影响opt目录：</p> 
<p style="margin-left:0;text-align:justify;">        umount /opt</p> 
<p style="margin-left:0;text-align:left;"><strong>开发板测试</strong></p> 
<p style="margin-left:0;text-align:justify;">        开发板刷机可以正常运行的uboot+kernel+rootfs，要注意的是开发板的系统必须开启了nfs功能。</p> 
<p style="margin-left:0;text-align:left;"><strong>挂载</strong></p> 
<p style="margin-left:0;text-align:justify;">sudo mount -t nfs -o nolock 192.168.10.51:/home/hudaizhou/sound_code/rootfs/rootfs   /opt</p> 
<p style="margin-left:0;text-align:justify;">到/opt目录查看rootfs的文件是否显示。</p> 
<p style="margin-left:0;text-align:left;"><strong>卸载</strong></p> 
<p style="margin-left:0;text-align:justify;">        每次用完后需要卸载不然会影响opt目录：</p> 
<p style="margin-left:0;text-align:justify;">        umount /opt</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/104c383abd1ae8432d83e14b9f840c3b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【免费赠书】6 种在 JavaScript 中清理代码的方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/713309e16d6a75761cd7105b6d984c89/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">taro安装_安装指定版本</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>