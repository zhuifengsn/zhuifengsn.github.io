<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 如何调用python，避免重复造轮子 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C# 如何调用python，避免重复造轮子" />
<meta property="og:description" content="文章目录 原因资源调用python文件需求解决方案1、C#里面运行python引入python文件，再调用其中的方法启动python脚本，监听返回值改造一下，可以入参的python调用查看是否等待python运行完成之后再运行C#如果参数比较复杂 开一个python网络后端 总结 原因 最近有个需求，需要按照填入的参数动态地生成对应word文件。excel文件我还有办法，word文件我是真没办法。我去.NET上面搜了一下C#支持的word编辑库，发现好像就NPOI支持word文件修改。我没办法网上所了好久，终于找到了对应的博客通过反射和泛型去解决模板化的文件填充。然后领导又给了我一个需求。
现在是能够用占位符去替换了，内容是动态的，现在个数也要动态的。比如我一个报表，有A,B,C三项内容，现在能把ABC三项填进去了。现在的需求是有多个ABC，1，5,10,20个。就是只有一个模板但是能自我复制。自己造轮子太麻烦了。
我后来看到python处理这些特别简单，后来我决定，C#去调用python，不重复造轮子。
Tips:我最后在ChatGPT上面找到方法了，国内C#相关的博客也太少了
Tips:我后来发现nuget上面有minWord和minExcel，专门用于模版文件导入导出，我到时候看一下
资源 这个是自己纯手撸了一个代码
C# 生成word文档（NPOI.XWPF）
这个是我网上逛github逛到的
C# MiniWord Gtihub官网
这个是这个作者另一个快速Excel文件，我感觉这个好像很好使
C# MiniExcel Gtihub官网
python的方法
Python docxtpl 操作 Word 模板文档
调用python文件 需求 如果我们要调用python代码或者文件，我们至少要做的一下几步：
主要要求
能执行。至少我能运行python文件有返回。我能知道结果。能入参。我能将参数添加进去能同步。我能等待python运行完了之后再接着运行C#代码。 保证了这个我们就能勉强使用
次要要求
宽松环境。我python版本、C#和.NET 版本都随意。我能随意pip install 任意版本的第三方库好部署：在一个新环境下面好部署。最好文件复制过去就能用。编写简单。我能很快的编写代码高效。保证一定的运行效率稳定。不容易出bug 解决方案 c#调用python的三种方法
1、C#里面运行python 太蠢了，我就直接写了
使用Pythonnet库:
Pythonnet是一个开源项目，可以直接在C#中调用Python。首先，需要在C#项目中安装Pythonnet库。可以使用NuGet包管理器或手动安装。
using System; using Python.Runtime; class Program { static void Main() { using (Py.GIL()) // 获取全局解释器锁 { dynamic py = Py.Import(&#34;module_name&#34;); // 导入Python模块 // 调用Python函数或访问Python对象 dynamic result = py." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/b25d57a332c0b16b259f7ae42330fb17/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-04T21:51:16+08:00" />
<meta property="article:modified_time" content="2023-07-04T21:51:16+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 如何调用python，避免重复造轮子</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_2" rel="nofollow">原因</a></li><li><a href="#_16" rel="nofollow">资源</a></li><li><a href="#python_27" rel="nofollow">调用python文件</a></li><li><ul><li><a href="#_28" rel="nofollow">需求</a></li><li><a href="#_49" rel="nofollow">解决方案</a></li><li><ul><li><a href="#1Cpython_52" rel="nofollow">1、C#里面运行python</a></li><li><a href="#python_79" rel="nofollow">引入python文件，再调用其中的方法</a></li><li><a href="#python_90" rel="nofollow">启动python脚本，监听返回值</a></li><li><ul><li><a href="#python_137" rel="nofollow">改造一下，可以入参的python调用</a></li><li><a href="#pythonC_215" rel="nofollow">查看是否等待python运行完成之后再运行C#</a></li><li><a href="#_247" rel="nofollow">如果参数比较复杂</a></li></ul> 
    </li><li><a href="#python_254" rel="nofollow">开一个python网络后端</a></li></ul> 
  </li></ul> 
  </li><li><a href="#_259" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_2"></a>原因</h2> 
<p>最近有个需求，需要按照填入的参数动态地生成对应word文件。excel文件我还有办法，word文件我是真没办法。我去.NET上面搜了一下C#支持的word编辑库，发现好像就NPOI支持word文件修改。我没办法网上所了好久，终于找到了对应的博客通过反射和泛型去解决模板化的文件填充。然后领导又给了我一个需求。</p> 
<p>现在是能够用占位符去替换了，内容是动态的，现在个数也要动态的。比如我一个报表，有A,B,C三项内容，现在能把ABC三项填进去了。现在的需求是有多个ABC，1，5,10,20个。就是只有一个模板但是能自我复制。自己造轮子太麻烦了。</p> 
<p>我后来看到python处理这些特别简单，后来我决定，C#去调用python，不重复造轮子。</p> 
<p><mark>Tips:我最后在ChatGPT上面找到方法了，国内C#相关的博客也太少了</mark></p> 
<p><mark>Tips:我后来发现nuget上面有minWord和minExcel，专门用于模版文件导入导出，我到时候看一下</mark></p> 
<h2><a id="_16"></a>资源</h2> 
<p>这个是自己纯手撸了一个代码<br> <a href="https://www.cnblogs.com/fger/p/11187954.html" rel="nofollow">C# 生成word文档（NPOI.XWPF）</a><br> 这个是我网上逛github逛到的<br> <a href="https://github.com/mini-software/MiniWord/blob/main/README.zh-CN.md">C# MiniWord Gtihub官网</a><br> 这个是这个作者另一个快速Excel文件，我感觉这个好像很好使<br> <a href="https://github.com/mini-software/MiniExcel">C# MiniExcel Gtihub官网</a></p> 
<p>python的方法<br> <a href="https://blog.csdn.net/hop170001/article/details/124821439">Python docxtpl 操作 Word 模板文档</a></p> 
<h2><a id="python_27"></a>调用python文件</h2> 
<h3><a id="_28"></a>需求</h3> 
<p>如果我们要调用python代码或者文件，我们至少要做的一下几步：</p> 
<p><mark>主要要求</mark></p> 
<ul><li>能执行。至少我能运行python文件</li><li>有返回。我能知道结果。</li><li>能入参。我能将参数添加进去</li><li>能同步。我能等待python运行完了之后再接着运行C#代码。</li></ul> 
<p>保证了这个我们就能勉强使用</p> 
<p><mark>次要要求</mark></p> 
<ul><li>宽松环境。我python版本、C#和.NET 版本都随意。我能随意pip install 任意版本的第三方库</li><li>好部署：在一个新环境下面好部署。最好文件复制过去就能用。</li><li>编写简单。我能很快的编写代码</li><li>高效。保证一定的运行效率</li><li>稳定。不容易出bug</li></ul> 
<h3><a id="_49"></a>解决方案</h3> 
<p><a href="https://blog.csdn.net/qq_36744449/article/details/116134794">c#调用python的三种方法</a></p> 
<h4><a id="1Cpython_52"></a>1、C#里面运行python</h4> 
<p>太蠢了，我就直接写了</p> 
<p>使用Pythonnet库:<br> Pythonnet是一个开源项目，可以直接在C#中调用Python。首先，需要在C#项目中安装Pythonnet库。可以使用NuGet包管理器或手动安装。</p> 
<pre><code class="prism language-java">using <span class="token class-name">System</span><span class="token punctuation">;</span>
using <span class="token class-name">Python<span class="token punctuation">.</span>Runtime</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        using <span class="token punctuation">(</span><span class="token class-name">Py</span><span class="token punctuation">.</span><span class="token function">GIL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 获取全局解释器锁</span>
        <span class="token punctuation">{<!-- --></span>
            dynamic py <span class="token operator">=</span> <span class="token class-name">Py<span class="token punctuation">.</span>Import</span><span class="token punctuation">(</span><span class="token string">"module_name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 导入Python模块</span>

            <span class="token comment">// 调用Python函数或访问Python对象</span>
            dynamic result <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">py<span class="token punctuation">.</span></span>FunctionName</span><span class="token punctuation">(</span>param1<span class="token punctuation">,</span> param2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="python_79"></a>引入python文件，再调用其中的方法</h4> 
<p><a href="https://blog.csdn.net/XUMENGCAS/article/details/128784093">C#使用IronPython调用Python</a></p> 
<p>这个要安装Nuget第三方库。<br> <img src="https://images2.imgbox.com/4e/d7/9nLnOos1_o.png" alt="在这里插入图片描述"></p> 
<p>这个只能说勉强能用，凑合。因为他限定死了python的版本是3.4。你pip装的第三方库都要是能支持python3.4的。而且你的编译环境要和别的python环境隔离。</p> 
<p>但是我们知道python所有版本都是有有效期的，好像是5~10年吧，过了有效期就不支持了。现在最新版的python已经是3.11了。</p> 
<h4><a id="python_90"></a>启动python脚本，监听返回值</h4> 
<p>这个我网上搜半天没找到，最后在chatGPT上面解决了。</p> 
<pre><code class="prism language-js">using System<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建一个新的ProcessStartInfo对象</span>
        ProcessStartInfo start <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置Python解释器路径</span>
        start<span class="token punctuation">.</span>FileName <span class="token operator">=</span> <span class="token string">"path_to_python_interpreter"</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置要执行的Python脚本路径及其参数（如果有的话）</span>
        start<span class="token punctuation">.</span>Arguments <span class="token operator">=</span> <span class="token string">"path_to_python_script.py arg1 arg2 arg3"</span><span class="token punctuation">;</span>

        <span class="token comment">// 设置为重定向输入和输出</span>
        start<span class="token punctuation">.</span>UseShellExecute <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        start<span class="token punctuation">.</span>RedirectStandardOutput <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        start<span class="token punctuation">.</span>RedirectStandardError <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token comment">// 启动进程</span>
        <span class="token function">using</span> <span class="token punctuation">(</span><span class="token parameter">Process process <span class="token operator">=</span> Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 读取标准输出和错误输出</span>
            string output <span class="token operator">=</span> process<span class="token punctuation">.</span>StandardOutput<span class="token punctuation">.</span><span class="token function">ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            string error <span class="token operator">=</span> process<span class="token punctuation">.</span>StandardError<span class="token punctuation">.</span><span class="token function">ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 等待进程结束</span>
            process<span class="token punctuation">.</span><span class="token function">WaitForExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 输出结果</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Output:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Error:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>按照这个，我们可以创建一个新的文件，然后直接命名行执行，监听返回值。</p> 
<h5><a id="python_137"></a>改造一下，可以入参的python调用</h5> 
<p><img src="https://images2.imgbox.com/b6/44/We26qbg2_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b7/56/APLiojKd_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-js">

<span class="token keyword">import</span> argparse
<span class="token keyword">import</span> time

parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span><span class="token function">ArgumentParser</span><span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'manual to this script'</span><span class="token punctuation">)</span>
# 这个是我们输入的两个参数
parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">"--name"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">"0"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">'input name'</span><span class="token punctuation">)</span>
parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">"--age"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>int<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>help<span class="token operator">=</span><span class="token string">'input total age'</span><span class="token punctuation">)</span>
args <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token function">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>age<span class="token punctuation">)</span>


</code></pre> 
<p>主函数</p> 
<pre><code class="prism language-java">using <span class="token class-name">C_python<span class="token punctuation">.</span>Utils</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Diagnostics</span><span class="token punctuation">;</span>

namespace <span class="token class-name">C_python</span>
<span class="token punctuation">{<!-- --></span>
    internal <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">ProcessStartInfo</span> start <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProcessStartInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 设置Python解释器路径</span>
            <span class="token class-name"><span class="token namespace">start<span class="token punctuation">.</span></span>FileName</span> <span class="token operator">=</span> <span class="token string">"python"</span><span class="token punctuation">;</span>
            <span class="token comment">// 设置要执行的Python脚本路径及其参数（如果有的话）</span>
            <span class="token class-name"><span class="token namespace">start<span class="token punctuation">.</span></span>Arguments</span> <span class="token operator">=</span> @<span class="token string">"PythonFiles/test.py --name '哈哈哈' --age 849"</span><span class="token punctuation">;</span>

            <span class="token comment">// 设置为重定向输入和输出</span>
            <span class="token class-name"><span class="token namespace">start<span class="token punctuation">.</span></span>UseShellExecute</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token namespace">start<span class="token punctuation">.</span></span>RedirectStandardOutput</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token namespace">start<span class="token punctuation">.</span></span>RedirectStandardError</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

            <span class="token comment">// 启动进程</span>
            using <span class="token punctuation">(</span><span class="token class-name">Process</span> process <span class="token operator">=</span> <span class="token class-name">Process<span class="token punctuation">.</span>Start</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 读取标准输出和错误输出</span>
                string output <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">process<span class="token punctuation">.</span></span>StandardOutput<span class="token punctuation">.</span>ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                string error <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">process<span class="token punctuation">.</span></span>StandardError<span class="token punctuation">.</span>ReadToEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 等待进程结束</span>
                <span class="token class-name"><span class="token namespace">process<span class="token punctuation">.</span></span>WaitForExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 输出结果</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token string">"Output:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token string">"Error:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>

            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行完毕"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>运行结果</p> 
<p><img src="https://images2.imgbox.com/86/07/YncdecNr_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="pythonC_215"></a>查看是否等待python运行完成之后再运行C#</h5> 
<p>添加休眠</p> 
<pre><code class="prism language-java">
<span class="token keyword">import</span> <span class="token namespace">argparse</span>
<span class="token keyword">import</span> <span class="token namespace">time</span>

parser <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">argparse<span class="token punctuation">.</span></span>ArgumentParser</span><span class="token punctuation">(</span>description<span class="token operator">=</span>'manual <span class="token keyword">to</span> <span class="token keyword">this</span> script'<span class="token punctuation">)</span>
# 这个是我们输入的两个参数
parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">"--name"</span><span class="token punctuation">,</span> type<span class="token operator">=</span>str<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token string">"0"</span><span class="token punctuation">,</span> help<span class="token operator">=</span>'input name'<span class="token punctuation">)</span>
parser<span class="token punctuation">.</span><span class="token function">add_argument</span><span class="token punctuation">(</span><span class="token string">"--age"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>help<span class="token operator">=</span>'input total age'<span class="token punctuation">)</span>
args <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'我休眠1s'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'我再休眠1s'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>age<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/15/cc/A4WlRPbC_o.png" alt="在这里插入图片描述"></p> 
<p><mark>Tips:我发现python文件选择始终复制不一定能每次修改都复制，还是得进debug文件里面改</mark></p> 
<h5><a id="_247"></a>如果参数比较复杂</h5> 
<p>我们不一定会用这么简单的参数，我们后面可能会输入上百行的复杂参数，用命令行就不一定好用了。</p> 
<p>所有我们可以将参数写到一个文件里面，每次执行让python去读这个文件里面的数据。简单参数直接传，复杂参数存文件。自己去解析。</p> 
<h4><a id="python_254"></a>开一个python网络后端</h4> 
<p>理论上是可以的，想调用python功能直接往端口传数据就行了，但是感觉有点大炮打蚊子，没必要。python就是个辅助工具，能用就行。</p> 
<h2><a id="_259"></a>总结</h2> 
<p>python有很多很好用的工具，如果我们编程的时候能很方便的调用python的工具帮我们做事情，可以减少很多不必要的麻烦，不用重复造轮子，快速开发，也能顺便学一下python。</p> 
<p>当然，也可以在nuget上找对应的第三方库或者手撸一个工具。前者找起来很麻烦，要找好几天，而且尝试好不好用也很麻烦。后者更费时间，简单事情就不要重复地造轮子。我们编程序永远是需求为第一导向，能快速地解决是最好的。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/05cd92670297edbef47d42fe43f08595/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MAC OS X 这个“安装 macOS Xxx Xxx”应用程序副本已损坏，不能用来安装 macOS,超级终端修改日期date 已解决</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b247fd402591ae86235c5de68124d0fc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">c#之UDP协议</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>