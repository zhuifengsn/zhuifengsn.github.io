<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>js判断本地是否安装app - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="js判断本地是否安装app" />
<meta property="og:description" content="var ua = navigator.userAgent.toLowerCase(); 1.判断是否是微信 function isWeixinBrowser() { return (/micromessenger/.test(ua)) ? true : false; } 2.判断是否是android var isAndroid = ua.indexOf(&#39;android&#39;) &gt; -1 || ua.indexOf(&#39;linux&#39;) &gt; -1; 3.具体过程 scheme是客户端定义的url-scheme $(&#34;a[href^=&#39;scheme://&#39;]&#34;).on(&#39;click&#39;,function(e){ e.preventDefault();//阻止默认行为 if(isWeixinBrowser()){ $(&#39;.layer&#39;).show();//遮罩层（使用外部浏览器打开，此处样式自行设定） }else{ if(isAndroid){ //android $(&#39;body&#39;).append(&#34;&lt;iframe src=&#34;&#34; style=&#39;display:none&#39; target=&#39;&#39; &gt;&lt;/iframe&gt;&#34;);//target为空防止在当前页面刷新 setTimeout(function(){window.location = &#39;http://www.510wifi.com/weixin_download_client.html&#39;},600); }else{ //ios window.location = &#39;scheme://openapp&#39;; setTimeout(function(){window.location = &#39;itms-apps://itunes.apple.com/app/id123456789&#39;},25); } } }) 附：判断手机端各种浏览器 if (ua.match(/WeiBo/i) == &#34;weibo&#34;) { //在新浪微博客户端打开 } if (ua.match(/QQ/i) == &#34;qq&#34;) { //在QQ空间打开 } if (browser." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/808f9f2edc342aafde935bb531f5bae2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-10-21T08:36:47+08:00" />
<meta property="article:modified_time" content="2017-10-21T08:36:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">js判断本地是否安装app</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="article-content"> 
 <pre class="hljs bash"><code class="copyable">var ua = navigator.userAgent.toLowerCase();

1.判断是否是微信
 
<span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">isWeixinBrowser</span></span>() {
        <span class="hljs-built_in">return</span> (/micromessenger/.test(ua)) ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;
    }
 
 
2.判断是否是android
 
var isAndroid = ua.indexOf(<span class="hljs-string">'android'</span>) &gt; -1 || ua.indexOf(<span class="hljs-string">'linux'</span>) &gt; -1;

3.具体过程
 
scheme是客户端定义的url-scheme
 
$(<span class="hljs-string">"a[href^='scheme://']"</span>).on(<span class="hljs-string">'click'</span>,<span class="hljs-keyword">function</span>(e){
        e.preventDefault();//阻止默认行为
        <span class="hljs-keyword">if</span>(isWeixinBrowser()){
            $(<span class="hljs-string">'.layer'</span>).show();//遮罩层（使用外部浏览器打开，此处样式自行设定）
        }<span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">if</span>(isAndroid){
                //android
                $(<span class="hljs-string">'body'</span>).append(<span class="hljs-string">"&lt;iframe src="</span><span class="hljs-string">" style='display:none' target='' &gt;&lt;/iframe&gt;"</span>);//target为空防止在当前页面刷新
                <span class="hljs-built_in">set</span>Timeout(<span class="hljs-function"><span class="hljs-title">function</span></span>(){window.location = <span class="hljs-string">'http://www.510wifi.com/weixin_download_client.html'</span>},600);
            }<span class="hljs-keyword">else</span>{
                //ios
                window.location = <span class="hljs-string">'scheme://openapp'</span>;
                <span class="hljs-built_in">set</span>Timeout(<span class="hljs-function"><span class="hljs-title">function</span></span>(){window.location = <span class="hljs-string">'itms-apps://itunes.apple.com/app/id123456789'</span>},25);
            }
        }
    })

附：判断手机端各种浏览器
 
<span class="hljs-keyword">if</span> (ua.match(/WeiBo/i) == <span class="hljs-string">"weibo"</span>) {
                //在新浪微博客户端打开
        }
        <span class="hljs-keyword">if</span> (ua.match(/QQ/i) == <span class="hljs-string">"qq"</span>) {
                //在QQ空间打开
        }
        <span class="hljs-keyword">if</span> (browser.versions.ios) {
                //是否在IOS浏览器打开
        } 
        <span class="hljs-keyword">if</span>(browser.versions.android){
                //是否在安卓浏览器打开
        }
 
var u = navigator.userAgent, app = navigator.appVersion;
trident: u.indexOf(<span class="hljs-string">'Trident'</span>) &gt; -1, //IE内核
            presto: u.indexOf(<span class="hljs-string">'Presto'</span>) &gt; -1, //opera内核
            webKit: u.indexOf(<span class="hljs-string">'AppleWebKit'</span>) &gt; -1, //苹果、谷歌内核
            gecko: u.indexOf(<span class="hljs-string">'Gecko'</span>) &gt; -1 &amp;&amp; u.indexOf(<span class="hljs-string">'KHTML'</span>) == -1, //火狐内核
            mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
            android: u.indexOf(<span class="hljs-string">'Android'</span>) &gt; -1 || u.indexOf(<span class="hljs-string">'Linux'</span>) &gt; -1, //android终端或uc浏览器
            iPhone: u.indexOf(<span class="hljs-string">'iPhone'</span>) &gt; -1, //是否为iPhone或者QQHD浏览器
            iPad: u.indexOf(<span class="hljs-string">'iPad'</span>) &gt; -1, //是否iPad
            webApp: u.indexOf(<span class="hljs-string">'Safari'</span>) == -1 //是否web应该程序，没有头部与底部
<span class="copy-code-btn">复制代码</span></code></pre> 
 <pre class="hljs bash"><code class="copyable">JS判断手机端是否安装了某个客户端APP

虽然在Js中可以启动某个app，但是并不能判断该app是否安装；
但是，但是....还是有奇思淫巧滴，启动app需要的时间较长，js中断时间长，如果没安装，js瞬间就执行完毕。直接上代码吧！
一、

<span class="hljs-keyword">function</span> <span class="hljs-built_in">test</span>App(url) {
    var timeout, t = 1000, hasApp = <span class="hljs-literal">true</span>;
    <span class="hljs-built_in">set</span>Timeout(<span class="hljs-function"><span class="hljs-title">function</span></span> () {
        <span class="hljs-keyword">if</span> (hasApp) {
            alert(<span class="hljs-string">'安装了app'</span>);
        } <span class="hljs-keyword">else</span> {
            alert(<span class="hljs-string">'未安装app'</span>);
        }
        document.body.removeChild(ifr);
    }, 2000)

    var t1 = Date.now();
    var ifr = document.createElement(<span class="hljs-string">"iframe"</span>);
    ifr.setAttribute(<span class="hljs-string">'src'</span>, url);
    ifr.setAttribute(<span class="hljs-string">'style'</span>, <span class="hljs-string">'display:none'</span>);
    document.body.appendChild(ifr);
    timeout = <span class="hljs-built_in">set</span>Timeout(<span class="hljs-function"><span class="hljs-title">function</span></span> () {
         var t2 = Date.now();
         <span class="hljs-keyword">if</span> (!t1 || t2 - t1 &lt; t + 100) {
             hasApp = <span class="hljs-literal">false</span>;
         }
    }, t);
}

二、

    <span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">isInstalled</span></span>(){
        var the_href=$(<span class="hljs-string">".down_app"</span>).attr(<span class="hljs-string">"href"</span>);//获得下载链接
        window.location=<span class="hljs-string">"apps custom url schemes"</span>;//打开某手机上的某个app应用
        <span class="hljs-built_in">set</span>Timeout(<span class="hljs-function"><span class="hljs-title">function</span></span>(){
            window.location=the_href;//如果超时就跳转到app下载页
        },500);
    }

 
apps custom url schemes是什么呢？
其实就是你与app约定的一个协议URL，在IOS客户端或者Android客户端中可以设置一个URL Scheme。例如，设置URL Scheme：app，然后其他的程序就可以通过“ URLString=app://”调用该应用。还可以传参数，如：app://reaction/?uid=1
以上介绍了怎么创建该本地协议及调用该本地协议的方法。但这里还有个关键就是怎么判断用户是否安装了该app呢？原理如下：
在手机浏览器中用js代码请求该协议，如果在500ms内，如果有应用程序能解析这个协议，那么就能打开该应用；如果超过500ms就跳转到app下载页。
<span class="copy-code-btn">复制代码</span></code></pre> 
 <pre class="hljs bash"><code class="copyable">点击页面判断是否安装app并打开,否则跳转下载的方法

<span class="copy-code-btn">复制代码</span></code></pre> 
 <p>　App产品在运营推广上有一个需求，就是要求可以让用户在访问我们的推广网页时，就可以判断出这个用户手机上是否安装了我们的App，如果安装了则可以直接在网页上打开，否则就引导用户前往下载。从而形成一个推广上的闭环。</p> 
 <p>解决办法</p> 
 <p>　　而对于点击链接后，能否直接打开，可以通过下面的代码来实现。前提条件：你得知道你的APP对应的打开协议，如贴吧APP，协议为：com.baidu.tieba:// ，微信的：weixin:// ，等等</p> 
 <p><br></p> 
 <pre class="hljs bash"><code class="copyable"> 1 &lt;!-- a标签点击打开的动作，在click事件中注册 --&gt;
 2 &lt;a href=<span class="hljs-string">"javascript:;"</span> id=<span class="hljs-string">"openApp"</span>&gt;贴吧客户端&lt;/a&gt;
 3 &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;
 4     document.getElementById(<span class="hljs-string">'openApp'</span>).onclick = <span class="hljs-keyword">function</span>(e){
 5         // 通过iframe的方式试图打开APP，如果能正常打开，会直接切换到APP，并自动阻止js其他行为
 6         
 7         var ifr = document.createElement(<span class="hljs-string">'iframe'</span>);
 8         ifr.src = <span class="hljs-string">'com.baidu.tieba://'</span>;//打开app的协议，有app同事提供
 9         ifr.style.display = <span class="hljs-string">'none'</span>;
10         document.body.appendChild(ifr);
11         window.setTimeout(<span class="hljs-function"><span class="hljs-title">function</span></span>(){
12             document.body.removeChild(ifr);
13 　　　　　　　window.location.href = <span class="hljs-string">"https://itunes.apple.com/cn/app/id477927812"</span>;//打开app下载地址，有app同事提供
14         },2000)
15     };
16 &lt;/script&gt;<span class="copy-code-btn">复制代码</span></code></pre> 
 <p><br></p> 
 <p> </p> 
 <p>此方法有些浏览器不兼容iframe，可以window.location的方法解决</p> 
 <p><br></p> 
 <pre class="hljs bash"><code class="copyable">1 &lt;a href=<span class="hljs-string">"javascript:;"</span> id=<span class="hljs-string">"openApp"</span>&gt;贴吧客户端&lt;/a&gt;
2 &lt;script <span class="hljs-built_in">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;
3     document.getElementById(<span class="hljs-string">'openApp'</span>).onclick = <span class="hljs-keyword">function</span>(e){
4         window.location.href = <span class="hljs-string">"com.baidu.tieba://"</span>;
5         window.setTimeout(<span class="hljs-function"><span class="hljs-title">function</span></span>(){
6             window.location.href = <span class="hljs-string">"https://itunes.apple.com/cn/app/id477927812"</span>;//打开app下载地址，有app同事提供
7         },2000)
8     };
9 &lt;/script&gt;<span class="copy-code-btn">复制代码</span></code></pre> 
 <p><br></p> 
 <p>IOS上的Banner</p> 
 <p>　　参考网页：<a href="https://link.juejin.im?target=https%3A%2F%2Fdeveloper.apple.com%2Flibrary%2Fios%2Fdocumentation%2FAppleApplications%2FReference%2FSafariWebContent%2FPromotingAppswithAppBanners%2FPromotingAppswithAppBanners.html" rel="nofollow">developer.apple.com/library/ios…</a></p> 
 <p>　　应用场景：</p> 
 <p>　　1、用户第一次访问宣传页面</p> 
 <p> 　　a、点击Banner，进入到APP Store中对应的APP下载页</p> 
 <p> 　　b、APP下载页中提示：安装；用户点击安装</p> 
 <p> 　　c、安装完成后，APP下载页中提示：打开；用户继续点击打开</p> 
 <p> 　　d、用户正常使用APP</p> 
 <p>　　2、用户第二次访问宣传页面</p> 
 <p> 　　a、点击Banner，进入到APP Store中对应的APP下载页</p> 
 <p> 　　b、APP下载页中提示：打开；用户直接点击打开</p> 
 <p> 　　c、用户正常使用APP</p> 
 <p>　　3、用户第三次、第四次、...、第N次访问，操作步骤同2</p> 
 <p>　　在iOS上，要增加一个APP的大Banner，其实只需要在&lt;head&gt;标签内增加一个&lt;meta&gt;标签即可，格式如：</p> 
 <p>　　　　&lt;meta name='apple-itunes-app' content='app-id=你的APP-ID'&gt;</p> 
 <p>　　百度贴吧的</p> 
 <pre class="hljs bash"><code class="copyable">1 &lt;meta name=<span class="hljs-string">'apple-itunes-app'</span> content=<span class="hljs-string">'app-id=477927812'</span>&gt;<span class="copy-code-btn">复制代码</span></code></pre> 
 <p> 测试Demo</p> 
 <p><br></p> 
 <pre class="hljs bash"><code class="copyable"> 1 &lt;!DOCTYPE html&gt;
 2 &lt;html&gt;
 3 &lt;head&gt;
 4 &lt;meta http-equiv=<span class="hljs-string">"Content-Type"</span> content=<span class="hljs-string">"text/html; charset=UTF-8"</span>&gt;
 5 &lt;title&gt;this<span class="hljs-string">'s a demo&lt;/title&gt;
 6     &lt;meta name='</span>apple-itunes-app<span class="hljs-string">' content='</span>app-id=477927812<span class="hljs-string">'&gt;
 7 &lt;/head&gt;
 8 &lt;body&gt;
 9     &lt;a href="javascript:;" id="openApp"&gt;贴吧客户端&lt;/a&gt;
10 &lt;/body&gt;
11 &lt;/html&gt;
12 &lt;script type="text/javascript"&gt;
13     document.getElementById('</span>openApp<span class="hljs-string">').onclick = function(e){
14         
15         if(navigator.userAgent.match(/(iPhone|iPod|iPad);?/i))
16            {
17             window.location.href = "com.baidu.tieba://";//ios app协议
18             window.setTimeout(function() {
19                 window.location.href = "https://itunes.apple.com/cn/app/id477927812";
20             }, 2000)
21            }
22         if(navigator.userAgent.match(/android/i))
23         {
24             window.location.href = "com.baidu.tieba://app";//android app协议
25             window.setTimeout(function() {
26                 window.location.href = "https://****.apk";//android 下载地址
27             }, 2000)    
28         }
29     };
30 &lt;/script&gt;</span><span class="copy-code-btn">复制代码</span></code></pre> 
 <p><br></p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/db3f0178e3b4117ebe4501383b2934eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">多项式相加减【数据结构实验报告】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0acc3963bfac0b64bde59ca07fcae6ab/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">疫情控制</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>