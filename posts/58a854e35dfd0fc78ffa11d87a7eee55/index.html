<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>离线装docker和相关应用保姆级教程——以安装docker-jupyter/notebook为例 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="离线装docker和相关应用保姆级教程——以安装docker-jupyter/notebook为例" />
<meta property="og:description" content="0 背景 有时候，客户是行政或者事业单位，对数据基础设施的安全性极高，导致必须被驻派到现场部署，而由于现场没有任何外网，下载任何东西只能靠自己的流量，或者前一天下载好来，一种比较合适的做法是将应用打包成一个docker，然后带过去现场，此教程将一步一步教你如何离线安装docker，并且如何一步一步安装你想要的相关应用。
docker的作用：免去了部署应用相关环境的困扰，并且可以部署多个应用互不影响，在一台机器上加快部署多个应用。
1 确定机器型号 你需要让现场人员运行下面这个命令：
cat /etc/os-release 根据上图可以确定机器的架构为Centos linux7，为arm指令集架构。
2 下载docker包 先去这里选择属于你的机器类型：链接: 镜像下载
根据上图，我选择的是：为了实现在这台机器上安装docker这个目标，我们必须在这个界面上下载以下组件，注意版本号一定要一致：
3 安装到docker 想办法将文件传输到该机器：如使用MobaXterm学习版、U盘拷贝等方法，具体方法步骤自行百度。下面是我将我的所有安装文件，放到该目录下然后在终端输入cd /home/hhl/docker安装文件/继续输入：sudo yum install ./*等待安装完毕即可。 4 启动docker 启动docker服务：systemctl start docker设置开机自动启动：systemctl enable docker测试：docker version，必须出现如下客户端和服务器的版本信息才算安装成功：
5 离线安装应用 这里以一个jupyter notebook环境安装为例，展示一下离线安装应用的流程。具体如何操作需要根据你自己需要的应用灵活贯通！
当你在自己公司有网络的时候，使用vm16安装一台虚拟机，需要和你在现场的机器型号一致。
然后安装好docker，直接输入sudo yum install docker-ce可以实现自动联网安装，然后按照上一步“4 启动docker”验证即可。
然后输入sudo docker search jupyter，获取下图的这个下载量最高的镜像名字“jupyter/scipy-notebook”
输入sudo docker pull jupyter/scipy-notebook，拉取这个镜像。等待拉取完毕，然后使用sudo docker images，可以发现已经存在了这个镜像：
输入 docker run -it -p 8888:8888 -v 宿主机某路径:容器中路径 容器id ，运行jupyter notebook进行测试。注意：此处的只有“宿主机某路径”需要你自己自定义——输入你虚拟机上面的某个路径，你使用notebook编程时候需要用到什么数据文件也要放到里面去，这样你用notebook的时候才能使用；容器中的路径取决于镜像说明；容器id上图有，自己填上去即可。例如本jupyter notebook：docker run -it -p 8888:8888 -v /home/notebook:/home/jovyan bcf091d6ab66" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/58a854e35dfd0fc78ffa11d87a7eee55/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-05T11:49:05+08:00" />
<meta property="article:modified_time" content="2023-06-05T11:49:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">离线装docker和相关应用保姆级教程——以安装docker-jupyter/notebook为例</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="0__0"></a>0 背景</h2> 
<p>有时候，客户是行政或者事业单位，对数据基础设施的安全性极高，导致必须被驻派到现场部署，而由于现场没有任何外网，下载任何东西只能靠自己的流量，或者前一天下载好来，一种比较合适的做法是将应用打包成一个docker，然后带过去现场，此教程将一步一步教你如何离线安装docker，并且如何一步一步安装你想要的相关应用。</p> 
<p><strong>docker的作用</strong>：免去了部署应用相关环境的困扰，并且可以部署多个应用互不影响，在一台机器上加快部署多个应用。</p> 
<h2><a id="1__5"></a>1 确定机器型号</h2> 
<p>你需要让现场人员运行下面这个命令：</p> 
<pre><code class="prism language-bash"><span class="token function">cat</span> /etc/os-release
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/3b/A4WFePo7_o.png" alt="在这里插入图片描述"><br> 根据上图可以确定机器的架构为Centos linux7，为arm指令集架构。</p> 
<h2><a id="2_docker_14"></a>2 下载docker包</h2> 
<ul><li>先去这里选择属于你的机器类型：链接: <a href="http://mirrors.aliyun.com/docker-ce/linux/?spm=a2c6h.25603864.0.0.4f0f4ca5Q0P5pM" rel="nofollow">镜像下载</a><br> 根据上图，我选择的是：<img src="https://images2.imgbox.com/27/52/pmpePXUn_o.png" alt="在这里插入图片描述"></li><li>为了实现在这台机器上安装docker这个目标，我们必须在这个界面上下载以下组件，注意版本号一定要一致：<br> <img src="https://images2.imgbox.com/c5/48/f3RmxURm_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="3_docker_19"></a>3 安装到docker</h2> 
<ul><li>想办法将文件传输到该机器：如使用MobaXterm学习版、U盘拷贝等方法，具体方法步骤自行百度。</li><li>下面是我将我的所有安装文件，放到该目录下<img src="https://images2.imgbox.com/87/5d/KON5Belu_o.png" alt="在这里插入图片描述"></li><li>然后在终端输入<code>cd /home/hhl/docker安装文件/</code></li><li>继续输入：<code>sudo yum install ./*</code></li><li>等待安装完毕即可。</li></ul> 
<h2><a id="4_docker_26"></a>4 启动docker</h2> 
<ul><li>启动docker服务：<code>systemctl start docker</code></li><li>设置开机自动启动：<code>systemctl enable docker</code></li><li>测试：<code>docker version</code>，必须出现如下客户端和服务器的版本信息才算安装成功：<br> <img src="https://images2.imgbox.com/11/db/Ecvxdr4z_o.png" alt="在这里插入图片描述"></li></ul> 
<h2><a id="5__32"></a>5 离线安装应用</h2> 
<blockquote> 
 <p>这里以一个jupyter notebook环境安装为例，展示一下离线安装应用的流程。具体如何操作需要根据你自己需要的应用灵活贯通！</p> 
</blockquote> 
<ul><li> <p>当你在自己公司有网络的时候，使用vm16安装一台虚拟机，需要和你在现场的机器型号一致。</p> </li><li> <p>然后安装好docker，直接输入<code>sudo yum install docker-ce</code>可以实现自动联网安装，然后按照上一步“4 启动docker”验证即可。</p> </li><li> <p>然后输入<code>sudo docker search jupyter</code>，获取下图的这个下载量最高的镜像名字“jupyter/scipy-notebook”<br> <img src="https://images2.imgbox.com/5b/e2/Dq2rRTFS_o.png" alt="在这里插入图片描述"></p> </li><li> <p>输入<code>sudo docker pull jupyter/scipy-notebook</code>，拉取这个镜像。等待拉取完毕，然后使用<code>sudo docker images</code>，可以发现已经存在了这个镜像：<img src="https://images2.imgbox.com/4f/89/tu9zbbft_o.png" alt="在这里插入图片描述"></p> </li><li> <p>输入 <code>docker run -it -p 8888:8888 -v 宿主机某路径:容器中路径 容器id </code>，运行jupyter notebook进行测试。<strong>注意</strong>：此处的只有“<strong>宿主机某路径</strong>”需要你自己自定义——输入你虚拟机上面的某个路径，你使用notebook编程时候需要用到什么数据文件也要放到里面去，这样你用notebook的时候才能使用；<strong>容器中的路径</strong>取决于镜像说明；容器id上图有，自己填上去即可。例如本jupyter notebook：<code>docker run -it -p 8888:8888 -v /home/notebook:/home/jovyan bcf091d6ab66</code></p> </li><li> <p>按界面上面显示的url即可打开notebook进行编程，可以将url中127.0.0.1换成你虚拟机的ip地址（可通过<code>ip addr</code>查看）进行远程控制。</p> </li><li> <p><strong>特别注意！！！</strong>，如果你这里需要安装python第三方库，你需要把你从python库官网下载到的相关依赖包全部放入<strong>宿主机某路径</strong>，然后打开notebook进行手动pip安装（输入!pip install redis-4.5.5-py3-none-any.whl即可），如下图所示，这是我用到的所有第三方库：<img src="https://images2.imgbox.com/8d/6a/iqzyjNXD_o.png" alt="在这里插入图片描述"></p> </li><li> <p>如果你不知道用什么第三方库版本，那就直接在公司可联网的虚拟机上下载安装一遍就知道去哪下载了，上面会显示下载的url，比如下面我为了安装hanlp这个第三方库，就需要安装十几个依赖包，这些包包库库都需要通过这些url下载后，再复制到到你的<strong>宿主机某路径</strong>上面去。<img src="https://images2.imgbox.com/06/8d/2WP6AJ5R_o.png" alt="在这里插入图片描述"></p> </li><li> <p>接下面我需要对这个notebook进行打包，使用命令<code>docker save -o jupyter_scipy_notebook.tar jupyter/scipy-notebook</code>。格式为：<code>docker save -o &lt;image_file.tar&gt; &lt;image_name&gt;</code>这里的导出压缩包名字可以自己定义，镜像名字就是上图中的第一个字段值。</p> </li><li> <p>这个压缩包可能会比较大，将它移动到你的网盘或者U盘（<strong>宿主机某路径</strong>下的所有数据文件也要拷贝到现场机器中去），然后复制到现场的机器中，在现场无法联网的机器中使用命令<code>docker load -i &lt;image_file.tar&gt;</code>将镜像载入，本例中使用<code>docker load -i jupyter_scipy_notebook.tar</code>。</p> </li><li> <p>最后同样使用命令<code>docker run -it -p 8888:8888 -v /home/notebook:/home/jovyan bcf091d6ab66</code>进行测试运行。</p> </li><li> <p>使用url进入notebook之后，打开终端，然后进去使用<code>pip install whl文件所在的文件夹</code>，或者不打开终端模式，直接在notebook上面输入<code>!pip install whl文件所在的文件夹</code>，也行。例如在下图中，进入download目录后，输入<code>!pip install ./*</code>就可以安装该目录下的所有的python依赖。</p> </li><li> <p>至此，你可以愉快地在你无法联网的现场机器上进行notebook编程啦！你需要在离线docker下使用其他应用的安装流程也是类似的。</p> </li></ul> 
<h2><a id="6__54"></a>6 总结</h2> 
<ul><li>整个部署的过程，关键其实在于<strong>现场机器版本的确定</strong>和<strong>所有依赖项的确定</strong>，其他方面都很方便，主要依赖于docker良好的封装性。</li><li>但是<strong>现场的离线环境</strong>和<strong>自己公司的环境</strong>还是会有极大的不同，这个我觉得还是要去现场解决效率更高，所以准备好足够的数据流量吧！</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e51d3dc605ef3950138afc52a41b4dbf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Airtest笔记（一）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1c15585845bad1456e0802420bd106a9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言课程设计——职工信息管理系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>