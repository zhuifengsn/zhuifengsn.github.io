<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何利用EXCEL批量插入图片 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何利用EXCEL批量插入图片" />
<meta property="og:description" content="目录
1.excel打开目标表格；
2.点开视图-宏-录制宏，可以改宏的名字或者选择默认；
3.然后点开视图-宏-查看宏
4.点编辑进去
5.修改代码：
（1）打开之后会显示有一堆代码
（2）将这个代码只要改地址直接贴到步骤（1）的模块代码
6.同时将代码放在txt文档，并放在图片所在文件夹；
7.插入图片：在excel修改插入图片的名字，和目标图片名字一致；然后选择目标图片名并点击“查看宏”，再点击“执行”运行；
8.运行完即将图片批量插入；
1.excel打开目标表格； 2.点开视图-宏-录制宏，可以改宏的名字或者选择默认； 3.然后点开视图-宏-查看宏 4.点编辑进去 5.修改代码： （1）打开之后会显示有一堆代码 （2）将这个代码只要改地址直接贴到步骤（1）的模块代码 （3）呈现如图
Sub 批量插图() On Error Resume Next Application.ScreenUpdating = False Dim MR As Range,sPath As String sPath = &#34;D:\临时&#34; &#39;设置图片位置 For Each MR In Selection If Not IsEmpty(MR) And Dir(sPath &amp; &#34;\&#34; &amp; MR.Value &amp; &#34;.jpg&#34;) &lt;&gt; &#34;&#34; Then MR.Select ML = MR.Left MT = MR.Top MW = MR.Width MH = MR." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/e96344e714cd7535ed4d747fae04b997/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-25T20:19:07+08:00" />
<meta property="article:modified_time" content="2024-02-25T20:19:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何利用EXCEL批量插入图片</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="1.excel%E6%89%93%E5%BC%80%E7%9B%AE%E6%A0%87%E8%A1%A8%E6%A0%BC%EF%BC%9B-toc" style="margin-left:0px;"><a href="#1.excel%E6%89%93%E5%BC%80%E7%9B%AE%E6%A0%87%E8%A1%A8%E6%A0%BC%EF%BC%9B" rel="nofollow">1.excel打开目标表格；</a></p> 
<p id="2.%E7%82%B9%E5%BC%80%E8%A7%86%E5%9B%BE-%E5%AE%8F-%E5%BD%95%E5%88%B6%E5%AE%8F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%94%B9%E5%AE%8F%E7%9A%84%E5%90%8D%E5%AD%97%E6%88%96%E8%80%85%E9%80%89%E6%8B%A9%E9%BB%98%E8%AE%A4%EF%BC%9B-toc" style="margin-left:0px;"><a href="#2.%E7%82%B9%E5%BC%80%E8%A7%86%E5%9B%BE-%E5%AE%8F-%E5%BD%95%E5%88%B6%E5%AE%8F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%94%B9%E5%AE%8F%E7%9A%84%E5%90%8D%E5%AD%97%E6%88%96%E8%80%85%E9%80%89%E6%8B%A9%E9%BB%98%E8%AE%A4%EF%BC%9B" rel="nofollow">2.点开视图-宏-录制宏，可以改宏的名字或者选择默认；</a></p> 
<p id="3.%E7%84%B6%E5%90%8E%E7%82%B9%E5%BC%80%E8%A7%86%E5%9B%BE-%E5%AE%8F-%E6%9F%A5%E7%9C%8B%E5%AE%8F-toc" style="margin-left:0px;"><a href="#3.%E7%84%B6%E5%90%8E%E7%82%B9%E5%BC%80%E8%A7%86%E5%9B%BE-%E5%AE%8F-%E6%9F%A5%E7%9C%8B%E5%AE%8F" rel="nofollow">3.然后点开视图-宏-查看宏</a></p> 
<p id="4.%E7%82%B9%E7%BC%96%E8%BE%91%E8%BF%9B%E5%8E%BB-toc" style="margin-left:0px;"><a href="#4.%E7%82%B9%E7%BC%96%E8%BE%91%E8%BF%9B%E5%8E%BB" rel="nofollow">4.点编辑进去</a></p> 
<p id="5.%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81%EF%BC%9A-toc" style="margin-left:0px;"><a href="#5.%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81%EF%BC%9A" rel="nofollow">5.修改代码：</a></p> 
<p id="%EF%BC%881%EF%BC%89%E6%89%93%E5%BC%80%E4%B9%8B%E5%90%8E%E4%BC%9A%E6%98%BE%E7%A4%BA%E6%9C%89%E4%B8%80%E5%A0%86%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%EF%BC%881%EF%BC%89%E6%89%93%E5%BC%80%E4%B9%8B%E5%90%8E%E4%BC%9A%E6%98%BE%E7%A4%BA%E6%9C%89%E4%B8%80%E5%A0%86%E4%BB%A3%E7%A0%81" rel="nofollow">（1）打开之后会显示有一堆代码</a></p> 
<p id="%EF%BC%882%EF%BC%89%E5%B0%86%E8%BF%99%E4%B8%AA%E4%BB%A3%E7%A0%81%E5%8F%AA%E8%A6%81%E6%94%B9%E5%9C%B0%E5%9D%80%E7%9B%B4%E6%8E%A5%E8%B4%B4%E5%88%B0%E6%AD%A5%E9%AA%A4%EF%BC%881%EF%BC%89%E7%9A%84%E6%A8%A1%E5%9D%97%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%EF%BC%882%EF%BC%89%E5%B0%86%E8%BF%99%E4%B8%AA%E4%BB%A3%E7%A0%81%E5%8F%AA%E8%A6%81%E6%94%B9%E5%9C%B0%E5%9D%80%E7%9B%B4%E6%8E%A5%E8%B4%B4%E5%88%B0%E6%AD%A5%E9%AA%A4%EF%BC%881%EF%BC%89%E7%9A%84%E6%A8%A1%E5%9D%97%E4%BB%A3%E7%A0%81" rel="nofollow">（2）将这个代码只要改地址直接贴到步骤（1）的模块代码</a></p> 
<p id="6.%E5%90%8C%E6%97%B6%E5%B0%86%E4%BB%A3%E7%A0%81%E6%94%BE%E5%9C%A8txt%E6%96%87%E6%A1%A3%EF%BC%8C%E5%B9%B6%E6%94%BE%E5%9C%A8%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%9B-toc" style="margin-left:0px;"><a href="#6.%E5%90%8C%E6%97%B6%E5%B0%86%E4%BB%A3%E7%A0%81%E6%94%BE%E5%9C%A8txt%E6%96%87%E6%A1%A3%EF%BC%8C%E5%B9%B6%E6%94%BE%E5%9C%A8%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%9B" rel="nofollow">6.同时将代码放在txt文档，并放在图片所在文件夹；</a></p> 
<p id="7.%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%EF%BC%9A%E5%9C%A8excel%E4%BF%AE%E6%94%B9%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%8C%E5%92%8C%E7%9B%AE%E6%A0%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%AD%97%E4%B8%80%E8%87%B4%EF%BC%9B%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E7%9B%AE%E6%A0%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%B9%B6%E7%82%B9%E5%87%BB%E2%80%9C%E6%9F%A5%E7%9C%8B%E5%AE%8F%E2%80%9D%EF%BC%8C%E5%86%8D%E7%82%B9%E5%87%BB%E2%80%9C%E6%89%A7%E8%A1%8C%E2%80%9D%E8%BF%90%E8%A1%8C%EF%BC%9B-toc" style="margin-left:0px;"><a href="#7.%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%EF%BC%9A%E5%9C%A8excel%E4%BF%AE%E6%94%B9%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%8C%E5%92%8C%E7%9B%AE%E6%A0%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%AD%97%E4%B8%80%E8%87%B4%EF%BC%9B%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E7%9B%AE%E6%A0%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%B9%B6%E7%82%B9%E5%87%BB%E2%80%9C%E6%9F%A5%E7%9C%8B%E5%AE%8F%E2%80%9D%EF%BC%8C%E5%86%8D%E7%82%B9%E5%87%BB%E2%80%9C%E6%89%A7%E8%A1%8C%E2%80%9D%E8%BF%90%E8%A1%8C%EF%BC%9B" rel="nofollow">7.插入图片：在excel修改插入图片的名字，和目标图片名字一致；然后选择目标图片名并点击“查看宏”，再点击“执行”运行；</a></p> 
<p id="8.%E8%BF%90%E8%A1%8C%E5%AE%8C%E5%8D%B3%E5%B0%86%E5%9B%BE%E7%89%87%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%EF%BC%9B-toc" style="margin-left:0px;"><a href="#8.%E8%BF%90%E8%A1%8C%E5%AE%8C%E5%8D%B3%E5%B0%86%E5%9B%BE%E7%89%87%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%EF%BC%9B" rel="nofollow">8.运行完即将图片批量插入；</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 style="text-align:justify;">1.excel打开目标表格；</h2> 
<h2 id="2.%E7%82%B9%E5%BC%80%E8%A7%86%E5%9B%BE-%E5%AE%8F-%E5%BD%95%E5%88%B6%E5%AE%8F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%94%B9%E5%AE%8F%E7%9A%84%E5%90%8D%E5%AD%97%E6%88%96%E8%80%85%E9%80%89%E6%8B%A9%E9%BB%98%E8%AE%A4%EF%BC%9B" style="text-align:justify;">2.点开视图-宏-录制宏，可以改宏的名字或者选择默认；</h2> 
<p style="text-align:justify;"><img alt="" height="184" src="https://images2.imgbox.com/b4/4e/Hg01QwFZ_o.png" width="829"></p> 
<p style="text-align:justify;"><img alt="" height="523" src="https://images2.imgbox.com/1b/58/RqN363pw_o.png" width="600"></p> 
<h2 id="3.%E7%84%B6%E5%90%8E%E7%82%B9%E5%BC%80%E8%A7%86%E5%9B%BE-%E5%AE%8F-%E6%9F%A5%E7%9C%8B%E5%AE%8F" style="text-align:justify;">3.然后点开视图-宏-查看宏</h2> 
<p style="text-align:justify;"><img alt="" height="184" src="https://images2.imgbox.com/f9/20/1Oeh1rTV_o.png" width="830"></p> 
<h2 id="4.%E7%82%B9%E7%BC%96%E8%BE%91%E8%BF%9B%E5%8E%BB" style="text-align:justify;">4.点编辑进去</h2> 
<p style="text-align:justify;"><img alt="" height="327" src="https://images2.imgbox.com/77/4f/jVbZeukp_o.png" width="735"></p> 
<h2 id="5.%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81%EF%BC%9A" style="text-align:justify;">5.修改代码：</h2> 
<h3 id="%EF%BC%881%EF%BC%89%E6%89%93%E5%BC%80%E4%B9%8B%E5%90%8E%E4%BC%9A%E6%98%BE%E7%A4%BA%E6%9C%89%E4%B8%80%E5%A0%86%E4%BB%A3%E7%A0%81" style="margin-left:.0001pt;text-align:justify;">（1）打开之后会显示有一堆代码</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="306" src="https://images2.imgbox.com/db/21/R1EbcpbA_o.png" width="830"></p> 
<h3 id="%EF%BC%882%EF%BC%89%E5%B0%86%E8%BF%99%E4%B8%AA%E4%BB%A3%E7%A0%81%E5%8F%AA%E8%A6%81%E6%94%B9%E5%9C%B0%E5%9D%80%E7%9B%B4%E6%8E%A5%E8%B4%B4%E5%88%B0%E6%AD%A5%E9%AA%A4%EF%BC%881%EF%BC%89%E7%9A%84%E6%A8%A1%E5%9D%97%E4%BB%A3%E7%A0%81" style="margin-left:.0001pt;text-align:justify;">（2）将这个代码只要改地址直接贴到步骤（1）的模块代码</h3> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="379" src="https://images2.imgbox.com/4a/76/CDN8xYTO_o.png" width="831"></p> 
<p style="margin-left:.0001pt;text-align:justify;">（3）呈现如图</p> 
<p style="text-align:justify;"><img alt="" height="325" src="https://images2.imgbox.com/70/38/s0Sa1t7c_o.png" width="831"></p> 
<pre><code class="hljs">Sub 批量插图()
On Error Resume Next
Application.ScreenUpdating = False
Dim MR As Range,sPath As String
sPath = "D:\临时" '设置图片位置
For Each MR In Selection
If Not IsEmpty(MR) And Dir(sPath &amp; "\" &amp; MR.Value &amp; ".jpg") &lt;&gt; "" Then
MR.Select
ML = MR.Left
MT = MR.Top
MW = MR.Width
MH = MR.Height
ActiveSheet.Shapes.AddShape(msoShapeRectangle, ML, MT, MW, MH).Select
Selection.ShapeRange.Fill.UserPicture _
sPath &amp; "\" &amp; MR.Value &amp; ".jpg"
End If
Next
Set MR = Nothing
Application.ScreenUpdating = True
End Sub</code></pre> 
<h2 id="6.%E5%90%8C%E6%97%B6%E5%B0%86%E4%BB%A3%E7%A0%81%E6%94%BE%E5%9C%A8txt%E6%96%87%E6%A1%A3%EF%BC%8C%E5%B9%B6%E6%94%BE%E5%9C%A8%E5%9B%BE%E7%89%87%E6%89%80%E5%9C%A8%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%9B" style="text-align:justify;">6.同时将代码放在txt文档，并放在图片所在文件夹；</h2> 
<p style="text-align:justify;"><img alt="" height="327" src="https://images2.imgbox.com/f7/4f/WKyoWRt9_o.png" width="830"></p> 
<h2 id="7.%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%EF%BC%9A%E5%9C%A8excel%E4%BF%AE%E6%94%B9%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%8C%E5%92%8C%E7%9B%AE%E6%A0%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%AD%97%E4%B8%80%E8%87%B4%EF%BC%9B%E7%84%B6%E5%90%8E%E9%80%89%E6%8B%A9%E7%9B%AE%E6%A0%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%B9%B6%E7%82%B9%E5%87%BB%E2%80%9C%E6%9F%A5%E7%9C%8B%E5%AE%8F%E2%80%9D%EF%BC%8C%E5%86%8D%E7%82%B9%E5%87%BB%E2%80%9C%E6%89%A7%E8%A1%8C%E2%80%9D%E8%BF%90%E8%A1%8C%EF%BC%9B" style="text-align:justify;">7.插入图片：在excel修改插入图片的名字，和目标图片名字一致；然后选择目标图片名并点击“查看宏”，再点击“执行”运行；</h2> 
<p style="text-align:justify;"><img alt="" height="301" src="https://images2.imgbox.com/0a/a4/MYJoYtui_o.png" width="830"></p> 
<p style="text-align:justify;"><img alt="" height="529" src="https://images2.imgbox.com/1b/5b/Qfg0bVG8_o.png" width="831"></p> 
<h2 id="8.%E8%BF%90%E8%A1%8C%E5%AE%8C%E5%8D%B3%E5%B0%86%E5%9B%BE%E7%89%87%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%EF%BC%9B" style="text-align:justify;">8.运行完即将图片批量插入；</h2> 
<p style="text-align:justify;"><img alt="" height="337" src="https://images2.imgbox.com/96/fc/yqQ2PXYV_o.png" width="830"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e900558163b355faf0496e134079874e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[数据集][目标检测]游泳者溺水数据集VOC&#43;YOLO格式2类别895张</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/29dd32bb8e7c8fc8e042b783713d7edd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">kubernetes集群搭建(1.26版本)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>