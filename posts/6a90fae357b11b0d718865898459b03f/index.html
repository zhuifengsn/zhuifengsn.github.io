<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Git版本回退的两种方式及回退方式推荐 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Git版本回退的两种方式及回退方式推荐" />
<meta property="og:description" content="文章目录 综述背景说明查看提交历史1 格式化2 筛选检索3 最近提交 版本回退1 `reset`方法回退2 `revert`方法回退 恢复回退 综述 本文档主要用于详细说明如何使用Git进行版本回退，主要包含四个方面：
背景说明查看提交历史版本回退恢复回退 背景说明 在使用git版本控制进行开发的过程中，我们有时会出现错误提交的情况，存在误提交的时候怎么办呢？，此时我们希望能撤销提交操作，让程序回到提交前的样子，本文总结了两种解决方法：reset复位、revert恢复。
查看提交历史 在提交了若干更新，又或者克隆了某个项目之后，你也许想回顾下提交历史。 完成这个任务最简单而又有效的工具是git log命令。
git log如果不带任何参数，它会列出所有历史记录，最近的排在最上方，显示提交对象的哈希值(commit id)，作者、提交日期、和提交说明。如果记录过多，则按Page Up、Page Down、↓、↑来控制显示；按Q退出历史记录列表。
查看git log命令文档
下面介绍几种常用的git log使用方式：
1 格式化 如果想获取每条日志的简要信息，可以使用git log --pretty=oneline，精简一行显示；
如果想在查看的时候只显示简略的commit id，那么可以使用git log --abbrev-commit；
如果想在查看的时候想获取全部基本信息，可以使用git log --pretty=full，这也是默认的形式。因此直接使用git log也可以；
如果想获取更详细的信息，使用git log --pretty=fuller;
如果想查看带图形的日志使用git log --graph;
定制记录的显示格式显示使用git log --pretty=format:&#34;%h - %an, %ar : %s&#34;；点击查看常用格式选项
--pretty这个选项可以使用不同于默认格式的方式展示提交历史。 这个选项有一些内建的子选项供你使用。比如oneline会将每个提交放在一行显示，在浏览大量的提交时非常有用。 另外还有short，full和fuller选项，它们展示信息的格式基本一致，但是详尽程度不一。
2 筛选检索 支持通过作者来查询git log --auther=&#39;作者名&#39;；
支持时间，--after、--before，after在某个时间点后；before在某个时间点前git log --before=&#39;2021-03-12 12:29:29&#39;；
支持时间区间，各个条件之间是与的关系，可以联合使用；
3 最近提交 直接使用git log -n查看即可，n为一个具体数字，前n条，可省略，省略则分页展示全部；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/6a90fae357b11b0d718865898459b03f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-05-08T18:24:33+08:00" />
<meta property="article:modified_time" content="2021-05-08T18:24:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Git版本回退的两种方式及回退方式推荐</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">综述</a></li><li><a href="#_9" rel="nofollow">背景说明</a></li><li><a href="#_12" rel="nofollow">查看提交历史</a></li><li><ul><li><a href="#1__22" rel="nofollow">1 格式化</a></li><li><a href="#2__38" rel="nofollow">2 筛选检索</a></li><li><a href="#3__46" rel="nofollow">3 最近提交</a></li></ul> 
   </li><li><a href="#_51" rel="nofollow">版本回退</a></li><li><ul><li><a href="#1_reset_53" rel="nofollow">1 `reset`方法回退</a></li><li><a href="#2_revert_71" rel="nofollow">2 `revert`方法回退</a></li></ul> 
   </li><li><a href="#_86" rel="nofollow">恢复回退</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>综述</h3> 
<p>本文档主要用于详细说明如何使用Git进行版本回退，主要包含四个方面：</p> 
<ol><li>背景说明</li><li>查看提交历史</li><li>版本回退</li><li>恢复回退</li></ol> 
<h3><a id="_9"></a>背景说明</h3> 
<p>在使用<code>git</code>版本控制进行开发的过程中，我们有时会出现<code>错误提交</code>的情况，存在误提交的时候怎么办呢？，此时我们希望能撤销提交操作，让程序回到提交前的样子，本文总结了两种解决方法：<code>reset</code>复位、<code>revert</code>恢复。</p> 
<h3><a id="_12"></a>查看提交历史</h3> 
<p>在提交了若干更新，又或者克隆了某个项目之后，你也许想回顾下提交历史。 完成这个任务最简单而又有效的工具是<code>git log</code>命令。<br> <img src="https://images2.imgbox.com/30/31/pv0MFAMn_o.png" alt="在这里插入图片描述"></p> 
<p><code>git log</code>如果不带任何参数，它会列出所有历史记录，最近的排在最上方，显示提交对象的哈希值(commit id)，作者、提交日期、和提交说明。如果记录过多，则按<code>Page Up</code>、<code>Page Down</code>、<code>↓</code>、<code>↑</code>来控制显示；按<code>Q</code>退出历史记录列表。</p> 
<p><a href="https://git-scm.com/docs/git-log" rel="nofollow">查看<code>git log</code>命令文档</a></p> 
<p>下面介绍几种常用的<code>git log</code>使用方式：</p> 
<h4><a id="1__22"></a>1 格式化</h4> 
<ul><li> <p>如果想获取每条日志的简要信息，可以使用<code>git log --pretty=oneline</code>，精简一行显示；<br> <img src="https://images2.imgbox.com/83/0c/FeUkoylG_o.png" alt="在这里插入图片描述"></p> </li><li> <p>如果想在查看的时候只显示简略的<code>commit id</code>，那么可以使用<code>git log --abbrev-commit</code>；<br> <img src="https://images2.imgbox.com/a4/03/rxx26Jlz_o.png" alt="在这里插入图片描述"></p> </li><li> <p>如果想在查看的时候想获取全部基本信息，可以使用<code>git log --pretty=full</code>，这也是默认的形式。因此直接使用<code>git log</code>也可以；<br> <img src="https://images2.imgbox.com/f3/fd/BdF0fLU7_o.png" alt="在这里插入图片描述"></p> </li><li> <p>如果想获取更详细的信息，使用<code>git log --pretty=fuller</code>;<br> <img src="https://images2.imgbox.com/83/7a/9y5R48aZ_o.png" alt="在这里插入图片描述"></p> </li><li> <p>如果想查看带图形的日志使用<code>git log --graph</code>;<br> <img src="https://images2.imgbox.com/9c/e0/3MZhZDo7_o.png" alt="在这里插入图片描述"></p> </li><li> <p>定制记录的显示格式显示使用<code>git log --pretty=format:"%h - %an, %ar : %s"</code>；<a href="https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%9F%A5%E7%9C%8B%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2#pretty_format" rel="nofollow">点击查看常用格式选项</a><br> <img src="https://images2.imgbox.com/a7/c3/fTljXjr9_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<blockquote> 
 <p><code>--pretty</code>这个选项可以使用不同于默认格式的方式展示提交历史。 这个选项有一些内建的子选项供你使用。比如<code>oneline</code>会将每个提交放在一行显示，在浏览大量的提交时非常有用。 另外还有<code>short</code>，<code>full</code>和<code>fuller</code>选项，它们展示信息的格式基本一致，但是详尽程度不一。</p> 
</blockquote> 
<h4><a id="2__38"></a>2 筛选检索</h4> 
<ul><li>支持通过作者来查询<code>git log --auther='作者名'</code>；<br> <img src="https://images2.imgbox.com/f7/bc/fPo7IIeH_o.png" alt="在这里插入图片描述"></li><li>支持时间，<code>--after</code>、<code>--before</code>，after在某个时间点后；before在某个时间点前<code>git log --before='2021-03-12 12:29:29'</code>；<br> <img src="https://images2.imgbox.com/1e/79/zzziXtyU_o.png" alt="在这里插入图片描述"></li><li>支持时间区间，各个条件之间是<code>与</code>的关系，可以联合使用；<br> <img src="https://images2.imgbox.com/6f/b0/FljrmPdM_o.png" alt="在这里插入图片描述"></li></ul> 
<h4><a id="3__46"></a>3 最近提交</h4> 
<ul><li>直接使用<code>git log -n</code>查看即可，<code>n</code>为一个具体数字，前<code>n</code>条，可省略，省略则分页展示全部；<br> <img src="https://images2.imgbox.com/5c/e8/IOXAMKuK_o.png" alt="在这里插入图片描述"></li><li>显示简要的增改行数统计，每次提交文件的变更统计<code>git log --stat -n</code>，<code>-n</code>同上；<br> <img src="https://images2.imgbox.com/a6/df/Oz5YQCQ0_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="_51"></a>版本回退</h3> 
<h4><a id="1_reset_53"></a>1 <code>reset</code>方法回退</h4> 
<p>此种方式不是很推荐，通过<code>reset</code>的方式，把<code>head</code>指针指向之前的某次提交，<code>reset</code>之后，后面的版本就找不到了。例如我们在开发种一共提交了四次分别是A、B、C、D，此时我们发现操作失误需要回退到B，则使用<code>reset</code>之后C、D就不再存在与时间线上了。</p> 
<pre><code>git reset --hard commit id
</code></pre> 
<p><code>reset</code>回退操作步骤：</p> 
<ol><li>使用<code>git log</code>查找到所需要回退到的版本号，即提交记录的<code>commit id</code>；例如：<code>576223db1ee100a79b4f82d6713cef700d723018</code>；</li><li>在客户端执行如下命令（执行前，先将本地代码切换到对应分支）<code>git reset --hard 576223db1ee100a79b4f82d6713cef700d723018</code>；<br> <img src="https://images2.imgbox.com/3a/6d/DT62iKtw_o.png" alt="在这里插入图片描述"></li><li>强制push到对应的远程分支<code>git push -f -u origin master</code>或者<code>git push -f</code>，此时如果用<code>git push</code>会报错，因为我们本地库HEAD指向的版本比远程库的要旧;<br> <img src="https://images2.imgbox.com/14/04/bUYtFVGN_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/00/52/GoqfMh2l_o.png" alt="在这里插入图片描述"></li></ol> 
<p>此时，版本回退完成。</p> 
<blockquote> 
 <p>这种操作存在一个问题，服务器上的代码虽然被还原了，但假如有多个人在使用，他们本地的版本依然是比服务器上的版本高的，所以，别人再重新提交代码的话，你撤销的操作又会被重新，你上面的操作也就白操作了。解决办法是，让别人把本地的分支先删掉，然后重新从服务器上拉取分支。</p> 
</blockquote> 
<h4><a id="2_revert_71"></a>2 <code>revert</code>方法回退</h4> 
<p>这种方式就比较推荐了，这种方式不会把版本往前回退，而是生成一个新的版本。所以，你只需要让别人更新一下代码就可以了，你之前操作的提交记录也会被保留下来。例如我们在开发种一共提交了四次分别是A、B、C、D，此时我们发现操作失误需要回退到B，则使用<code>revert</code>之后会生成一个E版本。</p> 
<pre><code>git revert -n commit id
</code></pre> 
<p><code>revert</code>回退操作步骤：</p> 
<ol><li>使用<code>git log</code>查找到所需要回退到的版本号，即提交记录的<code>commit id</code>；例如：<code>a53a22f1e8b7ed0c7a9355e8563d234b5b99dd53</code>；</li><li>在客户端执行如下命令<code>git revert -n a53a22f1e8b7ed0c7a9355e8563d234b5b99dd53</code>;</li><li>使用<code>git commit -m '版本回退'</code>进行提交；</li><li><code>git push</code>同步推送到远程仓库即可；</li></ol> 
<p>推送之后让其他人更新一下本地代码即可。</p> 
<h3><a id="_86"></a>恢复回退</h3> 
<p>这个时候突然又发现不需要回退了，刚才那些消失的代码又要重新找回来了，别担心，这种操作步骤和版本回退一个倒立！</p> 
<ol><li> <p>我们可以通过<code>git reflog</code>查看本地的操作历史，找到对应的<code>commit id</code>；<br> <img src="https://images2.imgbox.com/fa/84/lyHvtR04_o.png" alt="在这里插入图片描述"></p> </li><li> <p>然后再使用<code>git reset --hard commit id</code>就回到之前的操作了。<br> <img src="https://images2.imgbox.com/61/58/PVDLshAO_o.png" alt="在这里插入图片描述"></p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/098b2fe14db13469187e9b57c2b8722d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">docker部署sentinel</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fdcd1f0a90fad741e6fbd73f767b6e7f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PICT用例设计工具介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>