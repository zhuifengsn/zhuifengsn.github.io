<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GTest从入门到入门 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="GTest从入门到入门" />
<meta property="og:description" content="GTest从入门到入门 1 GTest简介 GTest是Google的开源库，是一个功能强大的跨平台C&#43;&#43;测试功能库。对于非测试工程师的开发人员来说，学习GTest有利于进行代码的单元测试。
GTest的功能不止于单元测试，事实上，GTest可以适用于各种测试。
GTest的文档中如是说。但小白只是个初级程序员，所以能做好单元测试已经非常满足了。
2 GTest 1.8.1 VS2013&#43;CMake 编译 GTest作为一个开源项目，在github上有完整源码并还在维护中
GTest传送门
截至小白写这篇博客为止，GTest的最新版本是v1.11.0，但是很可惜，这个最新版本不支持VS2013，必须要VS2015以上才能使用。鉴于小白工作团队使用的工具所限，小白只能选择最后一个支持VS2013的GTest版本，即v1.8.1。
从github上把v1.8.1版本的源码下载下来，然后用CMake进行编译。
这个编译过程非常简单，比之GLOG的少了不少坑。
默认的配置就好，不需要更改任何勾选。
打开工程之后，直接“生成”-&gt;“批生成”-&gt;ALL_BUILD和INSTALL的Release x64生成。
然后掉进第一个坑：
这里的两个bug不是什么大事，只需要修改一下gmock和gmock_main两个项目下的属性：
在C/C&#43;&#43; -&gt; 常规 -&gt; “将警告视为错误”选成“否”。
再次尝试，有可能遇上以下bug:
这个问题需要在INSTALL项目的属性下，修改“配置属性”-&gt; “生成事件”-&gt; “后期生成事件”，把“命令行”一行内的代码删除。这行命令需要有管理员权限，小白这里没有。简单粗暴，咋就不进行相关操作了，毕竟我们是通过第三方库的方式调用，并不需要注册到系统。
如果一切顺利的话，应该会有7个项目编译成功：
至此编译应该是成功了，我们再建一个工程testGtest目录如下：
├─3rdparty │ └─gtest │ ├─include │ │ └─gtest │ │ └─internal │ │ └─custom │ └─lib ├─build │ └─x64 │ └─Release ├─source └─windows └─testGtest └─x64 └─Release └─testGtest.tlog 这里只需要特别注意一下3rdparty目录下的结构：
gtest的include下一定要按照gtest的源路径关系设置，具体可参考源码路径下的
googletest-release-1.8.1\googletest\include\gtest
lib中只需要刚刚编译得到的gtest.lib和gtest_mock.lib，这两个文件从刚刚编译的build路径下的
build\googlemock\gtest\Release去寻找即可。（这里有一点点坑，编译得到库的位置在googlemock目录下，而没有直接的gtest或googletest目录）
到这里，我们的准备工作就做完了。（不得不感叹，还是比GLOG编译时遇到的坑要少很多）。
3. GTest基础 GTest的文档翔实，地址在GoogleTest Primer。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/97f73941c323488939ff9fa6650a19e0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-23T07:06:45+08:00" />
<meta property="article:modified_time" content="2022-06-23T07:06:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">GTest从入门到入门</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="GTest_0"></a>GTest从入门到入门</h2> 
<h3><a id="1_GTest_1"></a>1 GTest简介</h3> 
<p>GTest是Google的开源库，是一个功能强大的跨平台C++测试功能库。对于非测试工程师的开发人员来说，学习GTest有利于进行代码的单元测试。</p> 
<blockquote> 
 <p>GTest的功能不止于单元测试，事实上，GTest可以适用于各种测试。</p> 
</blockquote> 
<p>GTest的文档中如是说。但小白只是个初级程序员，所以能做好单元测试已经非常满足了。</p> 
<h3><a id="2_GTest_181_VS2013CMake__6"></a>2 GTest 1.8.1 VS2013+CMake 编译</h3> 
<p>GTest作为一个开源项目，在github上有完整源码并还在维护中<br> <a href="https://github.com/google/googletest">GTest传送门</a><br> 截至小白写这篇博客为止，GTest的最新版本是v1.11.0，但是很可惜，这个最新版本不支持VS2013，必须要VS2015以上才能使用。鉴于小白工作团队使用的工具所限，小白只能选择最后一个支持VS2013的GTest版本，即v1.8.1。<br> 从github上把v1.8.1版本的源码下载下来，然后用CMake进行编译。<br> 这个编译过程非常简单，比之GLOG的少了不少坑。<br> <img src="https://images2.imgbox.com/4a/10/yJdf8GSm_o.png" alt="在这里插入图片描述"></p> 
<p>默认的配置就好，不需要更改任何勾选。<br> 打开工程之后，直接“生成”-&gt;“批生成”-&gt;ALL_BUILD和INSTALL的Release x64生成。<br> 然后掉进第一个坑：<br> <img src="https://images2.imgbox.com/1e/9e/QweQi3PW_o.png" alt="在这里插入图片描述"></p> 
<p>这里的两个bug不是什么大事，只需要修改一下gmock和gmock_main两个项目下的属性：<br> <img src="https://images2.imgbox.com/2e/39/n6wosK9Q_o.png" alt="在这里插入图片描述"></p> 
<p>在C/C++ -&gt; 常规 -&gt; “将警告视为错误”选成“否”。<br> 再次尝试，有可能遇上以下bug:<br> <img src="https://images2.imgbox.com/5a/37/0b8WZCCt_o.png" alt="在这里插入图片描述"></p> 
<p>这个问题需要在INSTALL项目的属性下，修改“配置属性”-&gt; “生成事件”-&gt; “后期生成事件”，把“命令行”一行内的代码删除。这行命令需要有管理员权限，小白这里没有。简单粗暴，咋就不进行相关操作了，毕竟我们是通过第三方库的方式调用，并不需要注册到系统。<br> <img src="https://images2.imgbox.com/8f/d4/hKcC6I0Z_o.png" alt="在这里插入图片描述"></p> 
<p>如果一切顺利的话，应该会有7个项目编译成功：<br> <img src="https://images2.imgbox.com/ba/53/CFJe4Dqz_o.png" alt="在这里插入图片描述"></p> 
<p>至此编译应该是成功了，我们再建一个工程testGtest目录如下：</p> 
<pre><code class="prism language-shell">├─3rdparty
│  └─gtest
│      ├─include
│      │  └─gtest
│      │      └─internal
│      │          └─custom
│      └─lib
├─build
│  └─x64
│      └─Release
├─source
└─windows
    └─testGtest
        └─x64
            └─Release
                └─testGtest.tlog
</code></pre> 
<p>这里只需要特别注意一下<code>3rdparty</code>目录下的结构：<br> gtest的include下一定要按照gtest的源路径关系设置，具体可参考源码路径下的<br> <code>googletest-release-1.8.1\googletest\include\gtest</code><br> lib中只需要刚刚编译得到的gtest.lib和gtest_mock.lib，这两个文件从刚刚编译的build路径下的<br> <code>build\googlemock\gtest\Release</code>去寻找即可。（这里有一点点坑，编译得到库的位置在googlemock目录下，而没有直接的gtest或googletest目录）<br> 到这里，我们的准备工作就做完了。（不得不感叹，还是比GLOG编译时遇到的坑要少很多）。</p> 
<h3><a id="3_GTest_57"></a>3. GTest基础</h3> 
<p>GTest的文档翔实，地址在<a href="https://google.github.io/googletest/primer.html" rel="nofollow">GoogleTest Primer</a>。<br> 鉴于我们的目的是以实用为主，所以只需要把一些基本的内容了解一遍：</p> 
<h4><a id="31__60"></a>3.1 几个概念的辨析</h4> 
<p><code>test</code> 、<code>test case</code>、 <code>test suite</code><br> <code>test case</code>是测试领域常用的概念，即测试用例。但在GTest中，<code>test case</code>指的是一组测试，而不是通常概念里的单个用例。GTest中所说的单个测试用例则是用名词<code>test</code>。为了统一，GTest在最近发布的版本中有意识地使用<code>test suite</code>来替换原先的<code>test case</code>，防止发生混淆。<br> GTest的测试基本上是以组为单位的，要为“组”提供一个命名。接下来的TEST()宏中将会详细介绍。</p> 
<h4><a id="32_TEST_ASSERTEXPECT_64"></a>3.2 TEST() ASSERT和EXPECT宏</h4> 
<p>GTest使用的断言其实是类似于函数调用的宏。可以通过断言类或函数的行为来进行测试。当断言失败时，GTest将会打印断言的源文件及行号位置，以及一条失败信息。GTest还允许提供一条自定义的失败信息，此信息可以添加到断言附加的信息当中去。<br> 断言是成对出现的，<code>ASSERT_*</code>和<code>EXPECT_*</code>这两种断言类的宏都可以实现测试，所不同的是，<code>ASSERT_*</code>类型的断言一旦证伪，则会直接中止测试程序，而若<code>EXPECT_*</code>类型的断言被证伪，则不会立即中止程序 ，而是会继续执行程序。<br> 因此更加推荐的是<code>EXPECT_*</code>类型的断言。<br> 下面是一个用来判断x和y是否长度相等，并找出其中不同元素的实例：</p> 
<pre><code class="prism language-cpp"><span class="token function">ASSERT_EQ</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Vectors x and y are of unequal length"</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> x<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Vectors x and y differ at index "</span> <span class="token operator">&lt;&lt;</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>任何可以流式传输到 ostream 的内容都可以流式传输到断言宏，尤其是 C 字符串和字符串对象。如果将宽字符串（<code>wchar_t*</code>、Windows 上 UNICODE 模式下的 <code>TCHAR*</code> 或 <code>std::wstring</code>）流式传输到断言，则在打印时将转换为 UTF-8。</p> 
<p>创建测试：</p> 
<ul><li>使用 <code>TEST()</code>宏定义和命名测试函数。这些是普通的C++无返回值的函数。</li><li>在此函数中，以及要包含的任何有效的C++语句，请使用各种 googletest 断言来检查值。</li><li>测试的结果由断言决定;如果测试中的任何断言失败（致命或非致命），或者测试崩溃，则整个测试失败。否则，它将成功。</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">TEST</span><span class="token punctuation">(</span>TestSuiteName<span class="token punctuation">,</span> TestName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> test body <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>TEST()</code>参数从一般到特定。第一个参数是测试套件<code>test suite</code>的名称，第二个参数是测试套件中的测试名称<code>test name</code>。这两个名称都必须是有效的C++标识符，并且不应包含任何下划线 （<code>_</code>）。测试的全名由其包含的测试套件和单个名称组成。来自不同测试套件的测试可以具有相同的单个名称。</p> 
<p>例如，一个普通的整型返回值函数</p> 
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">Factorial</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 返回n的阶乘</span>
</code></pre> 
<p>一个测试套件<code>test suite</code>可能如下所示：</p> 
<pre><code>// Tests factorial of 0.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Tests factorial of positive numbers.
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
</code></pre> 
<p>googletest按测试套件对测试结果进行分组，因此逻辑上相关的测试应该位于同一测试套件中;换句话说，他们的 <code>TEST()</code> 的第一个参数应该是相同的。在上面的示例中，我们有两个测试，<code>HandlesZeroInput</code>和<code>HandlesPositiveInput</code>，它们属于同一个测试套件<code>FactorialTest</code>。</p> 
<h4><a id="33_RUN_ALL_TESTS_113"></a>3.3 RUN_ALL_TESTS()</h4> 
<p>定义测试后，可以使用 <code>RUN_ALL_TESTS()</code> 运行它们，如果所有测试都成功，则返回 0，否则返回 1。请注意，<code>RUN_ALL_TESTS()</code> 运行链接单元中的所有测试 - 它们可以来自不同的测试套件，甚至可以来自不同的源文件。<br> 可以不精确地概括为：<code>RUN_ALL_TESTS()</code>是整个测试程序的统一入口和统一出口。<br> 调用时，<code>RUN_ALL_TESTS()</code> 宏：</p> 
<ul><li>保存所有谷歌测试标志的状态。</li><li>为第一个测试创建测试夹具对象(有关夹具的内容，请参阅TEST_F宏，本文未涉及)。</li><li>通过 SetUp（） 对其进行初始化。</li><li>对夹具对象运行测试。</li><li>通过 TearDown（） 清理夹具。</li><li>删除夹具。</li><li>恢复所有谷歌测试标志的状态。</li><li>对下一个测试重复上述步骤，直到所有测试都已运行。</li><li>如果发生致命故障，将跳过后续步骤。</li></ul> 
<blockquote> 
 <p>重要说明：不能忽略 <code>RUN_ALL_TESTS()</code> 的返回值，否则将收到编译器错误。此设计的基本原理是，自动测试服务根据其退出代码（而不是 stdout/stderr 输出）确定测试是否已通过;因此，<code>main()</code> 函数必须返回 <code>RUN_ALL_TESTS()</code> 的值。<br> 另外，<code>RUN_ALL_TESTS()</code>只允许调用一次。调用它不止一次与某些高级googletest功能（例如，线程安全的死亡测试）冲突，因此不受支持。</p> 
</blockquote> 
<h4><a id="34__testingInitGoogleTestargc_argv__main_129"></a>3.4 ::testing::InitGoogleTest(&amp;argc, argv) 和 main()</h4> 
<p>大多数用户不需要编写自己的 main 函数，而是与 gtest_main（而不是 gtest）链接，这定义了一个合适的入口点。本节的其余部分应仅在您需要在测试运行之前执行自定义操作时才适用，这些自定义内容无法在夹具和测试套件的框架内表示。<br> 示例代码长这样：</p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"this/package/foo.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"gtest/gtest.h"</span></span>

<span class="token keyword">namespace</span> my <span class="token punctuation">{<!-- --></span>
<span class="token keyword">namespace</span> project <span class="token punctuation">{<!-- --></span>
<span class="token keyword">namespace</span> <span class="token punctuation">{<!-- --></span>

<span class="token comment">// The fixture for testing class Foo.</span>
<span class="token keyword">class</span> <span class="token class-name">FooTest</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token double-colon punctuation">::</span>testing<span class="token double-colon punctuation">::</span><span class="token class-name">Test</span></span> <span class="token punctuation">{<!-- --></span>
 <span class="token keyword">protected</span><span class="token operator">:</span>
  <span class="token comment">// You can remove any or all of the following functions if their bodies would</span>
  <span class="token comment">// be empty.</span>

  <span class="token function">FooTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// You can do set-up work for each test here.</span>
  <span class="token punctuation">}</span>

  <span class="token operator">~</span><span class="token function">FooTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// You can do clean-up work that doesn't throw exceptions here.</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// If the constructor and destructor are not enough for setting up</span>
  <span class="token comment">// and cleaning up each test, you can define the following methods:</span>

  <span class="token keyword">void</span> <span class="token function">SetUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// Code here will be called immediately after the constructor (right</span>
     <span class="token comment">// before each test).</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">TearDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">override</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// Code here will be called immediately after each test (right</span>
     <span class="token comment">// before the destructor).</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Class members declared here can be used by all tests in the test suite</span>
  <span class="token comment">// for Foo.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Tests that the Foo::Bar() method does Abc.</span>
<span class="token function">TEST_F</span><span class="token punctuation">(</span>FooTest<span class="token punctuation">,</span> MethodBarDoesAbc<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string input_filepath <span class="token operator">=</span> <span class="token string">"this/package/testdata/myinputfile.dat"</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> std<span class="token double-colon punctuation">::</span>string output_filepath <span class="token operator">=</span> <span class="token string">"this/package/testdata/myoutputfile.dat"</span><span class="token punctuation">;</span>
  Foo f<span class="token punctuation">;</span>
  <span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">Bar</span><span class="token punctuation">(</span>input_filepath<span class="token punctuation">,</span> output_filepath<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Tests that Foo does Xyz.</span>
<span class="token function">TEST_F</span><span class="token punctuation">(</span>FooTest<span class="token punctuation">,</span> DoesXyz<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// Exercises the Xyz feature of Foo.</span>
<span class="token punctuation">}</span>

<span class="token punctuation">}</span>  <span class="token comment">// namespace</span>
<span class="token punctuation">}</span>  <span class="token comment">// namespace project</span>
<span class="token punctuation">}</span>  <span class="token comment">// namespace my</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token double-colon punctuation">::</span>testing<span class="token double-colon punctuation">::</span><span class="token function">InitGoogleTest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">RUN_ALL_TESTS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>::testing::InitGoogleTest()</code>函数解析 googletest 标志的命令行，并删除所有识别的标志。这允许用户通过各种标志来控制测试程序的行为，我们将在高级指南中介绍这些标志。在调用<code>RUN_ALL_TESTS()</code> 之前，必须调用此函数，否则标志将无法正确初始化。<br> 在Windows上，<code>InitGoogleTest()</code>也适用于宽字符串，因此它也可以在UNICODE模式下编译的程序中使用。</p> 
<h4><a id="35__196"></a>3.5 小白的示例</h4> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;gtest/gtest.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">TEST</span><span class="token punctuation">(</span>AddTest<span class="token punctuation">,</span> Positive<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">TEST</span><span class="token punctuation">(</span>AddTest<span class="token punctuation">,</span> Negative<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	testing<span class="token double-colon punctuation">::</span><span class="token function">InitGoogleTest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">RUN_ALL_TESTS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>使用cmd工具运行并查看结果：<br> <img src="https://images2.imgbox.com/36/50/VPwM2Vij_o.png" alt="在这里插入图片描述"></p> 
<p>可以看到这里的测试均通过了，满眼的绿灯。<br> 为了看看错误的结果，我们故意修改了代码。</p> 
<pre><code class="prism language-cpp"><span class="token function">TEST</span><span class="token punctuation">(</span>AddTest<span class="token punctuation">,</span> Negative<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">EXPECT_EQ</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 强行改变“正确答案”</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>接下来我们就得到了有红灯的测试结果：<br> <img src="https://images2.imgbox.com/89/48/MaaebBVF_o.png" alt="在这里插入图片描述"></p> 
<p>我们可以看到所有的测试均进行完毕，并且给出了或passed或failed的结果。</p> 
<h4><a id="36_TEST_F_243"></a>3.6 进阶之TEST_F()宏</h4> 
<p>这部分内容大致浏览了一下，其主要用法和TEST()宏接近一致，但其的最大作用是可以重复使用测试数据进行多次测试。<br> 由于这篇文章只是“从入门到入门”，这里的内容就留待以后有深入使用研究时再做学习。<br> 【水平所限，难免错漏】<br> 【创作不易，轻喷勿骂】</p> 
<p><img src="https://images2.imgbox.com/75/05/7Lj2PiuC_o.gif" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bec185898f29a93a8ebde67c50f3bbda/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">算法-四种单链表反转方法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f15adea497b29f35b739fd793c4e4771/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">uniapp使用阿里百川SDK唤醒淘宝APP 打开淘宝领券页面/渠道备案,uniapp对接淘宝联盟等等超级详细</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>