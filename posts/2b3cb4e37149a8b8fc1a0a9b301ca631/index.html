<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Ajax异步、同步问题——Ajax和JavaScript执行顺序 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Ajax异步、同步问题——Ajax和JavaScript执行顺序" />
<meta property="og:description" content="第零章 准备工作 Ajax根据async进行区分同步和异步过程，当async=true异步，async=false为同步，ajax默认async为异步。
异步：Ajax不会影响整个页面的加载，相当于和浏览器加载或者用户操作分开走，互不相干，体现在用户角度就是不会有什么卡顿的感觉仿佛无事发生。
同步：那就与异步相反，Ajax和js加载处于同一条线上，就是在加载Ajax的时候，全部的过程都等停下来，也就是假死状态。
测试代码
index.jsp
&lt;%@ page contentType=&#34;text/html;charset=UTF-8&#34; language=&#34;java&#34; %&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;index&lt;/title&gt; &lt;script src=&#34;js/jquery-3.6.1.js&#34;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script&gt; function f() { let inputData = $(&#34;#inputData&#34;).val(); let v; $.ajax({ url: &#34;/TestServlet&#34;, data: {&#34;inputData&#34;: inputData}, success: function (data) { v = data; alert(&#34;Ajax:&#34; &#43; v); } }); alert(&#34;f():&#34; &#43; v); } &lt;/script&gt; &lt;label for=&#34;inputData&#34;&gt;&lt;/label&gt;&lt;input type=&#34;text&#34; id=&#34;inputData&#34; οnblur=&#34;f()&#34;&gt; &lt;/body&gt; &lt;/html&gt; TestServlet.java
import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/2b3cb4e37149a8b8fc1a0a9b301ca631/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-04T18:36:59+08:00" />
<meta property="article:modified_time" content="2022-09-04T18:36:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Ajax异步、同步问题——Ajax和JavaScript执行顺序</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>第零章 准备工作</h2> 
<p>Ajax根据async进行区分同步和异步过程，当async=true异步，async=false为同步，ajax默认async为异步。</p> 
<p>异步：Ajax不会影响整个页面的加载，相当于和浏览器加载或者用户操作分开走，互不相干，体现在用户角度就是不会有什么卡顿的感觉仿佛无事发生。</p> 
<p>同步：那就与异步相反，Ajax和js加载处于同一条线上，就是在加载Ajax的时候，全部的过程都等停下来，也就是假死状态。</p> 
<p></p> 
<p><strong>测试代码</strong></p> 
<p>index.jsp</p> 
<pre> &lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
 &lt;html&gt;
 &lt;head&gt;
     &lt;title&gt;index&lt;/title&gt;
     &lt;script src="js/jquery-3.6.1.js"&gt;&lt;/script&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;script&gt;
     function f() {
         let inputData = $("#inputData").val();
         let v;
         $.ajax({
             url: "/TestServlet",
             data: {"inputData": inputData},
             success: function (data) {
                 v = data;
                 alert("Ajax:" + v);
             }
         });
         alert("f():" + v);
     }
 &lt;/script&gt;
 &lt;label for="inputData"&gt;&lt;/label&gt;&lt;input type="text" id="inputData" οnblur="f()"&gt;
 &lt;/body&gt;
 &lt;/html&gt;</pre> 
<p></p> 
<p>TestServlet.java</p> 
<pre> import javax.servlet.ServletException;
 import javax.servlet.annotation.WebServlet;
 import javax.servlet.http.HttpServlet;
 import javax.servlet.http.HttpServletRequest;
 import javax.servlet.http.HttpServletResponse;
 import java.io.IOException;
 ​
 @WebServlet("/TestServlet")
 public class TestServlet extends HttpServlet {
     @Override
     protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
         String inputData = req.getParameter("inputData");
         resp.getWriter().print("TestServlet:"+inputData);
     }
 }</pre> 
<p></p> 
<p><strong>运行过程</strong></p> 
<p>前端（index.jsp）input输入框内容失去焦点后，激活 οnblur="f()" 通过Ajax发送到后端（TestServlet.java）</p> 
<p>后端（TestServlet.java）收到数据（inputData）后打上标记（"TestServlet:"）后返回</p> 
<p>alert再Ajax和f()里面弹窗显示并分别打上标记（"Ajax:"，"f():"）</p> 
<p></p> 
<p><strong>说明</strong></p> 
<p>onblur：鼠标点击输入框外的地方会失去焦点，执行f()函数</p> 
<p>标记：通过标记可以知道数据有没有经过后端，来自那个地方</p> 
<p></p> 
<h3>第一章 Ajax异步</h3> 
<p><strong>测试结果</strong></p> 
<p>在输入框输入：</p> 
<pre> aaa</pre> 
<p>失去焦点后</p> 
<p>第一次弹窗：</p> 
<pre> f():undefined</pre> 
<p>第二次弹窗：</p> 
<pre> Ajax:TestServlet:aaa</pre> 
<p></p> 
<p><strong>思考</strong></p> 
<blockquote> 
 <p>（1）</p> 
 <p>代码里面标记"Ajax:"在前面，标记"f():"在后面</p> 
 <p>输出结果是先输出标记"f():"后输出标记"Ajax:"</p> 
 <p>（2）</p> 
 <p>Ajax获取到了后端的数据Ajax:TestServlet:aaa</p> 
 <p>f()输出的是f():undefined</p> 
</blockquote> 
<p></p> 
<p>当未开启异步的时候：当js执行到Ajax的时候，Ajax和js加载处于同两条线上，各自执行各自的</p> 
<p>Ajax去给后端发送数据的时候，js接着向下执行，当执行到alert的时候v并没有被赋值，输出f():undefined</p> 
<p>Ajax携带数据（TestServlet:aaa）回来的时候，js的alert已经执行完了，接着向下执行，v有了值（TestServlet:aaa），alert输出Ajax:TestServlet:aaa</p> 
<p></p> 
<p><strong>让Ajax和js在同一条线上执行？</strong></p> 
<blockquote> 
 <p>设置：async=false</p> 
</blockquote> 
<p></p> 
<h3>第二章 Ajax同步</h3> 
<p>关闭Ajax异步</p> 
<p>index.jsp添加async:false,</p> 
<pre> &lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
 &lt;html&gt;
 &lt;head&gt;
     &lt;title&gt;index&lt;/title&gt;
     &lt;script src="js/jquery-3.6.1.js"&gt;&lt;/script&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;script&gt;
     function f() {
         let inputData = $("#inputData").val();
         let v;
         $.ajax({
             url: "/TestServlet",
             data: {"inputData": inputData},
             async:false,
             success: function (data) {
                 v = data;
                 alert("Ajax:" + v);
             }
         });
         alert("f():" + v);
     }
 &lt;/script&gt;
 &lt;label for="inputData"&gt;&lt;/label&gt;&lt;input type="text" id="inputData" οnblur="f()"&gt;
 &lt;/body&gt;
 &lt;/html&gt;</pre> 
<p></p> 
<p><strong>测试结果</strong></p> 
<p>第一次弹窗</p> 
<pre> Ajax:TestServlet:aaa</pre> 
<p>第二次弹窗</p> 
<pre> f():TestServlet:aaa</pre> 
<p></p> 
<p>程序按照代码顺序执行，Ajax和js在同一条线上</p> 
<p></p> 
<h3>第三章 总结</h3> 
<p>Ajax的执行默认是异步的，要想Ajax按和js同步执行需要关闭异步请求设置async=false；注意ajax异步时，写return返回也是undefined，return属于外面的函数。</p> 
<p></p> 
<p><strong>参考</strong></p> 
<p><a href="https://www.cnblogs.com/luza/p/9581500.html" rel="nofollow" title="浅谈ajax同步、异步的问题">浅谈ajax同步、异步的问题</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c23884d827b473ac59e5241e5925a9e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python 使用接缝雕刻移除目标</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1ff1014ae860950fffa250141c8cf1cb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">监督机器学习——基于手写数字数据集的图像分类</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>