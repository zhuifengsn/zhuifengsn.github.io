<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JAVA解析HL7报文数据V24 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="JAVA解析HL7报文数据V24" />
<meta property="og:description" content="1、HL7测试工具 测试工具用到了7Edit，使用可参考7Edit解析工具的使用(二)_hl7格式工具_WW大魔王的博客-CSDN博客
2、用到的Jar包 &lt;!-- https://mvnrepository.com/artifact/ca.uhn.hapi/hapi-base --&gt; &lt;dependency&gt; &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt; &lt;artifactId&gt;hapi-base&lt;/artifactId&gt; &lt;version&gt;2.3&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/ca.uhn.hapi/hapi-structures-v24 --&gt; &lt;dependency&gt; &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt; &lt;artifactId&gt;hapi-structures-v24&lt;/artifactId&gt; &lt;version&gt;2.3&lt;/version&gt; &lt;/dependency&gt; 3、JAVA解析Demo 3.1 简单的Demo 下面的demo中，需要注意几点：
1、换行要使用\r不能使用\n
2、每个段前面的第一个属性为段名，使用message.get()时，会自动匹配到对应段的实体类，如下面访问MFI段，没有对应实体类的段使用通用的类GenericSegment类进行解析如示例中的Z2B段。
import ca.uhn.hl7v2.HL7Exception; import ca.uhn.hl7v2.model.GenericSegment; import ca.uhn.hl7v2.model.Message; import ca.uhn.hl7v2.model.v24.segment.MFI; import ca.uhn.hl7v2.parser.PipeParser; /** * @author 崔 * @version 0.0.1 * @Date 2023/7/26 18:45 */ public class HL7ParserExample { public static void main(String[] args) throws HL7Exception { // 示例HL7 XML消息 String hl7XML = &#34;MSH|^~\\&amp;|HIS^1|MediInfo|MediII^1|MediInfo|20180417152317||MFN^Z2B^MFN_Z2B|39a3d175f5034a2a9d41d35c911d0562|P|2.4\r&#34; &#43; &#34;MFI|Z2B||UPD|||AL\r&#34; &#43; &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/f537d31382ff7a3cc99e0db2175d1c30/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-27T15:32:23+08:00" />
<meta property="article:modified_time" content="2023-07-27T15:32:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">JAVA解析HL7报文数据V24</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>1、HL7测试工具</h2> 
<p>测试工具用到了<a class="link-info" href="https://7edit.com/home/" rel="nofollow" title="7Edit">7Edit</a>，使用可参考<a href="https://blog.csdn.net/LWS826528071/article/details/118937825" title="7Edit解析工具的使用(二)_hl7格式工具_WW大魔王的博客-CSDN博客">7Edit解析工具的使用(二)_hl7格式工具_WW大魔王的博客-CSDN博客</a></p> 
<p><img alt="" height="750" src="https://images2.imgbox.com/8a/73/kbikKkuj_o.png" width="1200"></p> 
<p></p> 
<h2>2、用到的Jar包</h2> 
<pre><code class="language-java">&lt;!-- https://mvnrepository.com/artifact/ca.uhn.hapi/hapi-base --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt;
    &lt;artifactId&gt;hapi-base&lt;/artifactId&gt;
    &lt;version&gt;2.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/ca.uhn.hapi/hapi-structures-v24 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt;
    &lt;artifactId&gt;hapi-structures-v24&lt;/artifactId&gt;
    &lt;version&gt;2.3&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
<p></p> 
<h2>3、JAVA解析Demo</h2> 
<h3>3.1 简单的Demo</h3> 
<p>下面的demo中，需要注意几点：</p> 
<p>1、换行要使用\r不能使用\n</p> 
<p>2、每个段前面的第一个属性为段名，使用message.get()时，会自动匹配到对应段的实体类，如下面访问MFI段，没有对应实体类的段使用通用的类GenericSegment类进行解析如示例中的Z2B段。</p> 
<pre><code class="language-java">import ca.uhn.hl7v2.HL7Exception;
import ca.uhn.hl7v2.model.GenericSegment;
import ca.uhn.hl7v2.model.Message;
import ca.uhn.hl7v2.model.v24.segment.MFI;
import ca.uhn.hl7v2.parser.PipeParser;

/**
 * @author 崔
 * @version 0.0.1
 * @Date 2023/7/26 18:45
 */
public class HL7ParserExample {
    public static void main(String[] args) throws HL7Exception {
        // 示例HL7 XML消息
        String hl7XML = "MSH|^~\\&amp;|HIS^1|MediInfo|MediII^1|MediInfo|20180417152317||MFN^Z2B^MFN_Z2B|39a3d175f5034a2a9d41d35c911d0562|P|2.4\r" +
                "MFI|Z2B||UPD|||AL\r" +
                "MFE|MAD|9a3b31292e3a47e1b59f63ba15c47f94||0|ST\r" +
                "Z2B|10741|2|demo||||||||1|0|0|0|^MZYVIPMZQ~^QKAVIPUYY~^QKAVIPUYY|9999|20180417153203|21||0|11000000000000000000000000";

        // 创建一个新的PipeParser实例
        PipeParser parser = new PipeParser();

        // 解析HL7 XML消息
        Message message = parser.parse(hl7XML);

        // 访问MFI段
        MFI mfi = (MFI) message.get("MFI");
        // 获取MFI段的第一段中的第1个属性
        System.out.println(mfi.getMfi1_MasterFileIdentifier().getIdentifier());

        // 访问Z2B段（GenericSegment）
        GenericSegment genericSegment = (GenericSegment) message.get("Z2B");

        // 从Z2B段中提取并打印特定字段
        System.out.println("第15段第1个属性" + genericSegment.getField(15, 0).encode());
        System.out.println("第15段第2个属性" + genericSegment.getField(15, 1).encode());
    }
}
</code></pre> 
<p>打印结果</p> 
<pre><code class="language-java">Z2B
^MZYVIPMZQ
^QKAVIPUYY</code></pre> 
<h3>3.2 如何获取想要的节点数据</h3> 
<p>如上面示例</p> 
<pre><code class="language-java"> MFI mfi = (MFI) message.get("MFI");
 System.out.println(mfi.getMfi1_MasterFileIdentifier().getIdentifier());</code></pre> 
<p>怎么要获取MFI里面哪个数据，工具7Edit解析中，在每个标签后面都加了字段名称，直接get就可以获取指定的数据。</p> 
<p>但是解析中数据类型和Java的数据类型并不匹配，字段有encode()方法，让解析的数据变成String数据类型。</p> 
<p><img alt="" height="546" src="https://images2.imgbox.com/6b/14/Lu1xf7q0_o.png" width="926"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eee42c6dd020c451aa1aeb72a71c3618/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java篇 类的进阶0x0C：枚举类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dba9a6d429fea36c26043e21f22f8c16/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux解决 Failed to restart NetworkManager.service: Unit not found问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>