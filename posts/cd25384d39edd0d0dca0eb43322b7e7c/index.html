<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习（一）协同过滤推荐算法 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习（一）协同过滤推荐算法" />
<meta property="og:description" content="1、算法简介
（1）推荐算法常见使用场景：电商产品推荐。基于产品的算法推荐，是分析用户历史行为数据，选择用户的浏览量、点赞数、评论数等数据高的产品，去推荐相似产品给用户。
（2）推荐算法作用：帮助用户发现他们感兴趣的产品。（1）节省用户的搜索时间，提高用户体验，减少流失。（2）延长用户的网站使用时间，提高用户忠诚度。
2、算法原理
（1）计算产品之间的相似度，生成相似度矩阵：
计算产品相似度可用3种方法：夹角余弦、杰卡德（Jaccard)相似系数、相关系数。
注：用户行为为二元选择（0/1）时，建议采用杰卡德相似系数。
相似度矩阵：
（2)基于产品相似度和用户已浏览产品a的数据，根据公式P=SIM*R,计算用户对未浏览产品b的感兴趣程度。
P-用户对b产品的感兴趣程度
SIM-a与b产品之间的相似度
R-用户对a产品感兴趣与否（1/0）
（3）基于产品相似度矩阵，推荐算法会给用户推荐与其数据最高产品最相似的K个产品。也可以基于产品兴趣度，给用户推荐其兴趣度最高的K个产品。
3、算法实现：
基于Python的Numpy库
import numpy as np #计算杰卡德相似系数的函数 #a:喜欢a产品的用户数 #b：喜欢b产品的用户数 def Jaccard(a,b): return 1.0*(a*b).sum()/(a&#43;b-a*b).sum() class Remommendor(): sim =None #相似度矩阵 #计算相似度矩阵的函数 def similarity(self,x,jaccard): y = np.ones((len(x),len(x))) for i in range(len(x)): for j in range(len(x)): y[i,j] = jaccard(x[i],y[j]) return y #训练函数 def fit(self,x,jaccard = Jaccard): self.sim = self.similarity(x.jaccard) #推荐函数 def recommend(self,a): return np.dot(self.sim,a)*(1-a) 4、模型评估：
对于用户可给产品打分的网站，使用预测准确度的评估指标。
对于用户只能选择“喜欢与否\浏览与否”的网站，要用分类准确度的评估指标。
这里重点解释基于分类准确度数据构建的模型的3个评估指标：
(1)准确率precesion：用户对被推荐产品感兴趣的概率；
准确率=用户被推荐产品中喜欢的数目/用户被推荐产品总数" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/cd25384d39edd0d0dca0eb43322b7e7c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-03T23:40:01+08:00" />
<meta property="article:modified_time" content="2022-05-03T23:40:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习（一）协同过滤推荐算法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>1、算法简介<br> （1）推荐算法常见使用场景：电商产品推荐。基于产品的算法推荐，是分析用户历史行为数据，选择用户的浏览量、点赞数、评论数等数据高的产品，去推荐相似产品给用户。<br> （2）推荐算法作用：帮助用户发现他们感兴趣的产品。（1）节省用户的搜索时间，提高用户体验，减少流失。（2）延长用户的网站使用时间，提高用户忠诚度。</p> 
<p>2、算法原理<br> （1）计算产品之间的相似度，生成相似度矩阵：<br> 计算产品相似度可用3种方法：夹角余弦、杰卡德（Jaccard)相似系数、相关系数。<br> 注：用户行为为二元选择（0/1）时，建议采用杰卡德相似系数。<br> <img src="https://images2.imgbox.com/4c/f8/QhO02eVR_o.png" alt="相似度计算公式"><br> 相似度矩阵：<br> <img src="https://images2.imgbox.com/e1/e9/4ksoixfJ_o.png" alt=""></p> 
<p>（2)基于产品相似度和用户已浏览产品a的数据，根据公式P=SIM*R,计算用户对未浏览产品b的感兴趣程度。</p> 
<ul><li> <p>P-用户对b产品的感兴趣程度</p> </li><li> <p>SIM-a与b产品之间的相似度</p> </li><li> <p>R-用户对a产品感兴趣与否（1/0）</p> </li></ul> 
<p>（3）基于产品相似度矩阵，推荐算法会给用户推荐与其数据最高产品最相似的K个产品。也可以基于产品兴趣度，给用户推荐其兴趣度最高的K个产品。</p> 
<p>3、算法实现：<br> 基于Python的Numpy库</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment">#计算杰卡德相似系数的函数</span>
<span class="token comment">#a:喜欢a产品的用户数</span>
<span class="token comment">#b：喜欢b产品的用户数</span>
<span class="token keyword">def</span> <span class="token function">Jaccard</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> <span class="token number">1.0</span><span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token operator">-</span>a<span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Remommendor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	sim <span class="token operator">=</span><span class="token boolean">None</span> <span class="token comment">#相似度矩阵</span>

	<span class="token comment">#计算相似度矩阵的函数</span>
	<span class="token keyword">def</span> <span class="token function">similarity</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>x<span class="token punctuation">,</span>jaccard<span class="token punctuation">)</span><span class="token punctuation">:</span>
		y <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			 	y<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> jaccard<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> y 
	<span class="token comment">#训练函数</span>
	<span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>x<span class="token punctuation">,</span>jaccard <span class="token operator">=</span> Jaccard<span class="token punctuation">)</span><span class="token punctuation">:</span>
		self<span class="token punctuation">.</span>sim <span class="token operator">=</span> self<span class="token punctuation">.</span>similarity<span class="token punctuation">(</span>x<span class="token punctuation">.</span>jaccard<span class="token punctuation">)</span>
	
	<span class="token comment">#推荐函数</span>
	<span class="token keyword">def</span> <span class="token function">recommend</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sim<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>a<span class="token punctuation">)</span>

</code></pre> 
<p>4、模型评估：<br> 对于用户可给产品打分的网站，使用预测准确度的评估指标。<br> 对于用户只能选择“喜欢与否\浏览与否”的网站，要用分类准确度的评估指标。<br> <img src="https://images2.imgbox.com/c2/c9/1nkr24dD_o.png" alt="不同数据表现方式所采用的评估指标"></p> 
<p>这里重点解释基于分类准确度数据构建的模型的3个评估指标：</p> 
<p>(1)准确率precesion：用户对被推荐产品感兴趣的概率；<br> 准确率=用户被推荐产品中喜欢的数目/用户被推荐产品总数<br> (2)召回率recall:一个用户喜欢的产品被推荐的概率；<br> Recall=用户喜欢且被推荐的产品数/（用户喜欢且被推荐产品数+用户喜欢且违背推荐产品数）；<br> （3）F1：综合考虑准确率和召回率，更好地评价算法的优劣；<br> 评估指标分数越高越好。</p> 
<p>5、注意事项</p> 
<p>以上为个性化推荐，还有2种相关推荐列表：<br> （1）推荐用户购买过的商品的相关商品<br> （2）推荐浏览过该商品的其他用户经常购买的其他商品<br> 相关推荐列表，是根据不同用户的行为，去计算商品的相似性，后面再写；</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0ebe4bfa73b98e51167869788fcc293f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">学习日记4.22-4.26</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/70e2fe2685d121c6537d7a58dee5af8e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">makefile和make</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>