<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>VS2017 WPF程序打包部署 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="VS2017 WPF程序打包部署" />
<meta property="og:description" content="一、安装Installer
1、工具-扩展和更新-联机
(1) 下载安装installer
(2)下载完成之后，关闭VS2017,重新启动之后，单击修改，安装插件
(3)关闭后重新打开要打包的工程
二、打包可执行程序
1、现有项目中选择解决方案资源管理器 -选择解决方案-右键-新建项目
三个文件夹分别指向要发送到[文件安装目录下/桌面/开始菜单]中的文件。
Application Folder：用来存放程序项目的可执行文件、资源（图片、音频、视频等）、各种依赖dll文件。 User&#39;s Desktop：用来生成桌面快捷方式User&#39;s Programs Menu：用来生成开始菜单快捷方式 2、Application Folder
（1）Application Folder右键选择Add&gt;项目输出，接着在弹出窗口中选择主输出，点击确定。
这一步生成如下：
（2）我的bin-Release文件下还有两个用于保存图片的文件夹
Add-Folder 并将文件夹重命名为bin-release文件下同样的名字
接着Add-文件 将Release文件的文件下的内容都添加进来
（3）接着通过add&gt;文件（或Folder）选项将程序运行所需要的其他资源文件、dll文件等全部添加到目录中，创建桌面快捷方式和菜单快捷方式时使用。
3、User&#39;s Desktop
选择主输出文件-右击生成快捷方式
对快捷方式重命名
给新建的快捷方式添加图标，图标路径从上面Images文件中添加
拖动到User&#39;s Desktop下
4、User&#39;s Programs Menu
（1）快捷方式创建
桌面快捷方式和菜单快捷方式创建的方法是相同的，按照User&#39;s Desktop下同样方式创建快捷方式，并拖到User&#39;s Programs Menu下
（2）安装包提供卸载功能
注意：32位和64位电脑的msiexec.exe相同
1）32位系统
注意：目标系统为32系统 属性中TargetPlatform设置为X86,目标系统为64系统 属性中TargetPlatform设置为X64
Application Folder右键添加文件&#34;C:\Windows\System32\msiexec.exe&#34;。
选中msiexec.exe文件右键创建快捷方式，命名为uninstall
选中uninstall快捷方式，Arguments属性设置为&#34;/x ProductCode&#34;，其中ProductCode的值取自setup project属性中的ProductCode的值。
卸载快捷方式拖动到User&#39;s Programs Menu下
注意为了菜单栏中生成快捷方式后，快捷方式和卸载快捷方式都在一个文件下，可以User&#39;s Programs Menu创建一个文件夹，将两个快捷方式放到该文件夹下
5、设置完毕，执行build生成解决方案
三、其他注意事项
1、图标转换网址
https://www.easyicon.net/covert/
参考：https://blog.csdn.net/smallbabylong/article/details/78756530
https://blog.csdn.net/Shenpibaipao/article/details/83152955
https://www.jianshu.com/p/0073859e9b0b
https://blog.csdn.net/weixin_42974146/article/details/93649433" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/613bc4dbb85a77d50315a67dbe12d859/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-27T11:49:32+08:00" />
<meta property="article:modified_time" content="2019-06-27T11:49:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">VS2017 WPF程序打包部署</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>一、安装Installer</p> 
<p>1、工具-扩展和更新-联机</p> 
<p><img alt="" class="has" height="217" src="https://images2.imgbox.com/91/b3/r2N5xKuN_o.png" width="305"></p> 
<p>(1) 下载安装installer</p> 
<p><img alt="" class="has" height="190" src="https://images2.imgbox.com/06/ba/NmV5NadE_o.png" width="471"></p> 
<p>(2)下载完成之后，关闭VS2017,重新启动之后，单击修改，安装插件</p> 
<p><img alt="" class="has" height="263" src="https://images2.imgbox.com/a3/d5/OCaDZ651_o.png" width="352"></p> 
<p>(3)关闭后重新打开要打包的工程</p> 
<p>二、打包可执行程序</p> 
<p>1、现有项目中选择解决方案资源管理器 -选择解决方案-右键-新建项目</p> 
<p><img alt="" class="has" height="505" src="https://images2.imgbox.com/fb/14/1huW2Lh3_o.png" width="553"></p> 
<p><img alt="" class="has" height="201" src="https://images2.imgbox.com/83/8c/JkXznDDo_o.png" width="421"></p> 
<p> 三个文件夹分别指向要发送到[文件安装目录下/桌面/开始菜单]中的文件。</p> 
<ul><li>Application Folder：用来存放程序项目的可执行文件、资源（图片、音频、视频等）、各种依赖dll文件。</li></ul> 
<ul><li>User's Desktop：用来生成桌面快捷方式</li><li>User's Programs Menu：用来生成开始菜单快捷方式</li></ul> 
<p>2、Application Folder</p> 
<p><strong>（1）Application Folder</strong>右键选择Add&gt;<strong>项目输出</strong>，接着在弹出窗口中选择<strong>主输出</strong>，点击确定。</p> 
<p><img alt="" class="has" height="355" src="https://images2.imgbox.com/20/b1/ldvfMOx0_o.png" width="298"></p> 
<p>这一步生成如下：</p> 
<p><img alt="" class="has" height="366" src="https://images2.imgbox.com/af/3a/mfPJHBPl_o.png" width="320"></p> 
<p>（2）我的bin-Release文件下还有两个用于保存图片的文件夹</p> 
<p>Add-Folder  并将文件夹重命名为bin-release文件下同样的名字</p> 
<p><img alt="" class="has" height="182" src="https://images2.imgbox.com/b0/3b/bosi7yii_o.png" width="674"></p> 
<p> <img alt="" class="has" height="156" src="https://images2.imgbox.com/b4/a6/vVDtLpvA_o.png" width="274"></p> 
<p>接着Add-文件 将Release文件的文件下的内容都添加进来</p> 
<p><img alt="" class="has" height="202" src="https://images2.imgbox.com/a2/ca/KyCsrouN_o.png" width="529"></p> 
<p>（3）接着通过add&gt;文件（或Folder）选项将程序运行所需要的其他资源文件、dll文件等全部添加到目录中，创建桌面快捷方式和菜单快捷方式时使用。</p> 
<p>3、User's Desktop</p> 
<p>选择主输出文件-右击生成快捷方式</p> 
<p><img alt="" class="has" height="216" src="https://images2.imgbox.com/6e/79/IWFFn5MS_o.png" width="569"></p> 
<p>对快捷方式重命名</p> 
<p><img alt="" class="has" height="78" src="https://images2.imgbox.com/ed/4f/Y4pqmdUW_o.png" width="460"></p> 
<p> </p> 
<p>给新建的快捷方式添加图标，图标路径从上面Images文件中添加</p> 
<p><img alt="" class="has" height="232" src="https://images2.imgbox.com/b8/3a/S0dqNoCA_o.png" width="460"></p> 
<p>拖动到User's Desktop下</p> 
<p><img alt="" class="has" height="192" src="https://images2.imgbox.com/17/f7/2cu95gzM_o.png" width="722"></p> 
<p>4、User's Programs Menu</p> 
<p>（1）快捷方式创建</p> 
<p>桌面快捷方式和菜单快捷方式创建的方法是相同的，按照User's Desktop下同样方式创建快捷方式，并拖到User's Programs Menu下</p> 
<p><img alt="" class="has" height="181" src="https://images2.imgbox.com/27/35/pKgqnReB_o.png" width="723"></p> 
<p>（2）安装包提供卸载功能</p> 
<p>注意：32位和64位电脑的msiexec.exe相同</p> 
<p>1）32位系统</p> 
<p>注意：目标系统为32系统  属性中TargetPlatform设置为X86,目标系统为64系统  属性中TargetPlatform设置为X64</p> 
<p><img alt="" class="has" height="392" src="https://images2.imgbox.com/ac/c2/nqTjiYJA_o.png" width="286"></p> 
<p>Application Folder右键添加文件"C:\Windows\System32\msiexec.exe"。</p> 
<p><img alt="" class="has" height="337" src="https://images2.imgbox.com/2c/c3/PnpNBTEX_o.png" width="533"></p> 
<p>选中msiexec.exe文件右键创建快捷方式，命名为uninstall</p> 
<p><img alt="" class="has" height="215" src="https://images2.imgbox.com/89/a7/yKVz4GkW_o.png" width="429"></p> 
<p><img alt="" class="has" height="188" src="https://images2.imgbox.com/10/5e/KkBUAuN4_o.png" width="490"></p> 
<p>选中uninstall快捷方式，Arguments属性设置为"/x ProductCode"，其中ProductCode的值取自setup project属性中的ProductCode的值。</p> 
<p><img alt="" class="has" height="317" src="https://images2.imgbox.com/e1/22/FwCioT5q_o.png" width="261"></p> 
<p><img alt="" class="has" height="177" src="https://images2.imgbox.com/d3/11/t6XgB1u6_o.png" width="498"></p> 
<p>卸载快捷方式拖动到User's Programs Menu下</p> 
<p> </p> 
<p> </p> 
<p> 注意为了菜单栏中生成快捷方式后，快捷方式和卸载快捷方式都在一个文件下，可以User's Programs Menu创建一个文件夹，将两个快捷方式放到该文件夹下</p> 
<p> </p> 
<p>5、设置完毕，执行build生成解决方案</p> 
<p><img alt="" class="has" height="251" src="https://images2.imgbox.com/01/31/4mpvlKEg_o.png" width="513"></p> 
<p> <img alt="" class="has" height="183" src="https://images2.imgbox.com/4c/74/Y2W9DV15_o.png" width="565"></p> 
<p> </p> 
<p>三、其他注意事项</p> 
<p>1、图标转换网址</p> 
<p><a href="https://www.easyicon.net/covert/" rel="nofollow">https://www.easyicon.net/covert/</a></p> 
<p> </p> 
<p> 参考：<a href="https://blog.csdn.net/smallbabylong/article/details/78756530">https://blog.csdn.net/smallbabylong/article/details/78756530</a></p> 
<p><a href="https://blog.csdn.net/Shenpibaipao/article/details/83152955">https://blog.csdn.net/Shenpibaipao/article/details/83152955</a></p> 
<p><a href="https://www.jianshu.com/p/0073859e9b0b" rel="nofollow">https://www.jianshu.com/p/0073859e9b0b</a></p> 
<p><a href="https://blog.csdn.net/weixin_42974146/article/details/93649433">https://blog.csdn.net/weixin_42974146/article/details/93649433</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/06eea5517305974904f438fdbf26f41a/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">转义字符\r、\n、以及\r\n的区别</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ffe7892e3523049105dd733279255b12/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">健康小常识</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>