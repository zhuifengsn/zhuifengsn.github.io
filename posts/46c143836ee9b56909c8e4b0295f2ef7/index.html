<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>CentOS 6.0 下 VNC 配置方法（带防火墙配置） - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="CentOS 6.0 下 VNC 配置方法（带防火墙配置）" />
<meta property="og:description" content="CentOS 6.0 下 VNC 配置方法（带防火墙配置） (2012-12-03 16:30:53)[编辑][删除]
转载▼
标签： linux tigervnc配置 it 分类： linux 一、安装 VNC 首先检查一下本机是否安装了 VNC，默认情况下，CentOS 6.0 是没有安装的。
检查是否安装，输入：
[root@localhost ~]# rpm -q vnc vnc-server 得到：
package vnc is not installed package vnc-server is not installed 提示没有安装，那么就开始安装，输入：
[root@localhost ~]# yum install vnc vnc-server 注：如果是 Ubuntu 则输入：
[root@localhost ~]# apt-get install vnc vnc-server 在一串指令提示后，会让你确认一些选项，输入两次 &#34;Y&#34; 并确认，稍作等待，提示 &#34;Complete!&#34; 即完成安装。
二、设置 VNC 密码 启动 VNC，输入：
[root@localhost ~]# vncserver 此时会提示你输入密码，因为是第一次配置。重复输入两次即可。
三、配置桌面类型 设置一下远程桌面使用那个类型的桌面，分辨率多少等等。输入：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/46c143836ee9b56909c8e4b0295f2ef7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-05-06T17:50:19+08:00" />
<meta property="article:modified_time" content="2019-05-06T17:50:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">CentOS 6.0 下 VNC 配置方法（带防火墙配置）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 style="margin-left:0px;"> </h3> 
<h3 id="t_8d481aa301017tyw" style="margin-left:0px;">CentOS 6.0 下 VNC 配置方法（带防火墙配置）</h3> 
<p> <span style="color:#5d706f;margin-left:5px;">(2012-12-03 16:30:53)</span><a class="CP_a_fuc" href="http://control.blog.sina.com.cn/admin/article/article_edit.php?blog_id=8d481aa301017tyw" rel="nofollow">[编辑]</a><a class="CP_a_fuc">[删除]</a></p> 
<p><a class="SG_aBtn SG_aBtn_ico SG_turn"><img alt="" class="SG_icon SG_icon111" height="15" src="https://images2.imgbox.com/a1/b4/8uqDHcZe_o.gif" width="15">转载▼</a></p> 
<table><tbody><tr><td style="vertical-align:top;"><span style="color:#5d706f;">标签：</span>  <h4 style="margin-left:0px;"><a href="http://search.sina.com.cn/?c=blog&amp;q=linux&amp;by=tag" rel="nofollow">linux</a></h4>   <h4 style="margin-left:0px;"><a href="http://search.sina.com.cn/?c=blog&amp;q=tigervnc%C5%E4%D6%C3&amp;by=tag" rel="nofollow">tigervnc配置</a></h4>   <h4 style="margin-left:0px;"><a href="http://search.sina.com.cn/?c=blog&amp;q=it&amp;by=tag" rel="nofollow">it</a></h4> </td><td style="vertical-align:top;width:220px;"><span style="color:#5d706f;">分类：</span> <a href="http://blog.sina.com.cn/s/articlelist_2370312867_10_1.html" rel="nofollow">linux</a></td></tr></tbody></table> 
<h4 style="margin-left:0px;">一、安装 VNC</h4> 
<p>　　首先检查一下本机是否安装了 VNC，默认情况下，CentOS 6.0 是没有安装的。</p> 
<p>　　检查是否安装，输入：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# rpm -q vnc vnc-server</code></pre> 
<p>　　得到：</p> 
<pre><code class="language-html hljs">package vnc is not installed

package vnc-server is not installed</code></pre> 
<p>　　提示没有安装，那么就开始安装，输入：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# yum install vnc vnc-server</code></pre> 
<p>　　注：如果是 Ubuntu 则输入：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# apt-get install vnc vnc-server</code></pre> 
<p>　　在一串指令提示后，会让你确认一些选项，输入两次 "Y" 并确认，稍作等待，提示 "Complete!" 即完成安装。</p> 
<h4 style="margin-left:0px;">二、设置 VNC 密码</h4> 
<p>　　启动 VNC，输入：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# vncserver</code></pre> 
<p>　　此时会提示你输入密码，因为是第一次配置。重复输入两次即可。</p> 
<h4 style="margin-left:0px;">三、配置桌面类型</h4> 
<p>　　设置一下远程桌面使用那个类型的桌面，分辨率多少等等。输入：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# vi ~/.vnc/xstartup</code></pre> 
<p>　　得到：</p> 
<pre><code class="language-html hljs">#!/bin/sh

vncconfig -iconic &amp;
unset SESSION_MANAGER
unset DBUS_SESSION_BUS_ADDRESS
OS=`uname -s`
if
[ $OS = 
'Linux'
]; then
  
case
"$WINDOWMANAGER"
in
    
*gnome*)
      
if
[ -e /etc/SuSE-release ]; then
        
PATH=$PATH:/opt/gnome/bin
        
export PATH
      
fi
      
;;
  
esac
fi
if
[ -x /etc/X11/xinit/xinitrc ]; then
  
exec /etc/X11/xinit/xinitrc
fi
if
[ -f /etc/X11/xinit/xinitrc ]; then
  
exec sh /etc/X11/xinit/xinitrc
fi
[ -r $HOME/.Xresources ] &amp;&amp; xrdb $HOME/.Xresources
xsetroot -solid grey
xterm -geometry 80x24+10+10 -ls -title 
"$VNCDESKTOP Desktop"
&amp;
twm &amp;</code></pre> 
<p>　　一般情况下，我们使用的 Linux 桌面都是 "Gnome" 桌面，故配置成这个桌面比较习惯。</p> 
<p>　　按 "i" 键进入编辑状态，主要修改最后两行。改为：</p> 
<pre><code class="language-html hljs"># xterm -geometry 80x24+10+10 -ls -title "$VNCDESKTOP Desktop" &amp;
# twm &amp;
gnome-session &amp;</code></pre> 
<p>　　一看便知，将配置文件的最后两行注释掉，并且加入了一行代码，表明使用的是 "Gnome" 桌面。</p> 
<p>　　输入完毕，按 "ESC" 键退出编辑状态，再输入：</p> 
<pre><code class="language-html hljs">:wq</code></pre> 
<p>　　"w" 表示写，即保存配置，"q" 表示退出。</p> 
<h4 style="margin-left:0px;">四、配置登录帐号、桌面分辨率、连接方式</h4> 
<p>　　输入：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# vi /etc/sysconfig/vncservers</code></pre> 
<p>　　出现如下提示：</p> 
<pre><code class="language-html hljs"># The VNCSERVERS variable is a list of display:user pairs.
#
# Uncomment the lines below to start a VNC server on display :2
# as my 'myusername' (adjust this to your own).  You will also
# need to set a VNC password; run 'man vncpasswd' to see how
# to do that.
#
# DO NOT RUN THIS SERVICE if your local area network is
# untrusted!  For a secure way of using VNC, see this URL:
# http://kbase.redhat.com/faq/docs/DOC-7028
# Use "-nolisten tcp" to prevent X connections to your VNC server via TCP.
# Use "-localhost" to prevent remote VNC clients connecting except when
# doing so through a secure tunnel.  See the "-via" option in the
# `man vncviewer' manual page.

# VNCSERVERS="2:myusername"
# VNCSERVERARGS[2]="-geometry 800x600 -nolisten tcp -localhost"</code></pre> 
<p>　　重点编辑最后两行，将这两行注释去掉，得到：</p> 
<pre><code class="language-html hljs">VNCSERVERS="1:root"
VNCSERVERARGS[1]="-geometry 1024x768"</code></pre> 
<p>　　这里是只有一个帐号登录，设置分辨率为1024*768，如果你有多个帐号，则按照下面格式配置。</p> 
<pre><code class="language-html hljs">VNCSERVERS="1:user1 2:user2 3:user3"
VNCSERVERARGS[1]="-geometry 1024×768"
VNCSERVERARGS[2]="-geometry 1024×768"
VNCSERVERARGS[3]="-geometry 800×600 -depth 24 -nolisten tcp -nohttpd -localhost"</code></pre> 
<p>　　解释一下这个文件：</p> 
<pre><code class="language-html hljs">VNCSERVERS 这一行是配置在系统启动时启动几个 VNC server，上面的例子里运行了三个 VNC server，其中 user1 在 display :1，user2 在 display :2，user3 在 display :3。

VNCSERVERARGS 这三行，分别为 VNC server 1, 2, 3 配置启动参数，上面的例子里对 user1 和 user2 使用屏幕分辨率 1024×768，对 user3 使用 800×600,24 色，不支持 tcp，不支持 http 连接，只能在本地测试访问。</code></pre> 
<p>　 　注释：在启动 VNCserver 时，你也可以为 server 指定一个 display 参数。你可以把 display 理解为一个桌面，每个用户都可以有自己的桌面。VNC 客户端在连接时，可以指定连接到哪个桌面上。在系统中，display 号不能重复，也就是说，如果有用户已经建立了名为 ":1" 的 display，另外一个用户就不能再使用 ":1" 了，他可以使用 ":2"。</p> 
<p>　　指定 display 号码的启动 VNC server 的命令是:</p> 
<pre><code class="language-html hljs">vncserver:1</code></pre> 
<h4 style="margin-left:0px;">五、配置防火墙，允许 VNC 连接</h4> 
<p>　　VNC server 监听的端口从 5900 开始，display:1 的监听 5901，display:2 监听 5902，以此类推。CentOS 的防火墙缺省是不允许连接这些端口的，所以需要使用下面的步骤打开防火墙（需要 root 权限)：</p> 
<p>　　输入编辑：</p> 
<pre><code class="language-html hljs">[root@localhost ~]# vi /etc/sysconfig/iptables</code></pre> 
<p>　　得到：</p> 
<pre><code class="language-html hljs"># Firewall configuration written by system-config-firewall
# Manual customization of this file is not recommended.
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -j REJECT --reject-with icmp-host-prohibited
COMMIT</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2f63074c3279db6c6977a9fe0cc73d60/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">WPF 中DataGrid控件显示和设置数据</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d229a41e38469674bcc6f53139fa4864/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spring的下载与安装（一）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>