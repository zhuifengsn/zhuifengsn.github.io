<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Android学习之路------sharepreference - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Android学习之路------sharepreference" />
<meta property="og:description" content="简单介绍 sharepreference通常用于储存一些简单的信息，比如不考虑安全性的话，我们可以储存密码，也可以储存比如开机时间，或者一些我们设定的信息。利用sharepreference我们可以很方便的进行数据的读写
常见用法 获得sharedPreferences对象 SharedPreferences pref = getSharedPreferences(&#34;example&#34;,Context.MODE_PRIVATE); MODE_PRIVATE:表示这个xml是这个app私有的，其他应用无法获取这个应用的xml文件 MODE_MULTI_PROCESS:能在多个应用间多个进程间互相访问数据 MODE_WORLD_READABLE：可以被其它应该程序读取。 MODE_WORLD_WRITEABLE：可以被其它应该程序读取和写入
数据的获取 SharedPreferences pref = getSharedPreferences(&#34;example&#34;,Context.MODE_PRIVATE); int inter = pref.getInt(&#34;example_int&#34;,1); String str =pref.getString(&#34;example_string&#34;,&#34;default_string&#34;); 得到数据的方法的第一个参数是key,第二个是我们设置的默认值，如果xml里面没有这个key，我们就会得到默认值
数据的写入 SharedPreferences pref = getSharedPreferences(&#34;example&#34;,Context.MODE_PRIVATE); Editor edit = pref.edit(); edit.putInt(&#34;example_int&#34;,5); edit.putString(&#34;example_string&#34;，&#34;hello world&#34;); edit.commit();//提交 如何获取其他应用的共享数据 首先我们要保证我们要获取的xml文件在创建时具有被其他应用访问的权限，因此在创建时我们需要将操作模式改为MODE_MULTI_PROCESS:
SharedPreferences pref = getSharedPreferences(&#34;example&#34;,Context.MODE_MULTI_PROCESS); 其次要创建要获得的应用的context:
Context conetxt = createPackageContext(&#34;com.example.set&#34;,Context.CONTEXT_IGNORE_SECURITY); //这里编辑器可能会让我们加上try catch捕获异常 SharedPreferences pref = context.getSharedPreferences(&#34;example&#34;, Context.MODE_MULTI_PROCESS); int inter = pref.getInt(&#34;example_int&#34;,1); String str =pref.getString(&#34;example_string&#34;,&#34;default_string&#34;); 常见问题 当我们是普通应用时获取其他应用的sharepreference，使用上面的代码是没有问题的，但是当我们的应用时系统级应用时，由于进程不同，可以会出现权限不够的现象，常见的比如：
Attempt to read preferences file /data/data/." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/de8a4757033ca4bd24f375940242693d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-08-17T21:05:33+08:00" />
<meta property="article:modified_time" content="2016-08-17T21:05:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Android学习之路------sharepreference</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2 id="简单介绍">简单介绍</h2> 
<p>sharepreference通常用于储存一些简单的信息，比如不考虑安全性的话，我们可以储存密码，也可以储存比如开机时间，或者一些我们设定的信息。利用sharepreference我们可以很方便的进行数据的读写</p> 
<h2 id="常见用法">常见用法</h2> 
<h3 id="获得sharedpreferences对象">获得sharedPreferences对象</h3> 
<pre><code>SharedPreferences pref = getSharedPreferences("example",Context.MODE_PRIVATE);
</code></pre> 
<p>MODE_PRIVATE:表示这个xml是这个app私有的，其他应用无法获取这个应用的xml文件 <br> MODE_MULTI_PROCESS:能在多个应用间多个进程间互相访问数据 <br> MODE_WORLD_READABLE：可以被其它应该程序读取。 <br> MODE_WORLD_WRITEABLE：可以被其它应该程序读取和写入</p> 
<h3 id="数据的获取">数据的获取</h3> 
<pre><code>SharedPreferences pref = getSharedPreferences("example",Context.MODE_PRIVATE);
int inter = pref.getInt("example_int",1);
String str =pref.getString("example_string","default_string");
</code></pre> 
<p>得到数据的方法的第一个参数是key,第二个是我们设置的默认值，如果xml里面没有这个key，我们就会得到默认值</p> 
<h3 id="数据的写入">数据的写入</h3> 
<pre><code>SharedPreferences pref = getSharedPreferences("example",Context.MODE_PRIVATE);
Editor edit = pref.edit();
edit.putInt("example_int",5);
edit.putString("example_string"，"hello world");
edit.commit();//提交
</code></pre> 
<h2 id="如何获取其他应用的共享数据">如何获取其他应用的共享数据</h2> 
<p>首先我们要保证我们要获取的xml文件在创建时具有被其他应用访问的权限，因此在创建时我们需要将操作模式改为MODE_MULTI_PROCESS:</p> 
<pre><code>SharedPreferences pref = getSharedPreferences("example",Context.MODE_MULTI_PROCESS);
</code></pre> 
<p>其次要创建要获得的应用的context:</p> 
<pre><code>Context conetxt = createPackageContext("com.example.set",Context.CONTEXT_IGNORE_SECURITY); //这里编辑器可能会让我们加上try catch捕获异常

SharedPreferences pref = context.getSharedPreferences("example", Context.MODE_MULTI_PROCESS);

int inter = pref.getInt("example_int",1);
String str =pref.getString("example_string","default_string");
</code></pre> 
<h2 id="常见问题">常见问题</h2> 
<p>当我们是普通应用时获取其他应用的sharepreference，使用上面的代码是没有问题的，但是当我们的应用时系统级应用时，由于进程不同，可以会出现权限不够的现象，常见的比如：</p> 
<pre><code>Attempt to read preferences file  /data/data/...............xml without permission
</code></pre> 
<p>因此我们需要给两个应用设置相同的android:sharedUserId </p> 
<pre><code>android:sharedUserId="example"
</code></pre> 
<p>这句话代表将两个应用加入到同一个进程中，如果是系统进程，可以设置为</p> 
<pre><code>android:sharedUserId="android.uid.system"
</code></pre> 
<p>这样两个应用都运行在系统进程中了</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4ef9f2e8ea8332a58ab17f20934baa8c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">android studio sharedpreference基本操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/56ea15a4f9110c7d55543c1aeffa5f68/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">北冥乘海生的Live - 从数据变现到用户增长：了解互联网商业化体系</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>