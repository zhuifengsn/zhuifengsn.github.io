<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas学习&#43;知识点梳理 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas学习&#43;知识点梳理" />
<meta property="og:description" content="一、Pandas简介 pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。pandas提供了大量能使我们快速便捷地处理数据的函数和方法。Pandas最初被作为金融数据分析工具而开发出来，因此，pandas为时间序列分析提供了很好的支持。Pandas 里面又定义了两种数据类型：Series 和 DataFrame。 二、常用功能 常用缩写：
df：任意的Pandas DataFrame对象
s：任意的Pandas Series对象
同时我们需要做如下的引入：
import pandas as pd import numpy as np #导入数据 pd.read_csv(filename) ##从CSV文件导入数据 pd.read_table(filename) ##从限定分隔符的文本文件导入数据 pd.read_excel(filename)#从Excel文件导入数据 pd.read_sql(query, connection_object)#从SQL表/库导入数据 pd.read_json(json_string)#从JSON格式的字符串导入数据 pd.read_html(url)#解析URL、字符串或者HTML文件，抽取其中的tables表格 pd.read_clipboard()#从你的粘贴板获取内容，并传给read_table() pd.DataFrame(dict)#从字典对象导入数据，Key是列名，Value是数据 #导出数据 df.to_csv(filename)#导出数据到CSV文件 df.to_excel(filename)#导出数据到Excel文件 df.to_sql(table_name, connection_object)#导出数据到SQL表 df.to_json(filename)#以Json格式导出数据到文本文件 #创建测试对象 pd.DataFrame(np.random.rand(20,5))#创建20行5列的随机数组成的DataFrame对象 pd.Series(my_list)#从可迭代对象my_list创建一个Series对象 df.index = pd.date_range(&#39;1900/1/30&#39;, periods=df.shape[0])#增加一个日期索引 #查看、检查数据 df.head(n)#查看DataFrame对象的前n行 df.tail(n)#查看DataFrame对象的最后n行 df.shape()#查看行数和列数 df.info()#查看索引、数据类型和内存信息 df.describe()#查看数值型列的汇总统计 s.value_counts(dropna=False)#查看Series对象的唯一值和计数 df.apply(pd.Series.value_counts)#查看DataFrame对象中每一列的唯一值和计数 #数据选取 df[col]#根据列名，并以Series的形式返回列 df[[col1, col2]]#以DataFrame形式返回多列 s.iloc[0]#按位置选取数据 s.loc[&#39;index_one&#39;]#按索引选取数据 df.iloc[0,#]#返回第一行 df.iloc[0,0]#返回第一列的第一个元素 #数据清理 df.columns = [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;]#重命名列名 pd.isnull()#检查DataFrame对象中的空值，并返回一个Boolean数组 pd." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/bb9562a7e2409464d298e3c1f1b84621/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-30T18:05:03+08:00" />
<meta property="article:modified_time" content="2021-09-30T18:05:03+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas学习&#43;知识点梳理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h5><a id="Pandas_0"></a>一、Pandas简介</h5> 
<ol><li>pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。</li><li>Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。</li><li>pandas提供了大量能使我们快速便捷地处理数据的函数和方法。</li><li>Pandas最初被作为金融数据分析工具而开发出来，因此，pandas为时间序列分析提供了很好的支持。</li><li>Pandas 里面又定义了两种数据类型：Series 和 DataFrame。</li></ol> 
<h5><a id="_7"></a>二、常用功能</h5> 
<p>常用缩写：</p> 
<ul><li> <p>df：任意的Pandas DataFrame对象</p> </li><li> <p>s：任意的Pandas Series对象<br> 同时我们需要做如下的引入：</p> <pre><code class="prism language-python">	
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token comment">#导入数据</span>
pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment">##从CSV文件导入数据</span>
pd<span class="token punctuation">.</span>read_table<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token comment">##从限定分隔符的文本文件导入数据</span>
pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token comment">#从Excel文件导入数据</span>
pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>query<span class="token punctuation">,</span> connection_object<span class="token punctuation">)</span><span class="token comment">#从SQL表/库导入数据</span>
pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span>json_string<span class="token punctuation">)</span><span class="token comment">#从JSON格式的字符串导入数据</span>
pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token comment">#解析URL、字符串或者HTML文件，抽取其中的tables表格</span>
pd<span class="token punctuation">.</span>read_clipboard<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#从你的粘贴板获取内容，并传给read_table()</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span><span class="token comment">#从字典对象导入数据，Key是列名，Value是数据</span>
	
<span class="token comment">#导出数据</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token comment">#导出数据到CSV文件</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token comment">#导出数据到Excel文件</span>
df<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span>table_name<span class="token punctuation">,</span> connection_object<span class="token punctuation">)</span><span class="token comment">#导出数据到SQL表</span>
df<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token comment">#以Json格式导出数据到文本文件</span>

<span class="token comment">#创建测试对象</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#创建20行5列的随机数组成的DataFrame对象</span>
pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>my_list<span class="token punctuation">)</span><span class="token comment">#从可迭代对象my_list创建一个Series对象</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'1900/1/30'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span>df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#增加一个日期索引</span>

<span class="token comment">#查看、检查数据</span>
df<span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token comment">#查看DataFrame对象的前n行</span>
df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token comment">#查看DataFrame对象的最后n行</span>
df<span class="token punctuation">.</span>shape<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看行数和列数</span>
df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看索引、数据类型和内存信息</span>
df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看数值型列的汇总统计</span>
s<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>dropna<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment">#查看Series对象的唯一值和计数</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">.</span>value_counts<span class="token punctuation">)</span><span class="token comment">#查看DataFrame对象中每一列的唯一值和计数</span>

<span class="token comment">#数据选取</span>
df<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token comment">#根据列名，并以Series的形式返回列</span>
df<span class="token punctuation">[</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment">#以DataFrame形式返回多列</span>
s<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment">#按位置选取数据</span>
s<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'index_one'</span><span class="token punctuation">]</span><span class="token comment">#按索引选取数据</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">#]#返回第一行</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment">#返回第一列的第一个元素</span>

<span class="token comment">#数据清理</span>
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token comment">#重命名列名</span>
pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#检查DataFrame对象中的空值，并返回一个Boolean数组</span>
pd<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#检查DataFrame对象中的非空值，并返回一个Boolean数组</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#删除所有包含空值的行</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#删除所有包含空值的列</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>thresh<span class="token operator">=</span>n<span class="token punctuation">)</span><span class="token comment">#删除所有小于n个非空值的行</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment">#用x替换DataFrame对象中所有的空值</span>
s<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span><span class="token comment">#将Series中的数据类型更改为float类型</span>
s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'one'</span><span class="token punctuation">)</span><span class="token comment">#用‘one’代替所有等于1的值</span>
s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span><span class="token string">'three'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#用'one'代替1，用'three'代替3</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token comment"># x + 1)#批量更改列名</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'old_name'</span><span class="token comment"># 'new_ name'})#选择性更改列名</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'column_one'</span><span class="token punctuation">)</span><span class="token comment">#更改索引列</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token comment"># x + 1)#批量重命名索引</span>

<span class="token comment">#数据处理#Filter、Sort和GroupBy</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">]</span><span class="token comment">#选择col列的值大于0.5的行</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token comment">#按照列col1排序数据，默认升序排列</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col2<span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment">#按照列col1降序排列数据</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#先按列col1升序排列，后按col2降序排列数据</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token comment">#返回一个按列col进行分组的Groupby对象</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#返回一个按多列进行分组的Groupby对象</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">[</span>col2<span class="token punctuation">]</span><span class="token comment">#返回按列col1进行分组后，列col2的均值</span>
df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span>col1<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span>col2<span class="token punctuation">,</span>col3<span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">)</span><span class="token comment">#创建一个按列col1进行分组，并计算col2和col3的最大值的数据透视表</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span><span class="token comment">#返回按列col1分组的所有列的均值</span>
data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span><span class="token comment">#对DataFrame中的每一列应用函数np.mean</span>
data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#对DataFrame中的每一行应用函数np.max</span>

数据合并
df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span><span class="token comment">#将df2中的行添加到df1的尾部</span>
df<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#将df2中的列添加到df1的尾部</span>
df1<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df2<span class="token punctuation">,</span>on<span class="token operator">=</span>col1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span><span class="token comment">#对df1的列和df2的列执行SQL形式的join</span>

数据统计
df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看数据值列的汇总统计</span>
df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回所有列的均值</span>
df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回列与列之间的相关系数</span>
df<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回每一列中的非空值的个数</span>
df<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回每一列的最大值</span>
df<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回每一列的最小值</span>
df<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回每一列的中位数</span>
df<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回每一列的标准差</span>
</code></pre> </li></ul> 
<h5><a id="_100"></a>三、实践</h5> 
<p>下面代码是实现车辆品牌车检的一段代码：<br> 用到技术点：</p> 
<ul><li> <p>读取excel（read_excel）</p> </li><li> <p>行筛选功能（=、&gt;、&lt;、in 、isnull）</p> </li><li> <p>添加列（df.assign,计算出的）</p> </li><li> <p>行操作</p> </li><li> <p>单元格操作</p> <pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd    <span class="token comment">#引入pandas包并起别名</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np     <span class="token comment">#引入numpy包并起别名</span>
<span class="token comment">#读取对应sheet页内容</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sheetname<span class="token operator">=</span>“sheet页名称”<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token comment">#如果变速箱类型是DSG则进行如下筛选</span>
<span class="token keyword">if</span> strDSG <span class="token operator">==</span> <span class="token string">"DSG"</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"厂保期"</span><span class="token punctuation">]</span> <span class="token operator">==</span> strGuanteeperiod<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"报价版本号"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>ruleversion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"车辆品牌"</span><span class="token punctuation">]</span> <span class="token operator">==</span> strbrandname<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"车系"</span><span class="token punctuation">]</span> <span class="token operator">==</span> r<span class="token punctuation">[</span><span class="token string">"车系"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"变速箱类型"</span><span class="token punctuation">]</span> <span class="token operator">==</span> strDSG<span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token keyword">else</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"厂保期"</span><span class="token punctuation">]</span> <span class="token operator">==</span> strGuanteeperiod<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"报价版本号"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>ruleversion<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"车辆品牌"</span><span class="token punctuation">]</span> <span class="token operator">==</span> strbrandname<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"车系"</span><span class="token punctuation">]</span> <span class="token operator">==</span> r<span class="token punctuation">[</span><span class="token string">"车系"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">u"变速箱类型"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token comment">#是否查询到内容了，iscount&gt;0则查到了</span>
iscount <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token comment"># 增加辅助列，来完成对车型系类的比较</span>
df <span class="token operator">=</span> result<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>carseries_len<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">u"车型系类"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token comment"># 增加辅助列-车型系列是否存在车型里包含</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>iscarseries<span class="token operator">=</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">in</span> r<span class="token punctuation">[</span><span class="token string">"车型"</span><span class="token punctuation">]</span>  <span class="token keyword">else</span> <span class="token boolean">False</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">u"车型系类"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token comment"># 筛选</span>
df <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">"iscarseries"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">]</span>
 <span class="token comment"># 按车型系列长度倒序</span>
result <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">"carseries_len"</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
iscount <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token keyword">if</span> iscount <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
    Errdesc <span class="token operator">=</span> Errdesc <span class="token operator">+</span> <span class="token string">u"匹配不到保费值；"</span>
<span class="token keyword">elif</span> iscount <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># '可以查到保费值</span>
    <span class="token comment"># '以第一个找到的保费值来匹配，查看保费结果是否正确</span>
    premiumrule <span class="token operator">=</span> result<span class="token punctuation">[</span>strproductname<span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    ghxsrule <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">u"公户系数"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    xuhao <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">u"序号"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> premiumrule <span class="token keyword">or</span> premiumrule <span class="token operator">==</span> <span class="token string">""</span> <span class="token keyword">or</span> premiumrule <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
    Errdesc <span class="token operator">=</span> Errdesc <span class="token operator">+</span> <span class="token string">u"保费值为空；"</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> r<span class="token punctuation">[</span><span class="token string">"使用性质"</span><span class="token punctuation">]</span> <span class="token operator">&lt;&gt;</span> <span class="token string">"家用"</span><span class="token punctuation">:</span>
        baofei <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>premiumrule <span class="token operator">*</span> ghxsrule<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        baofei <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>premiumrule<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> baofei <span class="token operator">==</span> <span class="token builtin">float</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">"保费"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        Output <span class="token operator">=</span> Output <span class="token operator">+</span> <span class="token string">u"保费值："</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>premiumrule<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"；"</span>
        Output <span class="token operator">=</span> Output <span class="token operator">+</span> <span class="token string">u"公户系数："</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ghxsrule<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"；"</span>
        Output <span class="token operator">=</span> Output <span class="token operator">+</span> <span class="token string">u"使用保费页："</span> <span class="token operator">+</span> Selectsheetname <span class="token operator">+</span> <span class="token string">"；"</span>
        Output <span class="token operator">=</span> Output <span class="token operator">+</span> <span class="token string">u"保费表中序号："</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>xuhao<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"；"</span>
        Ckresult <span class="token operator">=</span> <span class="token string">u"正确"</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        Errdesc <span class="token operator">=</span> Errdesc <span class="token operator">+</span> <span class="token string">u"保费值错误（规则表中公户系数："</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>
        ghxsrule<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> strproductname <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>
        premiumrule<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"使用保费页："</span> <span class="token operator">+</span> Selectsheetname <span class="token operator">+</span> <span class="token string">"；保费表中序号："</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>xuhao<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"）；"</span>  
</code></pre> </li></ul> 
<h5><a id="Pandas__158"></a>四、Pandas 知识点梳理</h5> 
<p><img src="https://images2.imgbox.com/91/b3/aIAde3AR_o.png" alt="在这里插入图片描述"><br> <a href="https://download.csdn.net/download/xiaotianer_126/26377328">Pandas知识点梳理下载</a></p> 
<h3><a id="OK_163"></a>OK，如果大家喜欢我的文章可以收藏支持！</h3>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c64b6eca92a3f7f194a0af85da228870/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">pycharm安装第三方库失败的解决办法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/990a8047ef6236ea6d5433bdcb62c693/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用树莓派操控Arduino转动舵机到特定角度(5行代码)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>