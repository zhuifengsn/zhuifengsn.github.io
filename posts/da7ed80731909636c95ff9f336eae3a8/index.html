<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ubuntu18.04 NFS挂载远程服务器 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ubuntu18.04 NFS挂载远程服务器" />
<meta property="og:description" content="背景:
本地计算机访问远程服务器，并且改写服务器上的文件，通过NFS把服务器上文件所在的目录挂载到本地计算机目录，从而可以在本地目录改写。
1. 配置配置 NFS 服务端 首先服务端将自己的文件挂载出来,然后才能被客户端访问
在服务器上操作：
1.1 安装 NFS 服务端
sudo apt-get install nfs-kernel-server 如果出现错误：
dpkg: error processing package nfs-common (--configure): subprocess installed post-installation script returned error exit status 10 dpkg: dependency problems prevent configuration of nfs-kernel-server: nfs-kernel-server depends on nfs-common (= 1:1.2.8-9ubuntu12.3); however: Package nfs-common is not configured yet. dpkg: error processing package nfs-kernel-server (--configure): dependency problems - leaving unconfigured Errors were encountered while processing: nfs-common nfs-kernel-server E: Sub-process /usr/bin/dpkg returned an error code (1) 参考解决方案：Ubuntu dpkg报错: dpkg: error processing package" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/da7ed80731909636c95ff9f336eae3a8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-27T19:18:24+08:00" />
<meta property="article:modified_time" content="2022-10-27T19:18:24+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ubuntu18.04 NFS挂载远程服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>背景:<br> 本地计算机访问远程服务器，并且改写服务器上的文件，通过NFS把服务器上文件所在的目录挂载到本地计算机目录，从而可以在本地目录改写。</p> 
<h3><a id="1__NFS__3"></a>1. 配置配置 NFS 服务端</h3> 
<p>首先服务端将自己的文件挂载出来,然后才能被客户端访问<br> 在服务器上操作：<br> <strong>1.1 安装 NFS 服务端</strong></p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nfs-kernel-server
</code></pre> 
<p>如果出现错误：</p> 
<pre><code class="prism language-bash">dpkg: error processing package nfs-common <span class="token punctuation">(</span>--configure<span class="token punctuation">)</span>:
 subprocess installed post-installation script returned error <span class="token builtin class-name">exit</span> status <span class="token number">10</span>
dpkg: dependency problems prevent configuration of nfs-kernel-server:
 nfs-kernel-server depends on nfs-common <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token number">1</span>:1.2.8-9ubuntu12.3<span class="token punctuation">)</span><span class="token punctuation">;</span> however:
  Package nfs-common is not configured yet.

dpkg: error processing package nfs-kernel-server <span class="token punctuation">(</span>--configure<span class="token punctuation">)</span>:
 dependency problems - leaving unconfigured
Errors were encountered <span class="token keyword">while</span> processing:
 nfs-common
 nfs-kernel-server
E: Sub-process /usr/bin/dpkg returned an error code <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p>参考解决方案：<a href="https://blog.csdn.net/qq_41035283/article/details/119614932">Ubuntu dpkg报错: dpkg: error processing package</a></p> 
<p><strong>1.2 添加 NFS 挂载目录</strong></p> 
<pre><code class="prism language-bash">$ <span class="token builtin class-name">cd</span> /media/xxx/wxf
$ <span class="token builtin class-name">pwd</span>
/media/xxx/wxf
<span class="token function">sudo</span> <span class="token function">vi</span> /etc/exports 
</code></pre> 
<p>添加内容：</p> 
<pre><code class="prism language-bash">/media/xxx/wxf *<span class="token punctuation">(</span>rw,sync,no_root_squash<span class="token punctuation">)</span>
</code></pre> 
<p>前面是挂载的文件路径<br> *(rw,sync,no_root_squash)表示允许任何网段 IP 的系统访问该 NFS 目录</p> 
<p><strong>1.3 修改挂载目录的权限以及修改文件用户</strong></p> 
<pre><code class="prism language-bash">$ <span class="token function">sudo</span> <span class="token function">chmod</span>  -R  <span class="token number">775</span>  /media/xxx/wxf
$ <span class="token function">sudo</span> <span class="token function">chown</span>  -R  <span class="token number">775</span>  /media/xxx/wxf
</code></pre> 
<p><strong>1.4 启动NFS服务</strong></p> 
<pre><code class="prism language-bash">$ <span class="token function">sudo</span> /etc/init.d/nfs-kernel-server start
<span class="token punctuation">[</span> ok <span class="token punctuation">]</span> Starting nfs-kernel-server <span class="token punctuation">(</span>via systemctl<span class="token punctuation">)</span>: nfs-kernel-server.service.
$ <span class="token function">sudo</span> /etc/init.d/nfs-kernel-server restart
<span class="token punctuation">[</span> ok <span class="token punctuation">]</span> Restarting nfs-kernel-server <span class="token punctuation">(</span>via systemctl<span class="token punctuation">)</span>: nfs-kernel-server.service.
</code></pre> 
<p>先启动NFS再重启NFS</p> 
<h3><a id="2__NFS__60"></a>2. 配置 NFS 客户端</h3> 
<p><strong>2.1 安装 NFS 客户端</strong></p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nfs-common portmap
</code></pre> 
<p><strong>2.2 创建本地映射的目录</strong></p> 
<pre><code class="prism language-bash">$ <span class="token function">sudo</span> <span class="token function">mkdir</span> /home/xxx/mount
</code></pre> 
<p><strong>2.3 挂载服务端的文件到本地</strong></p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span>  <span class="token function">mount</span>  -t  nfs  -o  nolock  <span class="token number">192.168</span>.2.168:/media/xxx/wxf  /home/xxx/mount
</code></pre> 
<p>192.168.2.168 为服务器的IP</p> 
<p><strong>2.4 查看是否挂载成功</strong></p> 
<pre><code class="prism language-bash">$ <span class="token function">df</span> -H
Filesystem                                                          Size  tmpfs 
<span class="token punctuation">..</span>.                                                              <span class="token number">1</span>.7G   54k  <span class="token number">1</span>.7G   <span class="token number">1</span>% /run/user/1000
/dev/sdb1                                                           <span class="token number">4</span>.1T  <span class="token number">3</span>.7T  384G  <span class="token number">91</span>% /media/XXX/Elements
<span class="token number">192.168</span>.10.127:/media/XXX/wxf  <span class="token number">8</span>.0T  <span class="token number">3</span>.3T  <span class="token number">4</span>.3T  <span class="token number">44</span>% /home/XXX/mount
</code></pre> 
<p>且到 /home/xxx/mount 目录，查看是否有需要挂载的文件</p> 
<pre><code class="prism language-bash">$ <span class="token builtin class-name">cd</span> /home/xxx/mount
$ <span class="token function">ls</span>
01-5000       IA-SSD_PC             OpenPCDet_ori     YOLOv6
01-5000.zip   lib                   OpenPCDet_zori    yolov7
02-20000      OpenPCDet_ls          output            yolov7_inference
02-20000.zip  openpcdet_lskitti     pcl_1_9_1
IA-SSD        OpenPCDet-master.zip  TensorRT-8.2.5.1
</code></pre> 
<p>挂载成功！！！</p> 
<h3><a id="3__102"></a>3. 启动开机挂载</h3> 
<p>nfs 挂载会在每次重启后失效,需要手动重新挂载，这样很麻烦，故需要开机自动挂载</p> 
<p><strong>3.1 创建开机启动的脚本文件</strong></p> 
<pre><code class="prism language-bash">$ <span class="token builtin class-name">cd</span> /etc/init.d
$ <span class="token function">sudo</span> <span class="token function">vim</span> mount_nfs.sh
</code></pre> 
<p>添加内容</p> 
<pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">### BEGIN INIT INFO</span>
<span class="token comment"># Provides:           svnd.sh</span>
<span class="token comment"># Required-start:     $local_fs $remote_fs $network $syslog</span>
<span class="token comment"># Required-Stop:      $local_fs $remote_fs $network $syslog</span>
<span class="token comment"># Default-Start:      2 3 4 5</span>
<span class="token comment"># Default-Stop:       0 1 6</span>
<span class="token comment"># Short-Description:  starts the svnd.sh daemon</span>
<span class="token comment"># Description:        starts svnd.sh using starts-stop-deamon</span>
<span class="token comment">### END INIT INFO</span>

<span class="token function">sudo</span>  <span class="token function">mount</span>  -t  nfs  -o  nolock  <span class="token number">192.168</span>.2.168:/media/xxx/wxf  /home/xxx/mount
</code></pre> 
<p><strong>3.2 修改脚本的权限</strong></p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">777</span> mount_nfs.sh
</code></pre> 
<p><strong>3.3 将脚本添加到开机执行的队列中</strong></p> 
<pre><code class="prism language-bash"><span class="token function">sudo</span> update-rc.d mount_nfs.sh defaults <span class="token number">90</span>
</code></pre> 
<p><strong>3.4 重启查看是否挂载成功</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8df37468a3eeab3f076880db4c7c22c8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">java中snakeyaml工具包操作yaml文件，什么是yaml文件，yaml如何解析转换为实体，实体如何生成yaml文件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/4481c88e0108547d2862c43419d9c9f0/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Centos7安装Redis</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>