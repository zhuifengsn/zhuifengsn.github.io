<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pytorch进阶学习（三）：在数据集数量不够时如何进行数据增强 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pytorch进阶学习（三）：在数据集数量不够时如何进行数据增强" />
<meta property="og:description" content="对图片数据增强，可以对图片实现：
1. 尺寸放大缩小
2. 旋转（任意角度，如45°，90°，180°，270°）
3. 翻转（水平翻转，垂直翻转）
4. 明亮度改变（变亮，变暗）
5. 像素平移（往一个方向平移像素，空出部分自动填补黑色）
6. 添加噪声（椒盐噪声，高斯噪声）
目录
一、放大缩小
二、水平/垂直翻转
三、旋转
四、明亮度
五、平移
六、添加噪声
七、模糊
八、对一张图片进行单种变换
九、对一张图片进行多种变换
十、对数据集中所有类别的图片进行变换
数据集文件夹名为data4，第一个分类daisy中只有五张图片。 一、放大缩小 import os import numpy as np import cv2 # 放大缩小 def Scale(image, scale): return cv2.resize(image,None,fx=scale,fy=scale,interpolation=cv2.INTER_LINEAR) def TestOnePic(): test_jpg_loc = r&#34;data4/daisy/1.jpg&#34; test_jpg = cv2.imread(test_jpg_loc) cv2.imshow(&#34;ShowImg&#34;, test_jpg) img1 = Scale(test_jpg,0.5) cv2.imshow(&#34;Img1&#34;, img1) img2 = Scale(test_jpg,2) cv2.imshow(&#34;Img2&#34;, img2) cv2.waitKey(0) cv2.destroyAllWindows() if __name__ == &#34;__main__&#34;: TestOnePic() 二、水平/垂直翻转 import os import numpy as np import cv2 # flipcode=1为水平翻转,flipcode=0为垂直翻转 def Horizontal(image): return cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/ef07aea1dea166577deaf7fef5f1454a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-12T10:00:31+08:00" />
<meta property="article:modified_time" content="2023-04-12T10:00:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pytorch进阶学习（三）：在数据集数量不够时如何进行数据增强</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p><strong>对图片数据增强，可以对图片实现：</strong></p> 
 <p>1. 尺寸放大缩小</p> 
 <p>2. 旋转（任意角度，如45°，90°，180°，270°）</p> 
 <p>3. 翻转（水平翻转，垂直翻转）</p> 
 <p>4. 明亮度改变（变亮，变暗）</p> 
 <p>5. 像素平移（往一个方向平移像素，空出部分自动填补黑色）</p> 
 <p>6. 添加噪声（椒盐噪声，高斯噪声）</p> 
</blockquote> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81%E6%94%BE%E5%A4%A7%E7%BC%A9%E5%B0%8F-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E6%94%BE%E5%A4%A7%E7%BC%A9%E5%B0%8F" rel="nofollow">一、放大缩小</a></p> 
<p id="%E4%BA%8C%E3%80%81%E6%B0%B4%E5%B9%B3%2F%E5%9E%82%E7%9B%B4%E7%BF%BB%E8%BD%AC-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E6%B0%B4%E5%B9%B3%2F%E5%9E%82%E7%9B%B4%E7%BF%BB%E8%BD%AC" rel="nofollow">二、水平/垂直翻转</a></p> 
<p id="%E4%B8%89%E3%80%81%E6%97%8B%E8%BD%AC-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E6%97%8B%E8%BD%AC" rel="nofollow">三、旋转</a></p> 
<p id="%E5%9B%9B%E3%80%81%E6%98%8E%E4%BA%AE%E5%BA%A6-toc" style="margin-left:0px;"><a href="#%E5%9B%9B%E3%80%81%E6%98%8E%E4%BA%AE%E5%BA%A6" rel="nofollow">四、明亮度</a></p> 
<p id="%E4%BA%94%E3%80%81%E5%B9%B3%E7%A7%BB-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81%E5%B9%B3%E7%A7%BB" rel="nofollow">五、平移</a></p> 
<p id="%E5%85%AD%E3%80%81%E6%B7%BB%E5%8A%A0%E5%99%AA%E5%A3%B0-toc" style="margin-left:0px;"><a href="#%E5%85%AD%E3%80%81%E6%B7%BB%E5%8A%A0%E5%99%AA%E5%A3%B0" rel="nofollow">六、添加噪声</a></p> 
<p id="%E4%B8%83%E3%80%81%E6%A8%A1%E7%B3%8A-toc" style="margin-left:0px;"><a href="#%E4%B8%83%E3%80%81%E6%A8%A1%E7%B3%8A" rel="nofollow">七、模糊</a></p> 
<p id="%E5%85%AB%E3%80%81%E5%AF%B9%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%A7%8D%E5%8F%98%E6%8D%A2-toc" style="margin-left:0px;"><a href="#%E5%85%AB%E3%80%81%E5%AF%B9%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%A7%8D%E5%8F%98%E6%8D%A2" rel="nofollow">八、对一张图片进行单种变换</a></p> 
<p id="%E4%B9%9D%E3%80%81%E5%AF%B9%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%A4%9A%E7%A7%8D%E5%8F%98%E6%8D%A2-toc" style="margin-left:0px;"><a href="#%E4%B9%9D%E3%80%81%E5%AF%B9%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%A4%9A%E7%A7%8D%E5%8F%98%E6%8D%A2" rel="nofollow">九、对一张图片进行多种变换</a></p> 
<p id="%E5%8D%81%E3%80%81%E5%AF%B9%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%AD%E6%89%80%E6%9C%89%E7%B1%BB%E5%88%AB%E7%9A%84%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%8F%98%E6%8D%A2-toc" style="margin-left:0px;"><a href="#%E5%8D%81%E3%80%81%E5%AF%B9%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%AD%E6%89%80%E6%9C%89%E7%B1%BB%E5%88%AB%E7%9A%84%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%8F%98%E6%8D%A2" rel="nofollow">十、对数据集中所有类别的图片进行变换</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p id="%E4%B8%80%E3%80%81%E6%94%BE%E5%A4%A7%E7%BC%A9%E5%B0%8F-toc" style="margin-left:0px;"></p> 
<p>数据集文件夹名为data4，第一个分类daisy中只有五张图片。 </p> 
<p><img alt="" height="398" src="https://images2.imgbox.com/62/92/p3SQnzyX_o.png" width="803"></p> 
<p></p> 
<h2 id="%E4%B8%80%E3%80%81%E6%94%BE%E5%A4%A7%E7%BC%A9%E5%B0%8F">一、放大缩小</h2> 
<pre><code class="language-python">import os
import numpy as np
import cv2

# 放大缩小
def Scale(image, scale):
    return cv2.resize(image,None,fx=scale,fy=scale,interpolation=cv2.INTER_LINEAR)

def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = Scale(test_jpg,0.5)
    cv2.imshow("Img1", img1)
    img2 = Scale(test_jpg,2)
    cv2.imshow("Img2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p><img alt="" height="692" src="https://images2.imgbox.com/17/7f/eZ2bxIUa_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%E6%B0%B4%E5%B9%B3%2F%E5%9E%82%E7%9B%B4%E7%BF%BB%E8%BD%AC">二、水平/垂直翻转</h2> 
<p></p> 
<pre><code class="language-python">import os
import numpy as np
import cv2

# flipcode=1为水平翻转,flipcode=0为垂直翻转
def Horizontal(image):
    return cv2.flip(image,1,dst=None)

def Vertical(image):
    return cv2.flip(image,0,dst=None)

def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = Horizontal(test_jpg)
    cv2.imshow("Img1", img1)
    img2 = Vertical(test_jpg)
    cv2.imshow("Img2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p><img alt="" height="448" src="https://images2.imgbox.com/22/f1/AArIuFzf_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E4%B8%89%E3%80%81%E6%97%8B%E8%BD%AC">三、旋转</h2> 
<blockquote> 
 <p>image.<a href="https://so.csdn.net/so/search?q=shape&amp;spm=1001.2101.3001.7020" title="shape">shape</a>[0], 图片垂直尺寸</p> 
 <p>image.shape[1], 图片水平尺寸</p> 
 <p>image.shape[2], 图片通道数</p> 
</blockquote> 
<blockquote> 
 <p><strong><code>cv2.getRotationMatrix2D()</code></strong>经常被使用到的参数有三个：</p> 
 <ul><li>旋转中心</li><li>旋转角度</li><li>旋转后的缩放比例</li></ul> 
</blockquote> 
<blockquote> 
 <p>利用opencv实现仿射变换一般会涉及到warpAffine和getRotationMatrix2D两个函数，其中warpAffine可以实现一些简单的重映射，而getRotationMatrix2D可以获得旋转矩阵。<strong>cv2.warpAffine()</strong>主要有以下参数：</p> 
 <ul><li>src: 输入图像</li><li>dst: 输出图像，尺寸由dsize指定，图像类型与原图像一致</li><li>M: 2X3的变换矩阵</li><li>dsize: 指定图像输出尺寸</li><li>flags: 插值算法标识符，有默认值INTER_LINEAR，如果插值算法WARP_INVERSE_MAP, warpAffine函数使用如下矩阵进行图像转换</li></ul> 
</blockquote> 
<pre><code class="language-python">import os
import numpy as np
import cv2

#旋转
def Rotate(image,angle,scale):
    w = image.shape[1]
    h = image.shape[0]
    # 第一个参数旋转中心，第二个参数旋转角度，第三个参数：缩放比例
    M = cv2.getRotationMatrix2D((w/2,h/2),angle,scale)
    # 得到矩阵后得用到图像的仿射变换函数才可以进行最终图像的变化
    image = cv2.warpAffine(image,M,(w,h))
    return image


def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = Rotate(test_jpg,45,2)
    cv2.imshow("Img1", img1)
    img2 = Rotate(test_jpg,90,1)
    cv2.imshow("Img2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p>旋转后如果图片大小不够大的话会填充黑色。</p> 
<p><img alt="" height="423" src="https://images2.imgbox.com/2e/b1/PaELf4Bp_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E5%9B%9B%E3%80%81%E6%98%8E%E4%BA%AE%E5%BA%A6">四、明亮度</h2> 
<p>把图片变亮或者变暗。</p> 
<pre><code class="language-python">import os
import numpy as np
import cv2

'''  
明亮度 
'''
# 变暗
def Darker(image,percetage):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get darker
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = int(image[xj,xi,0]*percetage)
            image_copy[xj,xi,1] = int(image[xj,xi,1]*percetage)
            image_copy[xj,xi,2] = int(image[xj,xi,2]*percetage)
    return image_copy

# 明亮
def Brighter(image, percetage):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get brighter
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = np.clip(int(image[xj,xi,0]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,1] = np.clip(int(image[xj,xi,1]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,2] = np.clip(int(image[xj,xi,2]*percetage),a_max=255,a_min=0)
    return image_copy



def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = Darker(test_jpg,0.9)
    cv2.imshow("Img1", img1)
    img2 = Brighter(test_jpg,1.1)
    cv2.imshow("Img2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p><img alt="" height="406" src="https://images2.imgbox.com/7d/d8/0jWx7tl9_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E4%BA%94%E3%80%81%E5%B9%B3%E7%A7%BB">五、平移</h2> 
<pre><code class="language-python">import os
import numpy as np
import cv2


def Move(img,x,y):
    img_info=img.shape
    height=img_info[0]
    width=img_info[1]

    mat_translation=np.float32([[1,0,x],[0,1,y]])  #变换矩阵：设置平移变换所需的计算矩阵：2行3列
    #[[1,0,20],[0,1,50]]   表示平移变换：其中x表示水平方向上的平移距离，y表示竖直方向上的平移距离。
    dst=cv2.warpAffine(img,mat_translation,(width,height))  #变换函数
    return dst

def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = Move(test_jpg,10,20)
    cv2.imshow("Img1", img1)
    img2 = Move(test_jpg,-20,-10)
    cv2.imshow("Img2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p><img alt="" height="414" src="https://images2.imgbox.com/b8/89/0dU2BiI5_o.png" width="1200"></p> 
<p></p> 
<h2 id="%E5%85%AD%E3%80%81%E6%B7%BB%E5%8A%A0%E5%99%AA%E5%A3%B0">六、添加噪声</h2> 
<pre><code class="language-python">import os
import numpy as np
import cv2

'''
增加噪声
'''
# 椒盐噪声
def SaltAndPepper(src,percetage):
    SP_NoiseImg=src.copy()
    SP_NoiseNum=int(percetage*src.shape[0]*src.shape[1])
    for i in range(SP_NoiseNum):
        randR=np.random.randint(0,src.shape[0]-1)
        randG=np.random.randint(0,src.shape[1]-1)
        randB=np.random.randint(0,3)
        if np.random.randint(0,1)==0:
            SP_NoiseImg[randR,randG,randB]=0
        else:
            SP_NoiseImg[randR,randG,randB]=255
    return SP_NoiseImg

# 高斯噪声
def GaussianNoise(image,percetage):
    G_Noiseimg = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    G_NoiseNum=int(percetage*image.shape[0]*image.shape[1])
    for i in range(G_NoiseNum):
        temp_x = np.random.randint(0,h)
        temp_y = np.random.randint(0,w)
        G_Noiseimg[temp_x][temp_y][np.random.randint(3)] = np.random.randn(1)[0]
    return G_Noiseimg

def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = SaltAndPepper(test_jpg,0.05)
    cv2.imshow("Img1", img1)
    img2 = GaussianNoise(test_jpg,0.05)
    cv2.imshow("Img2", img2)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p></p> 
<p><img alt="" height="424" src="https://images2.imgbox.com/32/86/BKe2QiXE_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h2 id="%E4%B8%83%E3%80%81%E6%A8%A1%E7%B3%8A">七、模糊</h2> 
<p>高斯模糊：</p> 
<pre>cv2.GaussianBlur(图像，卷积核，标准差）</pre> 
<pre><code class="language-python">import os
import numpy as np
import cv2


def Blur(img):
    blur = cv2.GaussianBlur(img, (7, 7), 1.5)
    # #      cv2.GaussianBlur(图像，卷积核，标准差）
    return blur

def TestOnePic():
    test_jpg_loc = r"data4/daisy/1.jpg"
    test_jpg = cv2.imread(test_jpg_loc)
    cv2.imshow("ShowImg", test_jpg)
    img1 = Blur(test_jpg)
    cv2.imshow("Img1", img1)
    cv2.waitKey(0)
    cv2.destroyAllWindows()

if __name__ == "__main__":
    TestOnePic()</code></pre> 
<p><img alt="" height="396" src="https://images2.imgbox.com/44/3d/VwBy25de_o.png" width="874"></p> 
<p></p> 
<h2 id="%E5%85%AB%E3%80%81%E5%AF%B9%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%A7%8D%E5%8F%98%E6%8D%A2">八、对一张图片进行单种变换</h2> 
<pre><code class="language-python">'''
    这是图片数据增强的代码，可以对图片实现：
    1. 尺寸放大缩小
    2. 旋转（任意角度，如45°，90°，180°，270°）
    3. 翻转（水平翻转，垂直翻转）
    4. 明亮度改变（变亮，变暗）
    5. 像素平移（往一个方向平移像素，空出部分自动填补黑色）
    6. 添加噪声（椒盐噪声，高斯噪声）
'''
import os
import numpy as np
import cv2

'''
缩放
'''
# 放大缩小
def Scale(image, scale):
    return cv2.resize(image,None,fx=scale,fy=scale,interpolation=cv2.INTER_LINEAR)

'''
翻转
'''
# 水平翻转
def Horizontal(image):
    return cv2.flip(image,1,dst=None) #水平镜像

# 垂直翻转
def Vertical(image):
    return cv2.flip(image,0,dst=None) #垂直镜像

# 旋转，R可控制图片放大缩小
def Rotate(image, angle=15, scale=0.9):
    w = image.shape[1]
    h = image.shape[0]
    #rotate matrix
    M = cv2.getRotationMatrix2D((w/2,h/2), angle, scale)
    #rotate
    image = cv2.warpAffine(image,M,(w,h))
    return image

'''  
明亮度 
'''
# 变暗
def Darker(image,percetage=0.9):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get darker
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = int(image[xj,xi,0]*percetage)
            image_copy[xj,xi,1] = int(image[xj,xi,1]*percetage)
            image_copy[xj,xi,2] = int(image[xj,xi,2]*percetage)
    return image_copy

# 明亮
def Brighter(image, percetage=1.1):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get brighter
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = np.clip(int(image[xj,xi,0]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,1] = np.clip(int(image[xj,xi,1]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,2] = np.clip(int(image[xj,xi,2]*percetage),a_max=255,a_min=0)
    return image_copy

# 平移
def Move(img,x,y):
    img_info=img.shape
    height=img_info[0]
    width=img_info[1]

    mat_translation=np.float32([[1,0,x],[0,1,y]])  #变换矩阵：设置平移变换所需的计算矩阵：2行3列
    #[[1,0,20],[0,1,50]]   表示平移变换：其中x表示水平方向上的平移距离，y表示竖直方向上的平移距离。
    dst=cv2.warpAffine(img,mat_translation,(width,height))  #变换函数
    return dst

'''
增加噪声
'''
# 椒盐噪声
def SaltAndPepper(src,percetage=0.05):
    SP_NoiseImg=src.copy()
    SP_NoiseNum=int(percetage*src.shape[0]*src.shape[1])
    for i in range(SP_NoiseNum):
        randR=np.random.randint(0,src.shape[0]-1)
        randG=np.random.randint(0,src.shape[1]-1)
        randB=np.random.randint(0,3)
        if np.random.randint(0,1)==0:
            SP_NoiseImg[randR,randG,randB]=0
        else:
            SP_NoiseImg[randR,randG,randB]=255
    return SP_NoiseImg

# 高斯噪声
def GaussianNoise(image,percetage=0.05):
    G_Noiseimg = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    G_NoiseNum=int(percetage*image.shape[0]*image.shape[1])
    for i in range(G_NoiseNum):
        temp_x = np.random.randint(0,h)
        temp_y = np.random.randint(0,w)
        G_Noiseimg[temp_x][temp_y][np.random.randint(3)] = np.random.randn(1)[0]
    return G_Noiseimg

def Blur(img):
    blur = cv2.GaussianBlur(img, (7, 7), 1.5)
    # #      cv2.GaussianBlur(图像，卷积核，标准差）
    return blur


def TestOneDir():
    root_path = "data4/daisy"
    save_path = root_path
    for a, b, c in os.walk(root_path):
        for file_i in c:
            file_i_path = os.path.join(a, file_i)
            print(file_i_path)
            img_i = cv2.imread(file_i_path)

            img_scale = Scale(img_i,1.5)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_scale.jpg"), img_scale)

            img_horizontal = Horizontal(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_horizontal.jpg"), img_horizontal)

            img_vertical = Vertical(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_vertical.jpg"), img_vertical)

            img_rotate = Rotate(img_i,90)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate90.jpg"), img_rotate)

            img_rotate = Rotate(img_i, 180)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate180.jpg"), img_rotate)

            img_rotate = Rotate(img_i, 270)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate270.jpg"), img_rotate)

            img_move = Move(img_i,15,15)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_move.jpg"), img_move)

            img_darker = Darker(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_darker.jpg"), img_darker)

            img_brighter = Brighter(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_brighter.jpg"), img_brighter)

            img_blur = Blur(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_blur.jpg"), img_blur)

            img_salt = SaltAndPepper(img_i,0.05)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_salt.jpg"), img_salt)


if __name__ == "__main__":
    TestOneDir()

    # root_path = "data4/"
    # AllData(root_path)
</code></pre> 
<p>可以看到daisy中由原来的5张图变为了60张，每张图都经过了11种变换。 </p> 
<p><img alt="" height="657" src="https://images2.imgbox.com/8f/fe/Z48HmDiT_o.png" width="705"></p> 
<p></p> 
<h2 id="%E4%B9%9D%E3%80%81%E5%AF%B9%E4%B8%80%E5%BC%A0%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%A4%9A%E7%A7%8D%E5%8F%98%E6%8D%A2">九、对一张图片进行多种变换</h2> 
<blockquote> 
 <p>想要对一张图片进行翻转、平移、模糊等叠加操作，就依次对所需代码进行执行。</p> 
</blockquote> 
<p>1. 一开始我们有五张图片。</p> 
<p><img alt="" height="266" src="https://images2.imgbox.com/ab/06/LYnIsFsB_o.png" width="662"></p> 
<p> 2. 先对图片进行scale操作，把其他代码注释掉，现在变为10张图片。</p> 
<pre><code class="language-python">
import os
import numpy as np
import cv2

'''
缩放
'''
# 放大缩小
def Scale(image, scale):
    return cv2.resize(image,None,fx=scale,fy=scale,interpolation=cv2.INTER_LINEAR)

'''
翻转
'''
# 水平翻转
def Horizontal(image):
    return cv2.flip(image,1,dst=None) #水平镜像

# 垂直翻转
def Vertical(image):
    return cv2.flip(image,0,dst=None) #垂直镜像

# 旋转，R可控制图片放大缩小
def Rotate(image, angle=15, scale=0.9):
    w = image.shape[1]
    h = image.shape[0]
    #rotate matrix
    M = cv2.getRotationMatrix2D((w/2,h/2), angle, scale)
    #rotate
    image = cv2.warpAffine(image,M,(w,h))
    return image

'''  
明亮度 
'''
# 变暗
def Darker(image,percetage=0.9):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get darker
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = int(image[xj,xi,0]*percetage)
            image_copy[xj,xi,1] = int(image[xj,xi,1]*percetage)
            image_copy[xj,xi,2] = int(image[xj,xi,2]*percetage)
    return image_copy

# 明亮
def Brighter(image, percetage=1.1):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get brighter
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = np.clip(int(image[xj,xi,0]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,1] = np.clip(int(image[xj,xi,1]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,2] = np.clip(int(image[xj,xi,2]*percetage),a_max=255,a_min=0)
    return image_copy

# 平移
def Move(img,x,y):
    img_info=img.shape
    height=img_info[0]
    width=img_info[1]

    mat_translation=np.float32([[1,0,x],[0,1,y]])  #变换矩阵：设置平移变换所需的计算矩阵：2行3列
    #[[1,0,20],[0,1,50]]   表示平移变换：其中x表示水平方向上的平移距离，y表示竖直方向上的平移距离。
    dst=cv2.warpAffine(img,mat_translation,(width,height))  #变换函数
    return dst

'''
增加噪声
'''
# 椒盐噪声
def SaltAndPepper(src,percetage=0.05):
    SP_NoiseImg=src.copy()
    SP_NoiseNum=int(percetage*src.shape[0]*src.shape[1])
    for i in range(SP_NoiseNum):
        randR=np.random.randint(0,src.shape[0]-1)
        randG=np.random.randint(0,src.shape[1]-1)
        randB=np.random.randint(0,3)
        if np.random.randint(0,1)==0:
            SP_NoiseImg[randR,randG,randB]=0
        else:
            SP_NoiseImg[randR,randG,randB]=255
    return SP_NoiseImg

# 高斯噪声
def GaussianNoise(image,percetage=0.05):
    G_Noiseimg = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    G_NoiseNum=int(percetage*image.shape[0]*image.shape[1])
    for i in range(G_NoiseNum):
        temp_x = np.random.randint(0,h)
        temp_y = np.random.randint(0,w)
        G_Noiseimg[temp_x][temp_y][np.random.randint(3)] = np.random.randn(1)[0]
    return G_Noiseimg

def Blur(img):
    blur = cv2.GaussianBlur(img, (7, 7), 1.5)
    # #      cv2.GaussianBlur(图像，卷积核，标准差）
    return blur


def TestOneDir():
    root_path = "data4/daisy"
    save_path = root_path
    for a, b, c in os.walk(root_path):
        for file_i in c:
            file_i_path = os.path.join(a, file_i)
            print(file_i_path)
            img_i = cv2.imread(file_i_path)

            img_scale = Scale(img_i,1.5)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_scale.jpg"), img_scale)
#
#             img_horizontal = Horizontal(img_i)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_horizontal.jpg"), img_horizontal)
#
#             img_vertical = Vertical(img_i)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_vertical.jpg"), img_vertical)
#
#             img_rotate = Rotate(img_i,90)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate90.jpg"), img_rotate)
#
#             img_rotate = Rotate(img_i, 180)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate180.jpg"), img_rotate)
#
#             img_rotate = Rotate(img_i, 270)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate270.jpg"), img_rotate)
#
#             img_move = Move(img_i,15,15)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_move.jpg"), img_move)
#
#             img_darker = Darker(img_i)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_darker.jpg"), img_darker)
#
#             img_brighter = Brighter(img_i)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_brighter.jpg"), img_brighter)
#
#             img_blur = Blur(img_i)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_blur.jpg"), img_blur)
#
#             img_salt = SaltAndPepper(img_i,0.05)
#             cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_salt.jpg"), img_salt)
# #


if __name__ == "__main__":
    TestOneDir()

    # root_path = "data4/"
    # AllData(root_path)
</code></pre> 
<p></p> 
<h2 id="%E5%8D%81%E3%80%81%E5%AF%B9%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%AD%E6%89%80%E6%9C%89%E7%B1%BB%E5%88%AB%E7%9A%84%E5%9B%BE%E7%89%87%E8%BF%9B%E8%A1%8C%E5%8F%98%E6%8D%A2">十、对数据集中所有类别的图片进行变换</h2> 
<pre><code class="language-python">'''
    这是图片数据增强的代码，可以对图片实现：
    1. 尺寸放大缩小
    2. 旋转（任意角度，如45°，90°，180°，270°）
    3. 翻转（水平翻转，垂直翻转）
    4. 明亮度改变（变亮，变暗）
    5. 像素平移（往一个方向平移像素，空出部分自动填补黑色）
    6. 添加噪声（椒盐噪声，高斯噪声）
'''
import os
import numpy as np
import cv2

# envpath = '/home/zhaolei/anaconda3/envs/maweiyi/lib/python3.8/site-packages/cv2/qt/plugins/platforms'
# os.environ['QT_QPA_PLATFORM_PLUGIN_PATH'] = envpath

'''
缩放
'''
# 放大缩小
def Scale(image, scale):
    return cv2.resize(image,None,fx=scale,fy=scale,interpolation=cv2.INTER_LINEAR)

'''
翻转
'''
# 水平翻转
def Horizontal(image):
    return cv2.flip(image,1,dst=None) #水平镜像

# 垂直翻转
def Vertical(image):
    return cv2.flip(image,0,dst=None) #垂直镜像

# 旋转，R可控制图片放大缩小
def Rotate(image, angle=15, scale=0.9):
    w = image.shape[1]
    h = image.shape[0]
    #rotate matrix
    M = cv2.getRotationMatrix2D((w/2,h/2), angle, scale)
    #rotate
    image = cv2.warpAffine(image,M,(w,h))
    return image

'''  
明亮度 
'''
# 变暗
def Darker(image,percetage=0.9):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get darker
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = int(image[xj,xi,0]*percetage)
            image_copy[xj,xi,1] = int(image[xj,xi,1]*percetage)
            image_copy[xj,xi,2] = int(image[xj,xi,2]*percetage)
    return image_copy

# 明亮
def Brighter(image, percetage=1.1):
    image_copy = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    #get brighter
    for xi in range(0,w):
        for xj in range(0,h):
            image_copy[xj,xi,0] = np.clip(int(image[xj,xi,0]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,1] = np.clip(int(image[xj,xi,1]*percetage),a_max=255,a_min=0)
            image_copy[xj,xi,2] = np.clip(int(image[xj,xi,2]*percetage),a_max=255,a_min=0)
    return image_copy

# 平移
def Move(img,x,y):
    img_info=img.shape
    height=img_info[0]
    width=img_info[1]

    mat_translation=np.float32([[1,0,x],[0,1,y]])  #变换矩阵：设置平移变换所需的计算矩阵：2行3列
    #[[1,0,20],[0,1,50]]   表示平移变换：其中x表示水平方向上的平移距离，y表示竖直方向上的平移距离。
    dst=cv2.warpAffine(img,mat_translation,(width,height))  #变换函数
    return dst

'''
增加噪声
'''
# 椒盐噪声
def SaltAndPepper(src,percetage=0.05):
    SP_NoiseImg=src.copy()
    SP_NoiseNum=int(percetage*src.shape[0]*src.shape[1])
    for i in range(SP_NoiseNum):
        randR=np.random.randint(0,src.shape[0]-1)
        randG=np.random.randint(0,src.shape[1]-1)
        randB=np.random.randint(0,3)
        if np.random.randint(0,1)==0:
            SP_NoiseImg[randR,randG,randB]=0
        else:
            SP_NoiseImg[randR,randG,randB]=255
    return SP_NoiseImg

# 高斯噪声
def GaussianNoise(image,percetage=0.05):
    G_Noiseimg = image.copy()
    w = image.shape[1]
    h = image.shape[0]
    G_NoiseNum=int(percetage*image.shape[0]*image.shape[1])
    for i in range(G_NoiseNum):
        temp_x = np.random.randint(0,h)
        temp_y = np.random.randint(0,w)
        G_Noiseimg[temp_x][temp_y][np.random.randint(3)] = np.random.randn(1)[0]
    return G_Noiseimg

def Blur(img):
    blur = cv2.GaussianBlur(img, (7, 7), 1.5)
    # #      cv2.GaussianBlur(图像，卷积核，标准差）
    return blur


def AllData(rootpath):
    root_path = "data4/"
    save_loc = root_path
    for a,b,c in os.walk(root_path):
        for file_i in c:
            file_i_path = os.path.join(a,file_i)
            print(file_i_path)
            split = os.path.split(file_i_path)
            dir_loc = os.path.split(split[0])[1]
            save_path = os.path.join(save_loc,dir_loc)

            img_i = cv2.imread(file_i_path)
            img_scale = Scale(img_i,1.5)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_scale.jpg"), img_scale)

            img_horizontal = Horizontal(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_horizontal.jpg"), img_horizontal)

            img_vertical = Vertical(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_vertical.jpg"), img_vertical)

            img_rotate = Rotate(img_i, 90)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate90.jpg"), img_rotate)

            img_rotate = Rotate(img_i, 180)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate180.jpg"), img_rotate)

            img_rotate = Rotate(img_i, 270)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_rotate270.jpg"), img_rotate)

            img_move = Move(img_i, 15, 15)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_move.jpg"), img_move)

            img_darker = Darker(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_darker.jpg"), img_darker)

            img_brighter = Brighter(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_brighter.jpg"), img_brighter)

            img_blur = Blur(img_i)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_blur.jpg"), img_blur)

            img_salt = SaltAndPepper(img_i, 0.05)
            cv2.imwrite(os.path.join(save_path, file_i[:-4] + "_salt.jpg"), img_salt)


if __name__ == "__main__":
    root_path = "data4/"
    AllData(root_path)
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/721758454c1b0bad7ede9fdfe6a2a091/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[pytorch]pytorch官方安装法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9e0d17daa0e6eba029aa21e8402d5f86/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">usb_cam相机标定实践 ROS</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>