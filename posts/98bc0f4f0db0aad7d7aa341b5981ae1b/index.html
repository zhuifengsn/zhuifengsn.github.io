<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>为什么你的“点击”不生效？！ - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="为什么你的“点击”不生效？！" />
<meta property="og:description" content="此文章来源于项目官方公众号：“AirtestProject”
版权声明：允许转载，但转载必须保留原链接；请勿用作商业或者非法用途
前言 今天跟同学们来聊一聊点击不生效这个问题，经常听到答疑群里面有同学说：为什么我的代码执行了，但实际上没有发生点击的动作呢？又或是，为什么我用IDE连接上了设备，却不能点击手机画面呢？
下面我们就来看下，当同学们遇到各种“点击不生效”的情况时，究竟该如何排查。
“点击不生效”的排查办法 1. 检查是否使用了最新版本 ① 使用AirtestIDE自带的环境 查看当前IDE的选项–设置里面，是否自定义了python.exe的路径，如未设置，则只需要检查当前的AirtestIDE是否为最新版本即可，不是最新版本的话，先将其更新到最新版本：
② 使用了本地python环境 如自定义了python.exe的路径，则表示当前未使用AirtestIDE自带的环境，而是使用了自定义的本地python环境，则需要检查自定义python环境里面的airtest库是否为最新版本，如不是最新，也请把airtest库更新到最新版。
我们可以在命令行运行 pip list 查看（如本地存在多个python环境，则需要特别注意区分自己使用的是哪个）：
命令行运行或者其它python编辑器运行的情况同理，需要检查当前运行环境里面装的airtest库是否为最新版。
2. 尝试在IDE里面看看能否点击手机画面 ① 能点击 则排除手机设置的问题。
② 不能点击 特别注意部分品牌手机需要开启“允许模拟点击位置”此类的选项，详情可查看官方文档：https://airtest.doc.io.netease.com/IDEdocs/device_connection/2_android_faq/#2 。
3. 单独写一个脚本，只运行点击不生效的那条语句，运行后生成报告 这里是使用最小可复现脚本的办法，排除其它代码的干扰，能更快速定位到问题：
① log查看窗出现了报错 如出现类似 Picture xxx not found in the screen 的报错，则表明截图识别失败了，我们需要重新截图；比如说截取特征更加明显的截图，减少混入多余的背景等等，关于如何提高截图脚本的兼容性，我们也在之前的推文 “写了10000条Airtest截图脚本总结出来的截图经验，赶紧收藏！” 有详细介绍，有需要的同学可以直接前往阅读。
如出现类似 PocoNoSuchNodeException: Cannot find any visible node by xxx 的报错，则表明查找控件失败，需要检查控件的定位方式是否正确，当前页面是否存在此控件等。
② 没报错，但查看报告发现点到了错误的位置 多出现于截图脚本：
一种情况是，当前页面存在多个相同的截图，实际运行时没有点击到你的真实目标上面，此时可以通过局部识图、或者调整截图的 target_pos来辅助你定位到你的真实目标上面。
另外一种情况是，识别到了毫不相干的错误的目标上，有可能是图像阙值比较低，混入了错误的结果，可以尝试调整阙值过滤错误的结果。
③ 没报错，但查看报告发现点击出现了一定的位置偏移 常出现于Poco控件点击脚本中：
首先我们可以借助IDE辅助窗的检索控件功能，把鼠标移动到对应的控件上面，看看锁定控件的框框是否出现了偏移，如出现了偏移，我们可以通过一些偏移修正，或者去掉手机的虚拟按键栏来解决，详见我们的官方教程文档： https://airtest.doc.io.netease.com/IDEdocs/device_connection/2_android_faq/#_9 。
④ 查看报告发现画面未加载完毕就进行了点击 当画面未加载完全或者不够稳定的情况下，我们立即进行了点击操作，很可能出现点击操作确实执行了，但应用没能响应这个点击的情况。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/98bc0f4f0db0aad7d7aa341b5981ae1b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-22T18:01:51+08:00" />
<meta property="article:modified_time" content="2021-06-22T18:01:51+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">为什么你的“点击”不生效？！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>此文章来源于项目官方公众号：“AirtestProject”<br> 版权声明：允许转载，但转载必须保留原链接；请勿用作商业或者非法用途</p> 
</blockquote> 
<h4><a id="_3"></a>前言</h4> 
<p>今天跟同学们来聊一聊点击不生效这个问题，经常听到答疑群里面有同学说：为什么我的代码执行了，但实际上没有发生点击的动作呢？又或是，为什么我用IDE连接上了设备，却不能点击手机画面呢？</p> 
<p>下面我们就来看下，当同学们遇到各种“点击不生效”的情况时，究竟该如何排查。</p> 
<h4><a id="_8"></a>“点击不生效”的排查办法</h4> 
<h5><a id="1__11"></a>1. 检查是否使用了最新版本</h5> 
<h6><a id="_AirtestIDE_13"></a>① 使用AirtestIDE自带的环境</h6> 
<p>查看当前IDE的选项–设置里面，是否自定义了python.exe的路径，如未设置，则只需要检查当前的AirtestIDE是否为最新版本即可，不是最新版本的话，先将其更新到最新版本：</p> 
<p><img src="https://images2.imgbox.com/65/19/H8t2mZtt_o.png" alt="image"></p> 
<h6><a id="_python_18"></a>② 使用了本地python环境</h6> 
<p>如自定义了python.exe的路径，则表示当前未使用AirtestIDE自带的环境，而是使用了自定义的本地python环境，则需要检查自定义python环境里面的airtest库是否为最新版本，如不是最新，也请把airtest库更新到最新版。</p> 
<p>我们可以在命令行运行 <code>pip list</code> 查看（如本地存在多个python环境，则需要特别注意区分自己使用的是哪个）：</p> 
<p><img src="https://images2.imgbox.com/e9/57/tjvSjdQp_o.png" alt="image"></p> 
<p>命令行运行或者其它python编辑器运行的情况同理，需要检查当前运行环境里面装的airtest库是否为最新版。</p> 
<h5><a id="2_IDE_28"></a>2. 尝试在IDE里面看看能否点击手机画面</h5> 
<h6><a id="__30"></a>① 能点击</h6> 
<p>则排除手机设置的问题。</p> 
<h6><a id="__33"></a>② 不能点击</h6> 
<p>特别注意部分品牌手机需要开启“允许模拟点击位置”此类的选项，详情可查看官方文档：https://airtest.doc.io.netease.com/IDEdocs/device_connection/2_android_faq/#2 。</p> 
<h5><a id="3__36"></a>3. 单独写一个脚本，只运行点击不生效的那条语句，运行后生成报告</h5> 
<p>这里是使用最小可复现脚本的办法，排除其它代码的干扰，能更快速定位到问题：</p> 
<h6><a id="_log_40"></a>① log查看窗出现了报错</h6> 
<p>如出现类似 <code>Picture xxx not found in the screen</code> 的报错，则表明截图识别失败了，我们需要重新截图；比如说截取特征更加明显的截图，减少混入多余的背景等等，关于如何提高截图脚本的兼容性，我们也在之前的推文 “<a href="https://mp.weixin.qq.com/s?__biz=MzUxMDc4NTkwMA==&amp;mid=2247485026&amp;idx=1&amp;sn=69bfbe72c6c7ae2e10738fbae5cd53ed&amp;chksm=f97ce661ce0b6f776f31b14b48e57879c132afc2d9a7aa1380ecc7036a00de30a4ec946c51ce&amp;token=1662948423&amp;lang=zh_CN#rd" rel="nofollow">写了10000条Airtest截图脚本总结出来的截图经验，赶紧收藏！</a>” 有详细介绍，有需要的同学可以直接前往阅读。</p> 
<p>如出现类似 <code>PocoNoSuchNodeException: Cannot find any visible node by xxx</code> 的报错，则表明查找控件失败，需要检查控件的定位方式是否正确，当前页面是否存在此控件等。</p> 
<h6><a id="__46"></a>② 没报错，但查看报告发现点到了错误的位置</h6> 
<p>多出现于截图脚本：</p> 
<p>一种情况是，当前页面存在多个相同的截图，实际运行时没有点击到你的真实目标上面，此时可以通过局部识图、或者调整截图的 <code>target_pos</code>来辅助你定位到你的真实目标上面。</p> 
<p>另外一种情况是，识别到了毫不相干的错误的目标上，有可能是图像阙值比较低，混入了错误的结果，可以尝试调整阙值过滤错误的结果。</p> 
<h6><a id="__54"></a>③ 没报错，但查看报告发现点击出现了一定的位置偏移</h6> 
<p>常出现于Poco控件点击脚本中：</p> 
<p>首先我们可以借助IDE辅助窗的检索控件功能，把鼠标移动到对应的控件上面，看看锁定控件的框框是否出现了偏移，如出现了偏移，我们可以通过一些偏移修正，或者去掉手机的虚拟按键栏来解决，详见我们的官方教程文档： https://airtest.doc.io.netease.com/IDEdocs/device_connection/2_android_faq/#_9 。</p> 
<h6><a id="__60"></a>④ 查看报告发现画面未加载完毕就进行了点击</h6> 
<p>当画面未加载完全或者不够稳定的情况下，我们立即进行了点击操作，很可能出现点击操作确实执行了，但应用没能响应这个点击的情况。</p> 
<p>此时我们可以在点击之前添加足够时长的 <code>sleep()</code> 以保证我们的应用稳定后再进行后续的点击操作。</p> 
<h4><a id="_66"></a>小结</h4> 
<p>最后，我们提供了“点击不生效”的自检流程图，有需要的同学可以保存下来自查哦！</p> 
<p><img src="https://images2.imgbox.com/51/e9/2Sn3pRB7_o.png" alt="image"></p> 
<hr> 
<p><a href="http://airtest.netease.com/" rel="nofollow">Airtest 官网</a>：http://airtest.netease.com/<br> <a href="https://airtest.doc.io.netease.com/" rel="nofollow">Airtest 教程官网</a>：https://airtest.doc.io.netease.com/<br> <a href="https://airlab.163.com/b2b" rel="nofollow">搭建企业私有云服务</a>：https://airlab.163.com/b2b</p> 
<p>官方答疑 Q 群：654700783</p> 
<p><strong>呀，这么认真都看到这里啦，帮忙点个赞或者收藏支持下我把，灰常感谢~</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ef9a4524d96cb3ae69abccb1ff8d554b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux系统编程篇--进程控制篇</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/154c1158e8665093faa4bfe5f4e8069a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机专业哪些竞赛含金量高,盘点国内五大高含金量的编程赛事</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>