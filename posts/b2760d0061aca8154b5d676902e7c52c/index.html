<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Keil嵌入式开发环境的搭建与配置及基于STM32汇编程序的编写 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Keil嵌入式开发环境的搭建与配置及基于STM32汇编程序的编写" />
<meta property="og:description" content="文章目录 一、搭建与配置Keil嵌入式开发环境1.安装mdk2.安装STM32芯片包 二、基于STM32汇编程序的编写1.新建工程2.配置环境3.程序编写及调试 三、分析hex文件1.打开hex文件2.hex文件分析 四、总结五、参考链接 一、搭建与配置Keil嵌入式开发环境 1.安装mdk （1）打开下载的keil5文件夹，点击运行mdk531
（2）在弹出的界面，点击next
（3）勾选I agree，点击next
（4）自定义安装路径，然后点击next
（5）填写用户信息（可随便填写），然后点击next
（6）开始安装，安装完成后点击Finish
2.安装STM32芯片包 （1）在安装文件中点击Keil.STM32F1xx_DFP.2.1.0
（2）点击Next进行安装
（注：我已经安装过，所以会弹出如图片左下角所示的警告）
（3）开始安装，安装完成后点击Finish
至此，Keil嵌入式开发环境已全部搭建与配置完成。
二、基于STM32汇编程序的编写 1.新建工程 打开keil，点击菜单栏Project–&gt;New μVision Project，新建项目，在弹窗中设置工程项目的名称和路径
2.配置环境 （1）选择设备
点击菜单中的Project，找到Options for Target ‘Target 1’并点击，在弹窗中选择相应的目标环境，此处我选的是STM32F103ZE
（2）选择运行环境
（3）设置仿真器模式
点击菜单中的Project，找到Options for Target ‘Target 1’并点击，选择Debug–&gt;Use Simulator,将Dialog DLL以及Parameter处修改为自己选择的设备。
3.程序编写及调试 （1）添加源文件
右键单击Source Group 1，选择Add New Item to Group,添加Asm File (.s)文件，命名为test3并保存。
为其添加如下代码：
AREA MYDATA, DATA AREA MYCODE, CODE ENTRY EXPORT __main __main MOV R0, #10 MOV R1, #11 MOV R2, #12 MOV R3, #13 ;LDR R0, =func01 BL	func01 ;LDR R1, =func02 BL	func02 BL func03 LDR LR, =func01 LDR PC, =func03 B ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/b2760d0061aca8154b5d676902e7c52c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-22T10:14:28+08:00" />
<meta property="article:modified_time" content="2022-10-22T10:14:28+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Keil嵌入式开发环境的搭建与配置及基于STM32汇编程序的编写</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Keil_1" rel="nofollow">一、搭建与配置Keil嵌入式开发环境</a></li><li><ul><li><a href="#1mdk_2" rel="nofollow">1.安装mdk</a></li><li><a href="#2STM32_17" rel="nofollow">2.安装STM32芯片包</a></li></ul> 
  </li><li><a href="#STM32_28" rel="nofollow">二、基于STM32汇编程序的编写</a></li><li><ul><li><a href="#1_29" rel="nofollow">1.新建工程</a></li><li><a href="#2_32" rel="nofollow">2.配置环境</a></li><li><a href="#3_41" rel="nofollow">3.程序编写及调试</a></li></ul> 
  </li><li><a href="#hex_90" rel="nofollow">三、分析hex文件</a></li><li><ul><li><a href="#1hex_91" rel="nofollow">1.打开hex文件</a></li><li><a href="#2hex_127" rel="nofollow">2.hex文件分析</a></li></ul> 
  </li><li><a href="#_142" rel="nofollow">四、总结</a></li><li><a href="#_144" rel="nofollow">五、参考链接</a></li></ul> 
</div> 
<p></p> 
<h2><a id="Keil_1"></a>一、搭建与配置Keil嵌入式开发环境</h2> 
<h3><a id="1mdk_2"></a>1.安装mdk</h3> 
<p>（1）打开下载的keil5文件夹，点击运行mdk531<br> <img src="https://images2.imgbox.com/ce/2d/QOJVkeVK_o.png" alt=""><br> （2）在弹出的界面，点击next<br> <img src="https://images2.imgbox.com/49/95/BnJ4b8zL_o.png" alt=""><br> （3）勾选I agree，点击next<br> <img src="https://images2.imgbox.com/56/ec/PCtXmHdI_o.png" alt=""><br> （4）自定义安装路径，然后点击next<br> <img src="https://images2.imgbox.com/9b/35/FKxLEZD4_o.png" alt=""><br> （5）填写用户信息（可随便填写），然后点击next<br> <img src="https://images2.imgbox.com/9f/13/LcfbXWm1_o.png" alt=""><br> （6）开始安装，安装完成后点击Finish<br> <img src="https://images2.imgbox.com/f5/f0/4QUhRB3T_o.jpg" alt=""><br> <img src="https://images2.imgbox.com/14/22/vdVsvAmW_o.png" alt=""></p> 
<h3><a id="2STM32_17"></a>2.安装STM32芯片包</h3> 
<p>（1）在安装文件中点击Keil.STM32F1xx_DFP.2.1.0<br> <img src="https://images2.imgbox.com/1c/93/U2CWhX6d_o.png" alt=""><br> （2）点击Next进行安装<br> <img src="https://images2.imgbox.com/8c/39/r2d1mo0P_o.png" alt=""><br> （<code>注：</code>我已经安装过，所以会弹出如图片左下角所示的警告）<br> （3）开始安装，安装完成后点击Finish<br> <img src="https://images2.imgbox.com/b9/4f/dRIKJs8i_o.jpg" alt=""><br> <img src="https://images2.imgbox.com/ac/95/KhI1dL9I_o.png" alt=""><br> 至此，Keil嵌入式开发环境已全部搭建与配置完成。</p> 
<h2><a id="STM32_28"></a>二、基于STM32汇编程序的编写</h2> 
<h3><a id="1_29"></a>1.新建工程</h3> 
<p>打开keil，点击菜单栏Project–&gt;New μVision Project，新建项目，在弹窗中设置工程项目的名称和路径<br> <img src="https://images2.imgbox.com/bd/73/XQsKjXF7_o.png" alt=""></p> 
<h3><a id="2_32"></a>2.配置环境</h3> 
<p>（1）选择设备<br> 点击菜单中的Project，找到Options for Target ‘Target 1’并点击，在弹窗中选择相应的目标环境，此处我选的是STM32F103ZE<br> <img src="https://images2.imgbox.com/2d/80/O3MEm2ZA_o.jpg" alt=""><br> （2）选择运行环境<br> <img src="https://images2.imgbox.com/6e/7a/Gp1BONxt_o.png" alt=""><br> （3）设置仿真器模式<br> 点击菜单中的Project，找到Options for Target ‘Target 1’并点击，选择Debug–&gt;Use Simulator,将Dialog DLL以及Parameter处修改为自己选择的设备。<br> <img src="https://images2.imgbox.com/91/7c/uwq9m9Gf_o.png" alt=""></p> 
<h3><a id="3_41"></a>3.程序编写及调试</h3> 
<p>（1）添加源文件<br> 右键单击Source Group 1，选择Add New Item to Group,添加Asm File (.s)文件，命名为test3并保存。<br> 为其添加如下代码：</p> 
<pre><code class="prism language-c">AREA MYDATA<span class="token punctuation">,</span> DATA
	
 AREA MYCODE<span class="token punctuation">,</span> CODE
	ENTRY
	EXPORT __main

__main
	MOV R0<span class="token punctuation">,</span> #<span class="token number">10</span>
	MOV R1<span class="token punctuation">,</span> #<span class="token number">11</span>
	MOV R2<span class="token punctuation">,</span> #<span class="token number">12</span>
	MOV R3<span class="token punctuation">,</span> #<span class="token number">13</span>
	<span class="token punctuation">;</span>LDR R0<span class="token punctuation">,</span> <span class="token operator">=</span>func01

	BL	func01
	<span class="token punctuation">;</span>LDR R1<span class="token punctuation">,</span> <span class="token operator">=</span>func02
	BL	func02
	
	BL 	func03
	LDR LR<span class="token punctuation">,</span> <span class="token operator">=</span>func01
	LDR PC<span class="token punctuation">,</span> <span class="token operator">=</span>func03
	B <span class="token punctuation">.</span>
		
func01
	MOV R5<span class="token punctuation">,</span> #<span class="token number">05</span>
	BX LR
	
func02
	MOV R6<span class="token punctuation">,</span> #<span class="token number">06</span>
	BX LR
	
func03
	MOV R7<span class="token punctuation">,</span> #<span class="token number">07</span>
	MOV R8<span class="token punctuation">,</span> #<span class="token number">08</span>	
	BX LR
</code></pre> 
<p>（2）编译调试<br> 点击Options for Target ‘Target 1’，点击Output—&gt;Create HEX File，创建hex文件<br> <img src="https://images2.imgbox.com/29/94/XyNjfwpn_o.png" alt=""><br> 选择Rebuild进行编译，看编译有无错误<br> <img src="https://images2.imgbox.com/5f/ec/Tfq9rogw_o.png" alt=""><br> 选择Start Debug，然后利用调试工具开始进行调试操作<br> <img src="https://images2.imgbox.com/83/1d/bb7sWD2a_o.png" alt=""><br> 若寄存器R5,R6,R7,R8的值和程序设置一样，则成功了。</p> 
<h2><a id="hex_90"></a>三、分析hex文件</h2> 
<h3><a id="1hex_91"></a>1.打开hex文件</h3> 
<p>找到生成的hex文件，用记事本打开可看到文件内容</p> 
<pre><code class="prism language-c"><span class="token operator">:</span><span class="token number">100100004</span>B0100084B0100084B0100084B0100089F
<span class="token operator">:</span><span class="token number">100110004</span>B0100084B0100084B0100084B0100088F
<span class="token operator">:</span><span class="token number">100120004</span>B0100084B0100084B0100084B0100087F
<span class="token operator">:</span><span class="token number">100130000948804709480047F</span>EE7FEE7FEE7FEE77B
<span class="token operator">:</span><span class="token number">10014000F</span>EE7FEE7FEE7FEE7FEE7FEE704480549B7
<span class="token operator">:</span><span class="token number">10015000054</span>A064B7047000041020008990200085A
<span class="token operator">:</span><span class="token number">100160000000002000060020000200200002002005</span>
<span class="token operator">:</span><span class="token number">10017000704770477047000080</span>B500F001F880BDFF
<span class="token operator">:</span><span class="token number">1001800082</span>B041F204000021C4F20200019100910A
<span class="token operator">:</span><span class="token number">1001900050F</span><span class="token number">8041</span>C41F4803140F8041C50F8041C51
<span class="token operator">:</span><span class="token number">1001</span>A00001F400310091019901310191009919B9CF
<span class="token operator">:</span><span class="token number">1001</span>B0000199B1F5A06FF1D150F8041C890354BF27
<span class="token operator">:</span><span class="token number">1001</span>C0000021012100910099012936D142F200015C
<span class="token operator">:</span><span class="token number">1001</span>D000C4F202010A6842F010020A600A6822F0C2
<span class="token operator">:</span><span class="token number">1001E00003020</span>A600A6842F002020A6001680160C4
<span class="token operator">:</span><span class="token number">1001F</span><span class="token number">00001680160016841F</span><span class="token number">480610160016821F</span><span class="token number">4</span>D7
<span class="token operator">:</span><span class="token number">100200007</span>C110160016841F4E811016050F8041CA0
<span class="token operator">:</span><span class="token number">1002100041F</span><span class="token number">0807140F</span><span class="token number">8041</span>C50F8041C8901FBD5A2
<span class="token operator">:</span><span class="token number">10022000016821F</span><span class="token number">003010160016841F</span><span class="token number">002010160F</span><span class="token number">1</span>
<span class="token operator">:</span><span class="token number">10023000016801F</span><span class="token number">00</span>C010829FAD102B070470000F2
<span class="token operator">:</span><span class="token number">1002400080</span>B541F20000C4F202000168002241F0D2
<span class="token operator">:</span><span class="token number">10025000010101604168</span>CFF6FF0211404160016871
<span class="token operator">:</span><span class="token number">100260004FF</span><span class="token number">6FF</span><span class="token number">72</span>CFF6F66211400160016821F48B
<span class="token operator">:</span><span class="token number">1002700080210160416821F</span><span class="token number">4F</span>E0141604FF41F01BB
<span class="token operator">:</span><span class="token number">100280008160FFF</span><span class="token number">779FF</span><span class="token number">4</span>EF60850CEF200004FF084
<span class="token operator">:</span><span class="token number">100290000061016080</span>BD00004FF00A004FF00B01CB
<span class="token operator">:</span><span class="token number">1002</span>A0004FF00C024FF00D0300F009F800F00AF8CF
<span class="token operator">:</span><span class="token number">1002</span>B00000F00BF8DFF81CE0DFF81CF0FEE74FF071
<span class="token operator">:</span><span class="token number">1002</span>C000050570474FF0060670474FF007074FF0DF
<span class="token operator">:</span><span class="token number">0</span>C02D00008087047BF020008CB020008BD
<span class="token operator">:</span><span class="token number">040000050800029954</span>
<span class="token operator">:</span><span class="token number">00000001FF</span>
</code></pre> 
<h3><a id="2hex_127"></a>2.hex文件分析</h3> 
<blockquote> 
 <p>该文件为16进制的一串字符。hex文件的第一排字符称之为扩展线性地址记录，也称为32位地址记录或HEX386记录。<br> 在第一行数据020000040800F2中，其实际表达为0x02 0x00 0x00 0x04 0x08 0x00 0xf2。具体含义为：<br> ①第一个字节 0x02表示本行数据的长度；<br> ②第二、三字节 0x00 0x00表示本行数据的起始地址；<br> ③第四字节0x04表示数据类型，数据类型有：0x00、0x01、0x02、0x03、0x04、0x05<br> <code>'00' Data Rrecord：</code>用来记录数据，HEX文件的大部分记录都是数据记录<br> <code>'01' End of File Record:</code>用来标识文件结束，放在文件的最后，标识HEX文件的结尾<br> <code>'02' Extended Segment Address Record:</code>用来标识扩展段地址的记录<br> <code>'03' Start Segment Address Record:</code>开始段地址记录<br> <code>'04'Extended Linear Address Record:</code> 用来标识扩展线性地址的记录<br> <code>'05' Start Linear Address Record:</code>开始线性地址记录<br> ④然后是数据：0x08 0x00；<br> ⑤最后一个字节 0xf2为校验和。</p> 
</blockquote> 
<h2><a id="_142"></a>四、总结</h2> 
<p>从开始搭建与配置环境到开始一个基于STM32汇编程序的编写，遇到了许多的问题。比如程序安装过程繁琐，需要细心和耐心，不然就会出问题；还有程序调试出现报错的情况，可能是Debug中参数的设置有问题。总而言之，只有实践才能发现问题，通过本次作业，我了解了HEX文件内容，同时也知道了使用仿真器模式调试时要根据选择的设备更改参数。</p> 
<h2><a id="_144"></a>五、参考链接</h2> 
<p><a href="https://blog.csdn.net/qq_45659777/article/details/120496577">https://blog.csdn.net/qq_45659777/article/details/120496577</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7b57d9bd3b2cb6c5137c280d74a5096e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于STM32的USART串口通讯程序</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7ec6644cc3e0bb49c3f31f53616b7219/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单链表设置头结点的作用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>