<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>通过ssh建立两台主机的远程连接实现免密登陆 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="通过ssh建立两台主机的远程连接实现免密登陆" />
<meta property="og:description" content="一、ssh的建立原理 ssh远程连接
作用：远程端的主机基于网络通过标准的远程协议远程登录到对应的主机，类似于直接在本地端操作
应用层和传输层之间连接SSL/TLS安全认证层（SSL握手协议 SSL记录协议）
身份伪装
信息泄露
信息改
对称密钥： 加密和解密用的同一密钥（安全性较低，执行效率较高）---数据传输
非对称密钥： 公钥--数据加密 私钥--数据解密（安全性较高，执行效率较低）---握手阶段
ssh连接的原理过程： 1.版本协商阶段：客户端向服务端发起TCP初始连接请求，客户端收到服务端的请求，建立连接，向客户端发送报文，客户端收到报文后，解析该数据包，决定使用谁的版本协议号；之后，客户端回应服务端决定使用的版本号，服务器比较客户端发送的版本号，决定是否一起工作，协商成功后进入密钥算法协商阶段，否则断开TCP连接 。
2.服务器传送公钥给客户端： 接收到客户端的要求后，服务器便将第一个步骤取得的公钥传送给客户端使用 (此时应是明码传送，反正公钥本来就是给大家使用的)。
3.客户端记录并比对服务器的公钥数据及随机计算自己的公私钥： 若客户端第一次连接到此服务器，则会将服务器的公钥记录到客户端的用户家目录内的 ~/.ssh/known_hosts 。若是已经记录过该服务器的公钥，则客户端会去比对此次接收到的与之前的记录是否有差异。若接受此公钥， 则开始计算客户端自己的公私钥。
4.回传客户端的公钥到服务器端： 用户将自己的公钥传送给服务器。此时服务器：具有服务器的私钥与客户端的公钥，而客户端则是： 具有服务器的公钥以及客户端自己的私钥，你会看到，在此次联机的服务器与客户端的密钥系统 (公钥&#43;私钥) 并不一样，所以才称为非对称加密系统。
5.开始双向加解密： (1)服务器到客户端：服务器传送数据时，拿用户的公钥加密后送出。客户端接收后，用自己的私钥解密 (2)客户端到服务器：客户端传送数据时，拿服务器的公钥加密后送出。服务器接收后，用服务器的私钥解密，这样就能保证通信安全。
ssh连接的过程： 二、配置两台主机的远程连接实现免密登陆 主机A：192.168.114.138 主机B：192.168.114.147 第一步：生成密钥对 在A机下产生密钥：ssh-keygen -t RSA -b 4096，一直按enter [root@A ~]# ssh-keygen -t RSA 检查是否产生密钥对： id_rsa 私钥
id_rsa.pub 公钥
[root@A ~]# cd /root/.ssh/ [root@A .ssh]# ll total 8 -rw-------. 1 root root 2590 Oct 15 04:43 id_rsa -rw-r--r--." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/1cdaae4af6735f2791e46c6cadc9c207/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-17T16:07:21+08:00" />
<meta property="article:modified_time" content="2022-10-17T16:07:21+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">通过ssh建立两台主机的远程连接实现免密登陆</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、ssh的建立原理</h2> 
<p>ssh远程连接</p> 
<p>作用：远程端的主机基于网络通过标准的远程协议远程登录到对应的主机，类似于直接在本地端操作</p> 
<p>应用层和传输层之间连接SSL/TLS安全认证层（SSL握手协议 SSL记录协议）</p> 
<p>      身份伪装</p> 
<p>      信息泄露</p> 
<p>      信息改</p> 
<h4>对称密钥：</h4> 
<p>加密和解密用的同一密钥（安全性较低，执行效率较高）---数据传输</p> 
<h4>非对称密钥：</h4> 
<p>公钥--数据加密 私钥--数据解密（安全性较高，执行效率较低）---握手阶段</p> 
<h3>ssh连接的原理过程：</h3> 
<p>1.版本协商阶段：客户端向服务端发起TCP初始连接请求，客户端收到服务端的请求，建立连接，向客户端发送报文，客户端收到报文后，解析该数据包，决定使用谁的版本协议号；之后，客户端回应服务端决定使用的版本号，服务器比较客户端发送的版本号，决定是否一起工作，协商成功后进入密钥算法协商阶段，否则断开TCP连接 。</p> 
<p>2.服务器传送公钥给客户端： 接收到客户端的要求后，服务器便将第一个步骤取得的公钥传送给客户端使用 (此时应是明码传送，反正公钥本来就是给大家使用的)。</p> 
<p>3.客户端记录并比对服务器的公钥数据及随机计算自己的公私钥： 若客户端第一次连接到此服务器，则会将服务器的公钥记录到客户端的用户家目录内的 ~/.ssh/known_hosts 。若是已经记录过该服务器的公钥，则客户端会去比对此次接收到的与之前的记录是否有差异。若接受此公钥， 则开始计算客户端自己的公私钥。</p> 
<p>4.回传客户端的公钥到服务器端： 用户将自己的公钥传送给服务器。此时服务器：具有服务器的私钥与客户端的公钥，而客户端则是： 具有服务器的公钥以及客户端自己的私钥，你会看到，在此次联机的服务器与客户端的密钥系统 (公钥+私钥) 并不一样，所以才称为非对称加密系统。</p> 
<p>5.开始双向加解密： (1)服务器到客户端：服务器传送数据时，拿用户的公钥加密后送出。客户端接收后，用自己的私钥解密 (2)客户端到服务器：客户端传送数据时，拿服务器的公钥加密后送出。服务器接收后，用服务器的私钥解密，这样就能保证通信安全。<img alt="" height="380" src="https://images2.imgbox.com/da/98/d5CEytPE_o.png" width="625"></p> 
<h4>ssh连接的过程：</h4> 
<h4><br><img alt="" height="1152" src="https://images2.imgbox.com/c3/f3/dyJbAQHC_o.png" width="764"></h4> 
<h2> 二、配置两台主机的远程连接实现免密登陆</h2> 
<h4>主机A：192.168.114.138</h4> 
<h4>主机B：192.168.114.147</h4> 
<h3>第一步：生成密钥对</h3> 
<h4>在A机下产生密钥：ssh-keygen -t RSA -b 4096，一直按enter </h4> 
<pre><code>[root@A ~]# ssh-keygen  -t RSA
</code></pre> 
<p><img alt="" height="499" src="https://images2.imgbox.com/3f/65/47JqDxYJ_o.png" width="480"></p> 
<h4> 检查是否产生密钥对：</h4> 
<p>   id_rsa 私钥</p> 
<p>   id_rsa.pub 公钥</p> 
<pre><code>[root@A ~]# cd /root/.ssh/
[root@A .ssh]# ll
total 8
-rw-------. 1 root root 2590 Oct 15 04:43 id_rsa
-rw-r--r--. 1 root root  560 Oct 15 04:43 id_rsa.pub
</code></pre> 
<h3>第二步：发送公钥到要连接的另一个主机</h3> 
<pre><code>[root@A .ssh]# ssh-copy-id -i 192.168.114.147
</code></pre> 
<p><img alt="" height="557" src="https://images2.imgbox.com/b6/60/REc8wzhg_o.png" width="602"></p> 
<h3>第三步：到主机B上查看是否产生authorized_keys的文件</h3> 
<p><img alt="" height="143" src="https://images2.imgbox.com/a4/6f/IemT8iLZ_o.png" width="582"></p> 
<h3>第四步：测试</h3> 
<h4>从主机A连接主机B</h4> 
<pre><code>[root@A .ssh]# ssh 192.168.114.147
</code></pre> 
<p><img alt="" height="290" src="https://images2.imgbox.com/70/37/VPDuoi9R_o.png" width="499"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e53db092688a0b90b26cd8a6e1de869c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux内核安装编译</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8a1077f13b465c4b5e6c989d63d953fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2021年西部数据叠瓦(SMR)、垂直型号(PMR)机械硬盘大全（防踩雷！）仅供参考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>