<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NPM软件包发布到Nexus - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="NPM软件包发布到Nexus" />
<meta property="og:description" content="NPM软件包发布到Nexus
文章目录 1.Linux安装nodejs环境2.创建镜像仓库3.添加nexus权限4.设置镜像仓库地址5.发布单个包6.发布tgz包7.批量发布npm包到私有仓库8.查看nexus的npm仓库9.测试 1.Linux安装nodejs环境 下载地址 https://nodejs.org/en/download/
wget https://nodejs.org/download/release/v14.18.3/node-v14.18.3-linux-x64.tar.gz tar xf node-v14.18.3-linux-x64.tar.gz mkdir -p /usr/software/ mv node-v14.18.3-linux-x64 /usr/software/nodejs ln -s /usr/software/nodejs/bin/npm /usr/local/bin ln -s /usr/software/nodejs/bin/node /usr/local/bin node -v npm -v 2.创建镜像仓库 名称自己定义，这里我定义为npm
3.添加nexus权限 在Realms菜单中，将npm Bearer Token Realm添加到Active中；
不添加执行npm publish 会报错
npm ERR! code ENEEDAUTHnpm ERR! need auth This command requires you to be logged in.npm ERR! need auth You need to authorize this machine using npm adduser 4.设置镜像仓库地址 npm config -g set registry http://x." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/2b00eda3b280e6bcb9759eeb67afca98/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-28T01:36:07+08:00" />
<meta property="article:modified_time" content="2022-04-28T01:36:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">NPM软件包发布到Nexus</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-dracula">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>NPM软件包发布到Nexus<br> </p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#1Linuxnodejs_2" rel="nofollow">1.Linux安装nodejs环境</a></li><li><a href="#2_15" rel="nofollow">2.创建镜像仓库</a></li><li><a href="#3nexus_20" rel="nofollow">3.添加nexus权限</a></li><li><a href="#4_29" rel="nofollow">4.设置镜像仓库地址</a></li><li><a href="#5_39" rel="nofollow">5.发布单个包</a></li><li><a href="#6tgz_51" rel="nofollow">6.发布tgz包</a></li><li><a href="#7npm_58" rel="nofollow">7.批量发布npm包到私有仓库</a></li><li><a href="#8nexusnpm_72" rel="nofollow">8.查看nexus的npm仓库</a></li><li><a href="#9_75" rel="nofollow">9.测试</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="1Linuxnodejs_2"></a>1.Linux安装nodejs环境</h3> 
<blockquote> 
 <p>下载地址 https://nodejs.org/en/download/</p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token function">wget</span> https://nodejs.org/download/release/v14.18.3/node-v14.18.3-linux-x64.tar.gz
<span class="token function">tar</span> xf  node-v14.18.3-linux-x64.tar.gz
<span class="token function">mkdir</span> -p /usr/software/
<span class="token function">mv</span> node-v14.18.3-linux-x64 /usr/software/nodejs
<span class="token function">ln</span> -s /usr/software/nodejs/bin/npm   /usr/local/bin
<span class="token function">ln</span> -s /usr/software/nodejs/bin/node   /usr/local/bin
<span class="token function">node</span> -v
<span class="token function">npm</span> -v
</code></pre> 
<h3><a id="2_15"></a>2.创建镜像仓库</h3> 
<blockquote> 
 <p>名称自己定义，这里我定义为npm</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/55/3c/3uPlh6Tf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3nexus_20"></a>3.添加nexus权限</h3> 
<blockquote> 
 <p>在Realms菜单中，将npm Bearer Token Realm添加到Active中；<br> 不添加执行npm publish 会报错</p> 
 <ul><li>npm ERR! code ENEEDAUTH</li><li>npm ERR! need auth This command requires you to be logged in.</li><li>npm ERR! need auth You need to authorize this machine using <code>npm adduser</code></li></ul> 
</blockquote> 
<p><img src="https://images2.imgbox.com/f7/a3/t1vKjWBc_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4_29"></a>4.设置镜像仓库地址</h3> 
<pre><code class="prism language-shell"><span class="token function">npm</span> config -g <span class="token builtin class-name">set</span> registry http://x.x.x.x:port/repository/npm/
</code></pre> 
<pre><code class="prism language-shell"><span class="token function">npm</span> adduser -registry http://xxx.xx.x.x:xxxx/repository/npm
Username: admin
Password: 
Email: <span class="token punctuation">(</span>this IS public<span class="token punctuation">)</span> xxxx@yyy.com
</code></pre> 
<h3><a id="5_39"></a>5.发布单个包</h3> 
<blockquote> 
 <p>5.1在package.json同级目录</p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token function">npm</span> publish -registry http://xxx.xx.x.x:xxxx/repository/npm
</code></pre> 
<blockquote> 
 <p>5.2在package.json 中添加私库地址,然后执行 npm publish</p> 
</blockquote> 
<pre><code class="prism language-json"><span class="token string-property property">"publishConfig"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"registry"</span><span class="token operator">:</span> <span class="token string">"仓库地址"</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<h3><a id="6tgz_51"></a>6.发布tgz包</h3> 
<pre><code class="prism language-shell"><span class="token function">npm</span> publish -registry<span class="token operator">=</span>http://xxx.xx.x.x:xxxx/repository/npm  core-util-is-1.0.3.tgz
或
<span class="token function">npm</span> publish core-util-is-1.0.3.tgz
</code></pre> 
<h3><a id="7npm_58"></a>7.批量发布npm包到私有仓库</h3> 
<blockquote> 
 <p>私网环境是无法下载npm包，一般事先要有网络的节点新先进行下载，然后拷贝到到私网服务器上</p> 
</blockquote> 
<pre><code class="prism language-shell"><span class="token function">find</span> <span class="token builtin class-name">.</span> -type f -name <span class="token string">"*.tgz"</span>  <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">"s|^\./||"</span> <span class="token operator">|</span> <span class="token function">xargs</span> -I <span class="token string">'{}'</span> <span class="token function">npm</span> publish <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>  <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">tee</span> -a npm.log
</code></pre> 
<p><code>有些存在"publishConfig": { "registry": "仓库地址" },被限制了，需要手工维护，在进行上传</code></p> 
<pre><code class="prism language-shell"><span class="token function">cat</span> npm.log <span class="token operator">|</span><span class="token function">grep</span> ERR
<span class="token function">grep</span> <span class="token string">".tgz"</span>  /root/.npm/_logs/*.log <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">'verbose cli'</span>
</code></pre> 
<blockquote> 
 <p>以下npm存在仓库地址被固定了</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/85/81/wHu2untG_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="8nexusnpm_72"></a>8.查看nexus的npm仓库</h3> 
<p><img src="https://images2.imgbox.com/10/af/k1GKbOc9_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="9_75"></a>9.测试</h3> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> <span class="token builtin class-name">test</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token builtin class-name">test</span>
<span class="token function">npm</span> init --yes
<span class="token function">npm</span> <span class="token function">install</span> vconsole@^3.14.6
<span class="token function">npm</span> <span class="token function">install</span> base64-js
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cf7147da1f8447ed9273fd25434d8bae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">嵌入式开发使用 GCC编译器警告错误问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7d4e99589d4fd71163591e0963f38f58/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">OpenCV之Mat的详细介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>