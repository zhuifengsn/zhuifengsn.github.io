<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>AB测试详细过程 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="AB测试详细过程" />
<meta property="og:description" content="AB测试详细过程 1 AB测试原理简介2 选取指标3 建立假设4 选取实验单位5 计算样本量6 流量分割7 实验周期计算8 线上验证9 数据检验10 知识点总结 1 AB测试原理简介 AB测试最核心的原理，就四个字：假设检验。
检验我们提出的假设是否正确。对应到AB测试中，就是检验实验组&amp;对照组，指标是否有显著差异。
既然是假设检验，那么就是先假设，再收集数据，最后根据收集的数据来做检验。
先来说说假设。
假设一般成对出现，分为零假设 和 备选假设。
在AB测试中，零假设是：实验组&amp;对照组 指标相同，无显著差异；备选假设则相反，实验组&amp;对照组 指标不同，有显著差异。
举个例子。我们优化了某算法，想提高页面的点击率。针对这个场景的AB测试，零假设就是 新算法&amp;老算法的页面点击率无明显差异，备选假设是 新算法&amp;老算法的页面点击率有显著差异。
再来说说检验。
一般来说，我们是通过具体的指标属性来找寻相应的检验方法。那么问题来了，指标如何分类呢？
指标可以分为两种类别：
1、绝对值类指标。也就是我们平常直接计算就能得到的，比如DAU，点击次数等。我们的一般都是统计该指标在一段时间内的均值或者汇总值，不存在两个值之间还要相互计算。
2、相对值类指标。与绝对值类指标相反，我们不能直接计算得到。比如某页面的CTR，我们是用 页面点击数 / 页面展现数。我们要计算点击数和展现数，两者相除才能得到该指标。类似的，还有XX转化率，XX点击率，XX购买率一类的。我们做的AB实验，大部分情况下都想提高这类指标。
根据指标我们可以知道，该如何计算最小样本量，以及实验周期，以及对应的检验方法。
对于AB测试详细流程，大体可以分为以下7步：
选取指标建立假设选取实验单位计算样本量流量分割实验周期计算线上验证数据检验 2 选取指标 在做AB测试之前，我们一定要清楚，我们实验的目标是什么。并落地到具体的几个指标上，这几个指标对于我们度量实验结果，有非常明显的帮助。但是，指标也要分层级，唯一一个核心指标&#43;多个观察指标。
核心指标用来度量我们这次实验的效果，以及计算相应的样本量。观察指标则用来度量，该实验对其他数据的影响（比如对大盘留存的影响，对网络延迟的影响等等）。
3 建立假设 建立假设就如同上文所说，我们建立了零假设和备选假设，零假设一般是没有效果，备选假设是有效果。
4 选取实验单位 大家应该都使用用户粒度来作为实验单位，但是总体说来，实验单位一般有3种。我们不用掌握，但是很多情况下面试官会问到，大家可以作为了解。
1、用户粒度：这个是最推荐的，即以一个用户的唯一标识来作为实验样本。好处是符合AB测试的分桶单位唯一性，不会造成一个实验单位处于两个分桶，造成的数据不置信。
2、设备粒度：以一个设备标识为实验单位。相比用户粒度，如果一个用户有两个手机，那么也可能出现一个用户在两个分桶中的情况，所以也会造成数据不置信的情况。
3、行为粒度：以一次行为为实验单位，也就是用户某一次使用该功能，是实验桶，下一次使用可能就被切换为基线桶。会造成大量的用户处于不同的分桶。强烈不推荐这种方式。
5 计算样本量 样本量计算，我们需要了解一下中心极限定理。具体书面定义和推导过程，大家可以在网上百度一下就好，我们这里就通俗的解释一下。中心极限定理的含义，就是只要样本量足够大，无论是什么指标，无论对应的指标分布是怎样的，样本的均值分布都会趋于正态分布。
基于正态分布，我们才能计算出相应的样本量和做假设检验。具体的样本量计算推导过程，大家如有需要，可以关注后加我微信私聊，这里就放结论。
整体公式如下：
此外我们也可以通过以下一个线上工具进行求解
6 流量分割 流量切割有两种方式：分流和分层。
分流是指我们直接将整体用户切割为几块，用户只能在一个实验中。但是这种情况很不现实，因为如果我要同时上线多个实验，流量不够切怎么办？那为了达到最小样本量，我们就得延长实验周期，要是做一个实验，要几个月，相信我，你老板一定会和你聊聊人生理想的。
另一种方式，分层。就是将同一批用户，不停的随机后，处于不同的桶。也就是说，一个用户会处于多个实验中，只要实验之间不相互影响，我们就能够无限次的切割用户。这样在保证了每个实验都能用全流量切割的同时，也保证了实验数据是置信的。
7 实验周期计算 相应的，最小样本量有了，我们切分了流量，知道了实验桶一天大概能有多少样本量（也可以算小时，如果产品的流量足够大）。我们直接用 最小样本量 / 实验桶天均流量 即可以得到相应的实验周期。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/4eb3241e1baede477627c7f3106a2912/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-21T09:44:42+08:00" />
<meta property="article:modified_time" content="2021-04-21T09:44:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">AB测试详细过程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>AB测试详细过程</h4> 
 <ul><li><a href="#1_AB_1" rel="nofollow">1 AB测试原理简介</a></li><li><a href="#2__38" rel="nofollow">2 选取指标</a></li><li><a href="#3__43" rel="nofollow">3 建立假设</a></li><li><a href="#4__46" rel="nofollow">4 选取实验单位</a></li><li><a href="#5__55" rel="nofollow">5 计算样本量</a></li><li><a href="#6__66" rel="nofollow">6 流量分割</a></li><li><a href="#7__74" rel="nofollow">7 实验周期计算</a></li><li><a href="#8__77" rel="nofollow">8 线上验证</a></li><li><a href="#9__84" rel="nofollow">9 数据检验</a></li><li><a href="#10__104" rel="nofollow">10 知识点总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="1_AB_1"></a>1 AB测试原理简介</h2> 
<p>AB测试最核心的原理，就四个字：假设检验。<br> 检验我们提出的假设是否正确。对应到AB测试中，就是检验实验组&amp;对照组，指标是否有显著差异。</p> 
<p>既然是假设检验，那么就是先假设，再收集数据，最后根据收集的数据来做检验。</p> 
<p><strong>先来说说假设。</strong></p> 
<p>假设一般成对出现，分为零假设 和 备选假设。<br> 在AB测试中，零假设是：实验组&amp;对照组 指标相同，无显著差异；备选假设则相反，实验组&amp;对照组 指标不同，有显著差异。</p> 
<p>举个例子。我们优化了某算法，想提高页面的点击率。针对这个场景的AB测试，零假设就是 新算法&amp;老算法的页面点击率无明显差异，备选假设是 新算法&amp;老算法的页面点击率有显著差异。</p> 
<p><strong>再来说说检验。</strong></p> 
<p>一般来说，我们是通过具体的指标属性来找寻相应的检验方法。那么问题来了，指标如何分类呢？</p> 
<p>指标可以分为两种类别：<br> 1、<strong>绝对值类指标</strong>。也就是我们平常直接计算就能得到的，比如DAU，点击次数等。我们的一般都是统计该指标在一段时间内的均值或者汇总值，不存在两个值之间还要相互计算。</p> 
<p>2、<strong>相对值类指标</strong>。与绝对值类指标相反，我们不能直接计算得到。比如某页面的CTR，我们是用 页面点击数 / 页面展现数。我们要计算点击数和展现数，两者相除才能得到该指标。类似的，还有XX转化率，XX点击率，XX购买率一类的。我们做的AB实验，大部分情况下都想提高这类指标。</p> 
<p>根据指标我们可以知道，该如何计算最小样本量，以及实验周期，以及对应的检验方法。</p> 
<p>对于AB测试详细流程，大体可以分为以下7步：</p> 
<ol><li>选取指标</li><li>建立假设</li><li>选取实验单位</li><li>计算样本量</li><li>流量分割</li><li>实验周期计算</li><li>线上验证</li><li>数据检验</li></ol> 
<h2><a id="2__38"></a>2 选取指标</h2> 
<p>在做AB测试之前，我们一定要清楚，我们实验的目标是什么。并落地到具体的几个指标上，这几个指标对于我们度量实验结果，有非常明显的帮助。但是，指标也要分层级，唯一一个核心指标+多个观察指标。</p> 
<p>核心指标用来度量我们这次实验的效果，以及计算相应的样本量。观察指标则用来度量，该实验对其他数据的影响（比如对大盘留存的影响，对网络延迟的影响等等）。</p> 
<h2><a id="3__43"></a>3 建立假设</h2> 
<p>建立假设就如同上文所说，我们建立了零假设和备选假设，零假设一般是没有效果，备选假设是有效果。</p> 
<h2><a id="4__46"></a>4 选取实验单位</h2> 
<p>大家应该都使用用户粒度来作为实验单位，但是总体说来，实验单位一般有3种。我们不用掌握，但是很多情况下面试官会问到，大家可以作为了解。</p> 
<p>1、用户粒度：这个是最推荐的，即以一个用户的唯一标识来作为实验样本。好处是符合AB测试的分桶单位唯一性，不会造成一个实验单位处于两个分桶，造成的数据不置信。</p> 
<p>2、设备粒度：以一个设备标识为实验单位。相比用户粒度，如果一个用户有两个手机，那么也可能出现一个用户在两个分桶中的情况，所以也会造成数据不置信的情况。</p> 
<p>3、行为粒度：以一次行为为实验单位，也就是用户某一次使用该功能，是实验桶，下一次使用可能就被切换为基线桶。会造成大量的用户处于不同的分桶。强烈不推荐这种方式。</p> 
<h2><a id="5__55"></a>5 计算样本量</h2> 
<p>样本量计算，我们需要了解一下中心极限定理。具体书面定义和推导过程，大家可以在网上百度一下就好，我们这里就通俗的解释一下。中心极限定理的含义，就是只要样本量足够大，无论是什么指标，无论对应的指标分布是怎样的，样本的均值分布都会趋于正态分布。</p> 
<p>基于正态分布，我们才能计算出相应的样本量和做假设检验。具体的样本量计算推导过程，大家如有需要，可以关注后加我微信私聊，这里就放结论。</p> 
<p>整体公式如下：<br> <img src="https://images2.imgbox.com/49/07/EQhq7EGf_o.png" alt="在这里插入图片描述"><br> 此外我们也可以通过以下一个线上工具进行求解</p> 
<p><img src="https://images2.imgbox.com/a8/55/zAHeK2vf_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="6__66"></a>6 流量分割</h2> 
<p>流量切割有两种方式：分流和分层。</p> 
<p>分流是指我们直接将整体用户切割为几块，用户只能在一个实验中。但是这种情况很不现实，因为如果我要同时上线多个实验，流量不够切怎么办？那为了达到最小样本量，我们就得延长实验周期，要是做一个实验，要几个月，相信我，你老板一定会和你聊聊人生理想的。</p> 
<p>另一种方式，分层。就是将同一批用户，不停的随机后，处于不同的桶。也就是说，一个用户会处于多个实验中，只要实验之间不相互影响，我们就能够无限次的切割用户。这样在保证了每个实验都能用全流量切割的同时，也保证了实验数据是置信的。</p> 
<h2><a id="7__74"></a>7 实验周期计算</h2> 
<p>相应的，最小样本量有了，我们切分了流量，知道了实验桶一天大概能有多少样本量（也可以算小时，如果产品的流量足够大）。我们直接用 最小样本量 / 实验桶天均流量 即可以得到相应的实验周期。</p> 
<h2><a id="8__77"></a>8 线上验证</h2> 
<p>很多公司不会做线上验证。当然，不验证也没关系，就是有可能会踩坑，所以还是建议大家在实验上线后进行线上验证。</p> 
<p>线上验证主要是2个方向，一个是验证实验策略是否真的触发。即我们上线的实验桶，是否在产品上实际落地了。比如你优化了一个产品功能，你可以去实际体验下，实验桶产品是否真的有优化。</p> 
<p>另一个是验证同一个用户只能在同一个桶中，要是同时出现在两个桶中，后期数据也会不置信。</p> 
<h2><a id="9__84"></a>9 数据检验</h2> 
<p>大家应该都看过这个图：<br> <img src="https://images2.imgbox.com/36/c1/I3NRAKyW_o.png" alt=""></p> 
<p><strong>按照上文我们说的指标分类，一般情况下，绝对值指标用T检验，相对值指标用Z检验。</strong></p> 
<p>因为绝对指标的的总体方差，需要知道每一个用户的值，这个在AB实验中肯定不可能。而相对值指标是二项分布，可以通过样本量的值计算出总体的值，就如同10W人的某页面点击率是10%，随机从这10W人中抽样1W人，这个点击率也是10%一样。</p> 
<p>再来说说具体的检验。一般情况下我们可以用两种常用方法：</p> 
<p>1、算P值，也就是算当零假设成立时，观测到样本数据出现的概率。统计学上，将5%作为一个小概率事件，所以一般用5%来对比计算出来的P值。当P值小于5%时，拒绝零假设，即两组指标不同；反过来，当P值大于5%时，接受零假设，两组指标相同。</p> 
<p>2、算置信区间。一般情况下，我们都会用95%来作为置信水平。也就是说，当前数据的估计，有95%的区间包含了总体参数的真值。这么说可能比较绕，我们可以简单理解成 总体数据有95%的可能性在这个范围内。</p> 
<p>我们计算两组指标的差异值，如果我们算出的差异值置信区间不含0，我们就拒绝零假设，认为两组指标不同；但是如果包含0，我们则要接受零假设，认为两组指标相同。</p> 
<p>当然，我们也可以直接算出Z值或者T值，查表对比。但是这种不是很常用，还是以P值及置信区间为主流。</p> 
<h2><a id="10__104"></a>10 知识点总结</h2> 
<p>我们来总结下知识点：<br> 1、实验流程是 选取指标 – 建立假设 – 选取实验单位 – 计算样本量 – 流量分割 – 实验周期计算 – 线上验证 – 数据检验。</p> 
<p>2、假设分为零假设和备选假设，零假设一般都是实验无效（指标无差异），备选假设是实验有效（指标有差异）。</p> 
<p>3、指标可以分为 绝对值指标 和相对值指标，相应的，绝对值指标推荐用T检验，相对值指标推荐用Z检验。</p> 
<p>4、检验数据是否有效，可以算P值，高于5%就接受原假设，两组指标相同；也可以算置信区间的差异值，如果差异值包含0，则接受原假设，两组指标相同。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9c35b8d257e8ddf5903cc249321e5a82/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">matlab怎么读取simulink中的时序数据？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e05a3934c63e60ee0a66bb25c5b704db/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQLSever查询第11行到第25行的数据，sql分页查询 （ offset 10 rows fetch next 15 rows only）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>