<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>下载NCBI的SRA数据 详细教程 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="下载NCBI的SRA数据 详细教程" />
<meta property="og:description" content="SRA（Sequence ReadArchive）数据库是NCBI(National Center for Biotechnology Information)旗下用于存储高通量测序数据的子库。来自世界各地研究的测序数据在此处都可以免费下载，本文就聊聊如何下载SRA数据库对应的测序数据。
1. SRA基本框架 下载数据之前，咱们可以先聊聊SRA数据库的一些基础知识。
SRA数据库的组织框架是基于 STUDY, SAMPLE, EXPERIMENT, RUN 四个概念构建的。
STUDY ：研究课题/研究项目， 和NCBI的子库[BioProject](https://www.ncbi.nlm.nih.gov/bioproject/)数据库里面的项目相关联 , 检索号(accession number) 通常以前缀 SRP,DRP,ERP 开头(例如SRP000544)SAMPLE ：样本信息， 和NCBI的子库[BioSample](https://www.ncbi.nlm.nih.gov/biosample/)数据库里面的样本相关联，检索号(accession number) 通常以前缀 SRS,DRS,ERS 开头(例如SRS001487)EXPERIMENT : 实验信息, 一次实验包含了一个或多个样本进行一个多多个RUN的测序。检索号(accession number) 通常以前缀 SRX,DRX,ERX 开头RUN：RUN通俗理解就是测序仪运行一次产生的测序数据，是 SRA 里面最小的概念，该编号通常直接链接到对应某一个/对fastq下机的文件。检索号 (accession number) 通常以前缀 SRR,DRR,ERR 开头。 说了这么多是不是依然傻傻分不清SRP,DRP,ERP等，其实编号的含义很简单：
第一个字母：表示样本最初被上传到的源数据库，NCBI会同步EBI和DDBJ的数据，同步后会保留源数据的来源信息。
S – NCBI’s SRA database E – EBI’s database D – DDBJ database 第二个字母：固定为&#34;R&#34;，代表Read
第三个字母：数据的类型，可以是项目、样本、实验或RUN
R – Run X – Experiment S – Sample P – Project / study 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/e73c6d46260863bffe86a393a68fe92e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-05T16:45:33+08:00" />
<meta property="article:modified_time" content="2022-04-05T16:45:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">下载NCBI的SRA数据 详细教程</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>SRA（Sequence ReadArchive）数据库是NCBI(National Center for Biotechnology Information)旗下用于存储高通量测序数据的子库。来自世界各地研究的测序数据在此处都可以免费下载，本文就聊聊如何下载SRA数据库对应的测序数据。</p> 
<h4><a id="1_SRA_1"></a>1. SRA基本框架</h4> 
<p>下载数据之前，咱们可以先聊聊SRA数据库的一些基础知识。<br> SRA数据库的组织框架是基于 STUDY, SAMPLE, EXPERIMENT, RUN 四个概念构建的。</p> 
<ol><li><strong>STUDY</strong> ：研究课题/研究项目， 和NCBI的子库<code>[BioProject](https://www.ncbi.nlm.nih.gov/bioproject/)</code>数据库里面的项目相关联 , 检索号(accession number) 通常以前缀 <code>SRP,DRP,ERP</code> 开头(例如SRP000544)</li><li><strong>SAMPLE</strong> ：样本信息， 和NCBI的子库<code>[BioSample](https://www.ncbi.nlm.nih.gov/biosample/)</code>数据库里面的样本相关联，检索号(accession number) 通常以前缀 <code>SRS,DRS,ERS</code> 开头(例如SRS001487)</li><li><strong>EXPERIMENT</strong> : 实验信息, 一次实验包含了一个或多个样本进行一个多多个RUN的测序。检索号(accession number) 通常以前缀 <code>SRX,DRX,ERX</code> 开头</li><li><strong>RUN</strong>：RUN通俗理解就是测序仪运行一次产生的测序数据，是 SRA 里面最小的概念，该编号通常直接链接到对应某一个/对fastq下机的文件。检索号 (accession number) 通常以前缀 <code>SRR,DRR,ERR</code> 开头。</li></ol> 
<p>说了这么多是不是依然傻傻分不清SRP,DRP,ERP等，其实编号的含义很简单：<br> 第一个字母：表示样本最初被上传到的源数据库，NCBI会同步EBI和DDBJ的数据，同步后会保留源数据的来源信息。</p> 
<pre><code>S – NCBI’s SRA database  
E – EBI’s database  
D – DDBJ database  
</code></pre> 
<p>第二个字母：固定为"R"，代表Read<br> 第三个字母：数据的类型，可以是项目、样本、实验或RUN</p> 
<pre><code>R – Run  
X – Experiment  
S – Sample  
P – Project / study 
</code></pre> 
<h4><a id="2_SRA_26"></a>2. SRA数据下载</h4> 
<p>SRA数据下载有多种方式，这里我列了常用的两种方式：1）通过官网提供的 SRA-Toolkit 工具进行下载 2）直接wget/curl下载。</p> 
<h5><a id="21_SRAToolkit__30"></a>2.1. SRA-Toolkit 工具进行下载：</h5> 
<p>这种方式自然要先安装 SRA-Toolkit，可以直接下载对应的二进制包，解压即可使用。<br> 对应的下载链接为<a href="https://github.com/ncbi/sra-tools/wiki/02.-Installing-SRA-Toolkit">https://github.com/ncbi/sra-tools/wiki/02.-Installing-SRA-Toolkit</a></p> 
<pre><code class="prism language-bash"><span class="token comment">#Ubuntu</span>
<span class="token function">wget</span> http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-ubuntu64.tar.gz
<span class="token comment">#CentOS</span>
<span class="token function">wget</span> http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-centos_linux64.tar.gz
<span class="token comment">#Mac OS X</span>
<span class="token function">wget</span> http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-mac64.tar.gz

<span class="token comment">#解压 tar.gz名字以实际文件名为准</span>
<span class="token function">tar</span> -xzvf sratoolkit.*.tar.gz
</code></pre> 
<p>下载解压后，可以看到文件夹bin/目录下面有一堆二进制运行的组件，其中 prefetch，srapath ， fastq-dump都是常用的工具集。</p> 
<p>此处下载使用prefetch 工具，例如下载千人基因组项目的数据ERR009357。</p> 
<pre><code class="prism language-bash">prefetch ERR009357
</code></pre> 
<p>也可以提供RUN的SRR/DRR/ERR检索号列表, 例如此处我们下载SRR_Acc_List.txt文件内的所有ERR数据：</p> 
<pre><code class="prism language-bash">$ <span class="token function">cat</span>  SRR_Acc_List.txt
ERR003133
ERR003134
ERR003135
ERR003136
ERR003137

$ <span class="token function">nohup</span> prefetch -O <span class="token builtin class-name">.</span> <span class="token variable"><span class="token variable">$(</span><span class="token operator">&lt;</span>SRR_Acc_List.txt<span class="token variable">)</span></span> <span class="token operator">&amp;</span>   <span class="token comment"># 此处的 nohup + &amp;  用于放入后台下载，避免关闭终端导致下载中断</span>
</code></pre> 
<h5><a id="22_wgetcurl__62"></a>2.2. wget/curl 下载：</h5> 
<p>使用wget/curl下载需要事先知道对应sra数据的下载链接，一种方式可以通过以下链接：<br> <code>https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=SRR编号</code> 获取，其中<code>SRR编号</code>替换为你需要下载的RUN检索号即可，例如打开https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=ERR009357 即可查看 ERR009357对应的详细信息。其中 <code>Data access</code> 页面即可看到对应的下载链接。其中，<code>Metadata</code>, <code>Reads</code> 页面可以查看样本实验信息。<br> <img src="https://images2.imgbox.com/30/9c/GCndioXA_o.png" alt="在这里插入图片描述"></p> 
<p>复制下载链接，使用wget/curl下载即可。</p> 
<pre><code class="prism language-bash"><span class="token function">wget</span> https://sra-downloadb.be-md.ncbi.nlm.nih.gov/sos1/sra-pub-run-5/ERR009357/ERR009357.4
</code></pre> 
<p>嫌麻烦的话也可以通过 <code>srapath</code> 获取对应下载链接：</p> 
<pre><code class="prism language-bash"><span class="token comment">#srapath获取ERR009357的下载链接</span>
$ srapath ERR009357
https://sra-downloadb.be-md.ncbi.nlm.nih.gov/sos1/sra-pub-run-5/ERR009357/ERR009357.4

<span class="token comment">#wget下载</span>
$ <span class="token function">wget</span> https://sra-downloadb.be-md.ncbi.nlm.nih.gov/sos1/sra-pub-run-5/ERR009357/ERR009357.4

<span class="token comment">#curl 下载</span>
$ <span class="token function">curl</span> https://sra-downloadb.be-md.ncbi.nlm.nih.gov/sos1/sra-pub-run-5/ERR009357/ERR009357.4
</code></pre> 
<h4><a id="3_SRAfastq_86"></a>3. SRA数据转化为fastq文件</h4> 
<p>下载完 sra 文件，我们往往需要先将 sra 的文件转化为 fastq 文件才能用于后续分析。此处也是使用前面安装的 <strong>SRA-Toolkit</strong> 中的fastq-dump工具。<br> 一行命令即可解决：</p> 
<pre><code class="prism language-bash"><span class="token comment">#SE数据</span>
fastq-dump SRR15671203 -O ./ 

<span class="token comment">#PE数据</span>
fastq-dump ERR009357.4 --split-3 -O ./
</code></pre> 
<p>参考链接：<br> https://www.ncbi.nlm.nih.gov/sra/docs/submitmeta/<br> https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=toolkit_doc</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0852c8880252078f5582653214aef1a6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">设计模式，看这一篇就够了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5b949b5221753bc1283297675779f7c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">stm32f1串口发送与接收</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>