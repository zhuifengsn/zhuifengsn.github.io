<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Pandas入门知识学习 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Pandas入门知识学习" />
<meta property="og:description" content="目录 Pandas基础知识学习一、数据处理对象Pandas中的数据结构SeriesDataFrame 二、读取CSV格式数据读取CSV查看前n行查看后n行修改列名 三、排序操作对索引进行排序按行排序按值排序 四、删除操作五、基本的算术运算算术运算（&#43;，-，*，/） 六、去重操作duplicated()drop_duplicates() 七、层次化索引层次化索引索引方式内层选取数据重塑 Pandas基础知识学习 Pandas比较适合处理结构化的数据，如序列数据，表格数据等，例如csv文件，利用pandas可以快速的对数据进行复杂的转换过滤等操作。
本文为机器学习课程笔记，记录了一些基础操作。
一、数据处理对象 Pandas中的数据结构 Series: 一维数组，类似于Python中的基本数据结构list，区别是Series只允许存储相同的数据类型，这样可以更有效的使用内存，提高运算效率。就像数据库中的列数据；DataFrame: 二维的表格型数据结构。很多功能与R中的data.frame类似。可以将DataFrame理解为Series的容器；Panel：三维的数组，可以理解为DataFrame的容器。 Series Series是一个一维的类似的数组对象，包含一个数组的数据（任何NumPy的数据类型）和一个与数组关联的数据标签，被叫做索引 。简而言之就是类似于带有索引的数组，举例如下：
from pandas import Series,DataFrame obj = Series([4, 7, -5, 3]) obj2 = Series([4, 7, -5, 3], index=[&#39;d&#39;, &#39;b&#39;, &#39;a&#39;, &#39;c&#39;]) print(obj) print(obj2) &#39;&#39;&#39; 0 4 1 7 2 -5 3 3 dtype: int64 d 4 b 7 a -5 c 3 dtype: int64 &#39;&#39;&#39; 如果你有一些数据在一个Python字典中，你可以通过传递字典来从这些数据创建一个Series，只传递一个字典的时候，结果Series中的索引将是排序后的字典的键。
sdata={&#39;Ohio&#39;:35000,&#39;Texas&#39;:71000,&#39;Oregon&#39;:16000,&#39;Utah&#39;:5000} obj3=Series(sdata) print(obj3) &#39;&#39;&#39; Ohio 35000 Texas 71000 Oregon 16000 Utah 5000 dtype: int64 &#39;&#39;&#39; DataFrame DataFrame是一个表格型的数据结构，是以一个或多个二维块存放的数据表格（层次化索引），DataFrame既有行索引还有列索引，它有一组有序的列，每列既可以是不同类型（数值、字符串、布尔型）的数据，或者可以看做由Series组成的字典。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/34c8325ac7d06c35b7da0f9f966cde7a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-16T23:02:30+08:00" />
<meta property="article:modified_time" content="2022-03-16T23:02:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Pandas入门知识学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#Pandas_1" rel="nofollow">Pandas基础知识学习</a></li><li><ul><li><a href="#_5" rel="nofollow">一、数据处理对象</a></li><li><ul><li><a href="#Pandas_7" rel="nofollow">Pandas中的数据结构</a></li><li><a href="#Series_13" rel="nofollow">Series</a></li><li><a href="#DataFrame_55" rel="nofollow">DataFrame</a></li></ul> 
   </li><li><a href="#CSV_106" rel="nofollow">二、读取CSV格式数据</a></li><li><ul><li><a href="#CSV_110" rel="nofollow">读取CSV</a></li><li><a href="#n_117" rel="nofollow">查看前n行</a></li><li><a href="#n_123" rel="nofollow">查看后n行</a></li><li><a href="#_129" rel="nofollow">修改列名</a></li></ul> 
   </li><li><a href="#_135" rel="nofollow">三、排序操作</a></li><li><ul><li><a href="#_137" rel="nofollow">对索引进行排序</a></li><li><a href="#_169" rel="nofollow">按行排序</a></li><li><a href="#_180" rel="nofollow">按值排序</a></li></ul> 
   </li><li><a href="#_208" rel="nofollow">四、删除操作</a></li><li><a href="#_247" rel="nofollow">五、基本的算术运算</a></li><li><ul><li><a href="#_249" rel="nofollow">算术运算（+，-，*，/）</a></li></ul> 
   </li><li><a href="#_280" rel="nofollow">六、去重操作</a></li><li><ul><li><a href="#duplicated_282" rel="nofollow">duplicated()</a></li><li><a href="#drop_duplicates_309" rel="nofollow">drop_duplicates()</a></li></ul> 
   </li><li><a href="#_321" rel="nofollow">七、层次化索引</a></li><li><ul><li><a href="#_323" rel="nofollow">层次化索引</a></li><li><a href="#_345" rel="nofollow">索引方式</a></li><li><a href="#_359" rel="nofollow">内层选取</a></li><li><a href="#_371" rel="nofollow">数据重塑</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="Pandas_1"></a>Pandas基础知识学习</h2> 
<p>Pandas比较适合处理结构化的数据，如序列数据，表格数据等，例如csv文件，利用pandas可以快速的对数据进行复杂的转换过滤等操作。<br> 本文为机器学习课程笔记，记录了一些基础操作。</p> 
<h3><a id="_5"></a>一、数据处理对象</h3> 
<h4><a id="Pandas_7"></a>Pandas中的数据结构</h4> 
<ul><li><code>Series</code>: 一维数组，类似于<code>Python</code>中的基本数据结构<code>list</code>，区别是<code>Series</code>只允许存储相同的数据类型，这样可以更有效的使用内存，提高运算效率。就像数据库中的列数据；</li><li><code>DataFrame</code>: 二维的表格型数据结构。很多功能与<code>R</code>中的<code>data.frame</code>类似。可以将<code>DataFrame</code>理解为<code>Series</code>的容器；</li><li><code>Panel</code>：三维的数组，可以理解为<code>DataFrame</code>的容器。</li></ul> 
<h4><a id="Series_13"></a>Series</h4> 
<p><code>Series</code>是一个一维的类似的数组对象，包含一个数组的数据（任何<code>NumPy</code>的数据类型）和一个与数组关联的数据标签，被叫做索引 。简而言之就是类似于带有索引的数组，举例如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame

obj <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
obj2 <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
0    4
1    7
2   -5
3    3

dtype: int64
d    4
b    7
a   -5
c    3
dtype: int64
'''</span>
</code></pre> 
<p>如果你有一些数据在一个<code>Python</code>字典中，你可以通过传递字典来从这些数据创建一个<code>Series</code>，只传递一个字典的时候，结果<code>Series</code>中的索引将是排序后的字典的键。</p> 
<pre><code class="prism language-python">sdata<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'Ohio'</span><span class="token punctuation">:</span><span class="token number">35000</span><span class="token punctuation">,</span><span class="token string">'Texas'</span><span class="token punctuation">:</span><span class="token number">71000</span><span class="token punctuation">,</span><span class="token string">'Oregon'</span><span class="token punctuation">:</span><span class="token number">16000</span><span class="token punctuation">,</span><span class="token string">'Utah'</span><span class="token punctuation">:</span><span class="token number">5000</span><span class="token punctuation">}</span>
obj3<span class="token operator">=</span>Series<span class="token punctuation">(</span>sdata<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>obj3<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
Ohio      35000
Texas     71000
Oregon    16000
Utah       5000
dtype: int64
'''</span>
</code></pre> 
<h4><a id="DataFrame_55"></a>DataFrame</h4> 
<p><code>DataFrame</code>是一个表格型的数据结构，是以一个或多个二维块存放的数据表格（层次化索引），<code>DataFrame</code>既有行索引还有列索引，它有一组有序的列，每列既可以是不同类型（数值、字符串、布尔型）的数据，或者可以看做由<code>Series</code>组成的字典。</p> 
<p><strong>DataFrame创建:</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame

dictionary <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'state'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'0hio'</span><span class="token punctuation">,</span> <span class="token string">'0hio'</span><span class="token punctuation">,</span> <span class="token string">'0hio'</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">,</span> <span class="token string">'Nevada'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token string">'year'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token string">'pop'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1.7</span><span class="token punctuation">,</span> <span class="token number">3.6</span><span class="token punctuation">,</span> <span class="token number">2.4</span><span class="token punctuation">,</span> <span class="token number">2.9</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
frame <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>dictionary<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''    state  year  pop
0    0hio  2000  1.5
1    0hio  2001  1.7
2    0hio  2002  3.6
3  Nevada  2001  2.4
4  Nevada  2002  2.9 '''</span>
</code></pre> 
<p><strong>修改行名：</strong></p> 
<pre><code class="prism language-python">frame <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>dictionary<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>添加修改：</strong></p> 
<pre><code class="prism language-python">frame<span class="token punctuation">[</span><span class="token string">'add'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> 
<p><strong>添加Series类型：</strong></p> 
<pre><code class="prism language-python">value <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
frame<span class="token punctuation">[</span><span class="token string">'add1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> value
</code></pre> 
<pre><code>#输出
		state  year  pop  add  add1
one      0hio  2000  1.5    0   NaN
two      0hio  2001  1.7    0   NaN
three    0hio  2002  3.6    0   NaN
four   Nevada  2001  2.4    0   NaN
five   Nevada  2002  2.9    0   NaN
</code></pre> 
<h3><a id="CSV_106"></a>二、读取CSV格式数据</h3> 
<p>此部分仅介绍简单的用法</p> 
<h4><a id="CSV_110"></a>读取CSV</h4> 
<pre><code class="prism language-python"><span class="token comment"># 如果数据集中有中文的话，最好在里面加上 encoding = 'gbk' ，以避免乱码问题。</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'文件名'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="n_117"></a>查看前n行</h4> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="n_123"></a>查看后n行</h4> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> 
</code></pre> 
<h4><a id="_129"></a>修改列名</h4> 
<pre><code class="prism language-python">df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">]</span>  
</code></pre> 
<h3><a id="_135"></a>三、排序操作</h3> 
<h4><a id="_137"></a>对索引进行排序</h4> 
<p><code>Series</code>用<code>sort_index()</code>按索引排序，<code>sort_values()</code>按值排序；<br> <code>DataFrame</code>也是用<code>sort_index()</code>和<code>sort_values()</code>。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

obj <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""a    1
b    2
c    3
d    0
dtype: int64"""</span>

frame <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'one'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''       
	   d  a  b  c
three  0  1  2  3
one    4  5  6  7
'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
	   d  a  b  c
one    4  5  6  7
three  0  1  2  3
'''</span>
</code></pre> 
<h4><a id="_169"></a>按行排序</h4> 
<pre><code class="prism language-python">pyprint<span class="token punctuation">(</span>frame<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">''' 
       d  c  b  a
three  0  3  2  1
one    4  7  6  5
'''</span>
</code></pre> 
<h4><a id="_180"></a>按值排序</h4> 
<p><code>Series</code>:</p> 
<pre><code class="prism language-python">obj <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''2   -3
3    2
0    4
1    7
dtype: int64'''</span>
</code></pre> 
<p><code>DataFrame</code>:</p> 
<pre><code class="prism language-python">frame <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>frame<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">#DataFrame必须传一个by参数表示要排序的列</span>
<span class="token triple-quoted-string string">'''
   b  a
2 -3  0
3  2  1
0  4  0
1  7  1
'''</span>
</code></pre> 
<h3><a id="_208"></a>四、删除操作</h3> 
<p>需要注意的是<code>drop()</code>返回的是一个新对象，原对象不会被改变。</p> 
<p>删除<code>Series</code>的一个元素：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

ser <span class="token operator">=</span> Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4.5</span><span class="token punctuation">,</span><span class="token number">7.2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">5.3</span><span class="token punctuation">,</span><span class="token number">3.6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
d    4.5
b    7.2
a   -5.3
dtype: float64'''</span>
</code></pre> 
<p>删除<code>DataFrame</code>的行或列：</p> 
<pre><code class="prism language-python">df <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">,</span><span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'oh'</span><span class="token punctuation">,</span><span class="token string">'te'</span><span class="token punctuation">,</span><span class="token string">'ca'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''oh  te  ca
a   0   1   2
c   3   4   5
d   6   7   8'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''oh  te  ca
c   3   4   5
d   6   7   8'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'oh'</span><span class="token punctuation">,</span><span class="token string">'te'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''ca
a   2
c   5
d   8'''</span>
</code></pre> 
<h3><a id="_247"></a>五、基本的算术运算</h3> 
<h4><a id="_249"></a>算术运算（+，-，*，/）</h4> 
<p><code>DataFrame</code>中的算术运算是<code>df</code>中对应位置的元素的算术运算，如果没有共同的元素，则用<code>NaN</code>代替。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

df1 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abcd'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abcde'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token operator">+</span>df2<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">''' a     b     c     d   e
0   0.0   2.0   4.0   6.0 NaN
1   9.0  11.0  13.0  15.0 NaN
2  18.0  20.0  22.0  24.0 NaN
3   NaN   NaN   NaN   NaN NaN
'''</span>
</code></pre> 
<p>如果我们想设置默认的其他填充值，而非<code>NaN</code>的话，可以传入填充值。</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">''' a     b     c     d     e
0   0.0   2.0   4.0   6.0   4.0
1   9.0  11.0  13.0  15.0   9.0
2  18.0  20.0  22.0  24.0  14.0
3  15.0  16.0  17.0  18.0  19.0
'''</span>
</code></pre> 
<h3><a id="_280"></a>六、去重操作</h3> 
<h4><a id="duplicated_282"></a>duplicated()</h4> 
<p><code>DataFrame</code>的<code>duplicated</code>方法返回一个布尔型<code>Series</code>，表示各行是否是重复行。具体用法如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

df <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token string">'two'</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">''' k1  k2
0  one   1
1  one   1
2  one   2
3  two   3
4  two   3
'''</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''0    False
1     True
2    False
3    False
4     True
dtype: bool
'''</span>
</code></pre> 
<h4><a id="drop_duplicates_309"></a>drop_duplicates()</h4> 
<p><code>drop_duplicates()</code>用于去除重复的行数，具体用法如下：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">''' k1  k2
0  one   1
2  one   2
3  two   3'''</span>
</code></pre> 
<h3><a id="_321"></a>七、层次化索引</h3> 
<h4><a id="_323"></a>层次化索引</h4> 
<p>层次化索引使我们能在一个轴上拥有多个（两个以上）索引级别。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> Series<span class="token punctuation">,</span>DataFrame
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

data <span class="token operator">=</span> Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'c'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
a  1    0.484934
   2   -1.419830
   3    0.166275
b  1    1.368679
   2    0.229332
   3   -1.121234
c  1   -1.849080
   2   -1.465574
dtype: float64'''</span>
</code></pre> 
<h4><a id="_345"></a>索引方式</h4> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
b  1    1.368679
   2    0.229332
   3   -1.121234
c  1   -1.849080
   2   -1.465574
dtype: float64
'''</span>
</code></pre> 
<h4><a id="_359"></a>内层选取</h4> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
a   -1.419830
b    0.229332
c   -1.465574
dtype: float64
'''</span>
</code></pre> 
<h4><a id="_371"></a>数据重塑</h4> 
<p>将<code>Series</code>转化成<code>DataFrame</code>:</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''  1         2         3
a  1.413489 -1.967354  1.853173
b -0.847036 -1.874832  0.046083
c  1.319329 -0.594135       NaN
'''</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dae38bcbf91b94da9d750a27d74e69d2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java 树形结构的工具类</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f5acb2e80e2fc76c2afc78b31e9ba58f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">GATK-HaplotypeCaller 变异检测详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>