<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>利用pandas实现SQL操作 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="利用pandas实现SQL操作" />
<meta property="og:description" content="在SQL中常见的操作主要是增、删、改、查几个动作，那么pandas能否实现对数据的这几项操作呢？答案是Of Course!
增：添加新行或增加新列
dic = {&#39;Name&#39;:[&#39;LiuShunxiang&#39;,&#39;Zhangshan&#39;],&#39;Sex&#39;:[&#39;M&#39;,&#39;F&#39;],&#39;Age&#39;:[27,23],&#39;Height&#39;:[165.7,167.2],&#39;Weight&#39;:[61,63]} student2 = pd.DataFrame(dic) print(student2) Age Height Name Sex Weight 0 27 165.7 LiuShunxiang M 61 1 23 167.2 Zhangshan F 63 现在将student2中的数据新增到student中，可以通过concat函数实现：
student3 = pd.concat([student,student2]) print(student3) Age Height Name Sex Weight 0 14 69.0 Alfred M 112.5 1 13 56.5 Alice F 84.0 2 13 65.3 Barbara F 98.0 3 14 62.8 Carol F 102.5 4 14 63.5 Henry M 102.5 5 12 57." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/b625be6e8f3fc4a63b9b1aa5dafdc895/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-11-29T10:45:53+08:00" />
<meta property="article:modified_time" content="2019-11-29T10:45:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">利用pandas实现SQL操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>在SQL中常见的操作主要是增、删、改、查几个动作，那么pandas能否实现对数据的这几项操作呢？答案是Of Course!</p> 
<p>增：添加新行或增加新列</p> 
<pre><code class="prism language-python">dic <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'LiuShunxiang'</span><span class="token punctuation">,</span><span class="token string">'Zhangshan'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Sex'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'M'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Age'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">165.7</span><span class="token punctuation">,</span><span class="token number">167.2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Weight'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
student2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>student2<span class="token punctuation">)</span>
   Age  Height          Name Sex  Weight
<span class="token number">0</span>   <span class="token number">27</span>   <span class="token number">165.7</span>  LiuShunxiang   M      <span class="token number">61</span>
<span class="token number">1</span>   <span class="token number">23</span>   <span class="token number">167.2</span>     Zhangshan   F      <span class="token number">63</span>
</code></pre> 
<p>现在将student2中的数据新增到student中，可以通过concat函数实现：</p> 
<pre><code class="prism language-python">student3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>student<span class="token punctuation">,</span>student2<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>student3<span class="token punctuation">)</span>
    Age  Height          Name Sex  Weight
<span class="token number">0</span>    <span class="token number">14</span>    <span class="token number">69.0</span>        Alfred   M   <span class="token number">112.5</span>
<span class="token number">1</span>    <span class="token number">13</span>    <span class="token number">56.5</span>         Alice   F    <span class="token number">84.0</span>
<span class="token number">2</span>    <span class="token number">13</span>    <span class="token number">65.3</span>       Barbara   F    <span class="token number">98.0</span>
<span class="token number">3</span>    <span class="token number">14</span>    <span class="token number">62.8</span>         Carol   F   <span class="token number">102.5</span>
<span class="token number">4</span>    <span class="token number">14</span>    <span class="token number">63.5</span>         Henry   M   <span class="token number">102.5</span>
<span class="token number">5</span>    <span class="token number">12</span>    <span class="token number">57.3</span>         James   M    <span class="token number">83.0</span>
<span class="token number">6</span>    <span class="token number">12</span>    <span class="token number">59.8</span>          Jane   F    <span class="token number">84.5</span>
<span class="token number">7</span>    <span class="token number">15</span>    <span class="token number">62.5</span>         Janet   F   <span class="token number">112.5</span>
<span class="token number">8</span>    <span class="token number">13</span>    <span class="token number">62.5</span>       Jeffrey   M    <span class="token number">84.0</span>
<span class="token number">9</span>    <span class="token number">12</span>    <span class="token number">59.0</span>          John   M    <span class="token number">99.5</span>
<span class="token number">10</span>   <span class="token number">11</span>    <span class="token number">51.3</span>         Joyce   F    <span class="token number">50.5</span>
<span class="token number">11</span>   <span class="token number">14</span>    <span class="token number">64.3</span>          Judy   F    <span class="token number">90.0</span>
<span class="token number">12</span>   <span class="token number">12</span>    <span class="token number">56.3</span>        Louise   F    <span class="token number">77.0</span>
<span class="token number">13</span>   <span class="token number">15</span>    <span class="token number">66.5</span>         Marry   F   <span class="token number">112.0</span>
<span class="token number">14</span>   <span class="token number">16</span>    <span class="token number">72.0</span>        Philip   M   <span class="token number">150.0</span>
<span class="token number">15</span>   <span class="token number">12</span>    <span class="token number">64.8</span>        Robert   M   <span class="token number">128.0</span>
<span class="token number">16</span>   <span class="token number">15</span>    <span class="token number">67.0</span>        Ronald   M   <span class="token number">133.0</span>
<span class="token number">17</span>   <span class="token number">11</span>    <span class="token number">57.5</span>        Thomas   M    <span class="token number">85.0</span>
<span class="token number">18</span>   <span class="token number">15</span>    <span class="token number">66.5</span>        Willam   M   <span class="token number">112.0</span>
<span class="token number">0</span>    <span class="token number">27</span>   <span class="token number">165.7</span>  LiuShunxiang   M    <span class="token number">61.0</span>
<span class="token number">1</span>    <span class="token number">23</span>   <span class="token number">167.2</span>     Zhangshan   F    <span class="token number">63.0</span>
</code></pre> 
<p>注意到了吗？在数据库中union必须要求两张表的列顺序一致，而这里concat函数可以自动对齐两个数据框的变量！</p> 
<p>新增列的话，其实在pandas中就更简单了，例如在student2中新增一列学生成绩：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>student2<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">,</span><span class="token string">'Name'</span><span class="token punctuation">,</span><span class="token string">'Sex'</span><span class="token punctuation">,</span><span class="token string">'Weight'</span><span class="token punctuation">,</span><span class="token string">'Score'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   Age  Height          Name Sex  Weight  Score
<span class="token number">0</span>   <span class="token number">27</span>   <span class="token number">165.7</span>  LiuShunxiang   M      <span class="token number">61</span>    NaN
<span class="token number">1</span>   <span class="token number">23</span>   <span class="token number">167.2</span>     Zhangshan   F      <span class="token number">63</span>    NaN
</code></pre> 
<p>对于新增的列没有赋值，就会出现空NaN的形式。</p> 
<p>删：删除表、观测行或变量列<br> 删除数据框student2,通过del命令实现，该命令可以删除Python的所有对象。</p> 
<pre><code class="prism language-python"><span class="token keyword">del</span> student2 <span class="token comment">#删除数据框student2, 通过del命令可以删除python的所有对象</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>student2<span class="token punctuation">)</span>
</code></pre> 
<p>删除指定的行</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    Age  Height     Name Sex  Weight
<span class="token number">2</span>    <span class="token number">13</span>    <span class="token number">65.3</span>  Barbara   F    <span class="token number">98.0</span>
<span class="token number">4</span>    <span class="token number">14</span>    <span class="token number">63.5</span>    Henry   M   <span class="token number">102.5</span>
<span class="token number">5</span>    <span class="token number">12</span>    <span class="token number">57.3</span>    James   M    <span class="token number">83.0</span>
<span class="token number">7</span>    <span class="token number">15</span>    <span class="token number">62.5</span>    Janet   F   <span class="token number">112.5</span>
<span class="token number">8</span>    <span class="token number">13</span>    <span class="token number">62.5</span>  Jeffrey   M    <span class="token number">84.0</span>
<span class="token number">9</span>    <span class="token number">12</span>    <span class="token number">59.0</span>     John   M    <span class="token number">99.5</span>
<span class="token number">10</span>   <span class="token number">11</span>    <span class="token number">51.3</span>    Joyce   F    <span class="token number">50.5</span>
<span class="token number">11</span>   <span class="token number">14</span>    <span class="token number">64.3</span>     Judy   F    <span class="token number">90.0</span>
<span class="token number">12</span>   <span class="token number">12</span>    <span class="token number">56.3</span>   Louise   F    <span class="token number">77.0</span>
<span class="token number">13</span>   <span class="token number">15</span>    <span class="token number">66.5</span>    Marry   F   <span class="token number">112.0</span>
<span class="token number">14</span>   <span class="token number">16</span>    <span class="token number">72.0</span>   Philip   M   <span class="token number">150.0</span>
<span class="token number">15</span>   <span class="token number">12</span>    <span class="token number">64.8</span>   Robert   M   <span class="token number">128.0</span>
<span class="token number">16</span>   <span class="token number">15</span>    <span class="token number">67.0</span>   Ronald   M   <span class="token number">133.0</span>
<span class="token number">17</span>   <span class="token number">11</span>    <span class="token number">57.5</span>   Thomas   M    <span class="token number">85.0</span>
<span class="token number">18</span>   <span class="token number">15</span>    <span class="token number">66.5</span>   Willam   M   <span class="token number">112.0</span>
</code></pre> 
<p>原数据中的第1,2,4,7行的数据已经被删除了。</p> 
<p>根据布尔索引删除行数据，其实这个删除就是保留删除条件的反面数据，例如删除所有14岁以下的学生：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">[</span>student<span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Age  Height    Name Sex  Weight
<span class="token number">7</span>    <span class="token number">15</span>    <span class="token number">62.5</span>   Janet   F   <span class="token number">112.5</span>
<span class="token number">13</span>   <span class="token number">15</span>    <span class="token number">66.5</span>   Marry   F   <span class="token number">112.0</span>
<span class="token number">14</span>   <span class="token number">16</span>    <span class="token number">72.0</span>  Philip   M   <span class="token number">150.0</span>
<span class="token number">16</span>   <span class="token number">15</span>    <span class="token number">67.0</span>  Ronald   M   <span class="token number">133.0</span>
<span class="token number">18</span>   <span class="token number">15</span>    <span class="token number">66.5</span>  Willam   M   <span class="token number">112.0</span>
</code></pre> 
<p>删除指定的列</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Height'</span><span class="token punctuation">,</span><span class="token string">'Weight'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   Age     Name Sex
<span class="token number">0</span>   <span class="token number">14</span>   Alfred   M
<span class="token number">1</span>   <span class="token number">13</span>    Alice   F
<span class="token number">2</span>   <span class="token number">13</span>  Barbara   F
<span class="token number">3</span>   <span class="token number">14</span>    Carol   F
<span class="token number">4</span>   <span class="token number">14</span>    Henry   M
</code></pre> 
<p>我们发现，不论是删除行还是删除列，都可以通过drop方法实现，只需要设定好删除的轴即可，即调整drop方法中的axis参数。默认该参数为0，表示删除行观测，如果需要删除列变量，则需设置为1。</p> 
<p>改：修改原始记录的值<br> 如果发现表中的某些数据错误了，如何更改原来的值呢？我们试试结合布尔索引和赋值的方法： 例如发现student3中姓名为LiuShunxiang的学生身高错了，应该是173，如何改呢？</p> 
<pre><code class="prism language-python">student3<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>student3<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'LiuShunxiang'</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">173</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>student3<span class="token punctuation">[</span>student3<span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'LiuShunxiang'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
           Name  Height
<span class="token number">0</span>  LiuShunxiang   <span class="token number">173.0</span>
</code></pre> 
<p>这样就可以把原来的身高修改为现在的170了。 看，关于索引的操作非常灵活、方便吧，就这样轻松搞定数据的更改。</p> 
<p>查：有关数据查询部分，上面已经介绍过<br> 下面重点讲讲聚合、排序和多表连接操作。</p> 
<p>聚合：pandas模块中可以通过groupby()函数实现数据的聚合操作<br> 根据性别分组，计算各组别中学生身高和体重的平均值：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Sex'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
           Age     Height      Weight
Sex                                  
F    <span class="token number">13.222222</span>  <span class="token number">60.588889</span>   <span class="token number">90.111111</span>
M    <span class="token number">13.400000</span>  <span class="token number">63.910000</span>  <span class="token number">108.950000</span>
</code></pre> 
<p>如果不对原始数据作限制的话，聚合函数会自动选择数值型数据进行聚合计算。如果不想对年龄计算平均值的话，就需要剔除改变量：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Sex'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Height      Weight
Sex                       
F    <span class="token number">60.588889</span>   <span class="token number">90.111111</span>
M    <span class="token number">63.910000</span>  <span class="token number">108.950000</span>
</code></pre> 
<p>groupby还可以使用多个分组变量，例如根本年龄和性别分组，计算身高与体重的平均值：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">,</span><span class="token string">'Age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Height  Weight
Sex Age                   
F   <span class="token number">11</span>   <span class="token number">51.300000</span>   <span class="token number">50.50</span>
    <span class="token number">12</span>   <span class="token number">58.050000</span>   <span class="token number">80.75</span>
    <span class="token number">13</span>   <span class="token number">60.900000</span>   <span class="token number">91.00</span>
    <span class="token number">14</span>   <span class="token number">63.550000</span>   <span class="token number">96.25</span>
    <span class="token number">15</span>   <span class="token number">64.500000</span>  <span class="token number">112.25</span>
M   <span class="token number">11</span>   <span class="token number">57.500000</span>   <span class="token number">85.00</span>
    <span class="token number">12</span>   <span class="token number">60.366667</span>  <span class="token number">103.50</span>
    <span class="token number">13</span>   <span class="token number">62.500000</span>   <span class="token number">84.00</span>
    <span class="token number">14</span>   <span class="token number">66.250000</span>  <span class="token number">107.50</span>
    <span class="token number">15</span>   <span class="token number">66.750000</span>  <span class="token number">122.50</span>
    <span class="token number">16</span>   <span class="token number">72.000000</span>  <span class="token number">150.00</span>
</code></pre> 
<p>当然，还可以对每个分组计算多个统计量：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Sex'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span>np<span class="token punctuation">.</span>median<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        Height             Weight        
          mean median        mean  median
Sex                                      
F    <span class="token number">60.588889</span>  <span class="token number">62.50</span>   <span class="token number">90.111111</span>   <span class="token number">90.00</span>
M    <span class="token number">63.910000</span>  <span class="token number">64.15</span>  <span class="token number">108.950000</span>  <span class="token number">107.25</span>
</code></pre> 
<p>排序：<br> 排序在日常的统计分析中还是比较常见的操作，我们可以使用sort_index和sort_values实现序列和数据框的排序工作：</p> 
<pre><code class="prism language-python">Data <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Data<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Data<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">0</span>    <span class="token number">18</span>
<span class="token number">1</span>    <span class="token number">15</span>
<span class="token number">2</span>    <span class="token number">16</span>
<span class="token number">3</span>    <span class="token number">18</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">5</span>     <span class="token number">8</span>
<span class="token number">6</span>    <span class="token number">17</span>
<span class="token number">7</span>    <span class="token number">10</span>
<span class="token number">8</span>    <span class="token number">16</span>
<span class="token number">9</span>     <span class="token number">6</span>
dtype<span class="token punctuation">:</span> int64
<span class="token number">0</span>    <span class="token number">18</span>
<span class="token number">1</span>    <span class="token number">15</span>
<span class="token number">2</span>    <span class="token number">16</span>
<span class="token number">3</span>    <span class="token number">18</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">5</span>     <span class="token number">8</span>
<span class="token number">6</span>    <span class="token number">17</span>
<span class="token number">7</span>    <span class="token number">10</span>
<span class="token number">8</span>    <span class="token number">16</span>
<span class="token number">9</span>     <span class="token number">6</span>
dtype<span class="token punctuation">:</span> int64
<span class="token number">3</span>    <span class="token number">18</span>
<span class="token number">0</span>    <span class="token number">18</span>
<span class="token number">6</span>    <span class="token number">17</span>
<span class="token number">8</span>    <span class="token number">16</span>
<span class="token number">4</span>    <span class="token number">16</span>
<span class="token number">2</span>    <span class="token number">16</span>
<span class="token number">1</span>    <span class="token number">15</span>
<span class="token number">7</span>    <span class="token number">10</span>
<span class="token number">5</span>     <span class="token number">8</span>
<span class="token number">9</span>     <span class="token number">6</span>
dtype<span class="token punctuation">:</span> int64
</code></pre> 
<p>在数据框中一般都是按值排序，<br> 例如：</p> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Age'</span><span class="token punctuation">,</span><span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    Age  Height     Name Sex  Weight
<span class="token number">10</span>   <span class="token number">11</span>    <span class="token number">51.3</span>    Joyce   F    <span class="token number">50.5</span>
<span class="token number">17</span>   <span class="token number">11</span>    <span class="token number">57.5</span>   Thomas   M    <span class="token number">85.0</span>
<span class="token number">12</span>   <span class="token number">12</span>    <span class="token number">56.3</span>   Louise   F    <span class="token number">77.0</span>
<span class="token number">5</span>    <span class="token number">12</span>    <span class="token number">57.3</span>    James   M    <span class="token number">83.0</span>
<span class="token number">9</span>    <span class="token number">12</span>    <span class="token number">59.0</span>     John   M    <span class="token number">99.5</span>
<span class="token number">6</span>    <span class="token number">12</span>    <span class="token number">59.8</span>     Jane   F    <span class="token number">84.5</span>
<span class="token number">15</span>   <span class="token number">12</span>    <span class="token number">64.8</span>   Robert   M   <span class="token number">128.0</span>
<span class="token number">1</span>    <span class="token number">13</span>    <span class="token number">56.5</span>    Alice   F    <span class="token number">84.0</span>
<span class="token number">8</span>    <span class="token number">13</span>    <span class="token number">62.5</span>  Jeffrey   M    <span class="token number">84.0</span>
<span class="token number">2</span>    <span class="token number">13</span>    <span class="token number">65.3</span>  Barbara   F    <span class="token number">98.0</span>
<span class="token number">3</span>    <span class="token number">14</span>    <span class="token number">62.8</span>    Carol   F   <span class="token number">102.5</span>
<span class="token number">4</span>    <span class="token number">14</span>    <span class="token number">63.5</span>    Henry   M   <span class="token number">102.5</span>
<span class="token number">11</span>   <span class="token number">14</span>    <span class="token number">64.3</span>     Judy   F    <span class="token number">90.0</span>
<span class="token number">0</span>    <span class="token number">14</span>    <span class="token number">69.0</span>   Alfred   M   <span class="token number">112.5</span>
<span class="token number">7</span>    <span class="token number">15</span>    <span class="token number">62.5</span>    Janet   F   <span class="token number">112.5</span>
<span class="token number">13</span>   <span class="token number">15</span>    <span class="token number">66.5</span>    Marry   F   <span class="token number">112.0</span>
<span class="token number">18</span>   <span class="token number">15</span>    <span class="token number">66.5</span>   Willam   M   <span class="token number">112.0</span>
<span class="token number">16</span>   <span class="token number">15</span>    <span class="token number">67.0</span>   Ronald   M   <span class="token number">133.0</span>
<span class="token number">14</span>   <span class="token number">16</span>    <span class="token number">72.0</span>   Philip   M   <span class="token number">150.0</span>
</code></pre> 
<p>多表连接:<br> 多表之间的连接也是非常常见的数据库操作，连接分内连接和外连接，在数据库语言中通过join关键字实现，pandas我比较建议使用merger函数实现数据的各种连接操作。 如下是构造一张学生的成绩表：</p> 
<pre><code class="prism language-python">dic2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'Name'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'Alfred'</span><span class="token punctuation">,</span><span class="token string">'Alice'</span><span class="token punctuation">,</span><span class="token string">'Barbara'</span><span class="token punctuation">,</span><span class="token string">'Carol'</span><span class="token punctuation">,</span><span class="token string">'Henry'</span><span class="token punctuation">,</span><span class="token string">'Jeffrey'</span><span class="token punctuation">,</span><span class="token string">'Judy'</span><span class="token punctuation">,</span><span class="token string">'Philip'</span><span class="token punctuation">,</span><span class="token string">'Robert'</span><span class="token punctuation">,</span><span class="token string">'Willam'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Score'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">,</span><span class="token number">76</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">,</span><span class="token number">90</span><span class="token punctuation">,</span><span class="token number">92</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">73</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
score <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>dic2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>
      Name  Score
<span class="token number">0</span>   Alfred     <span class="token number">88</span>
<span class="token number">1</span>    Alice     <span class="token number">76</span>
<span class="token number">2</span>  Barbara     <span class="token number">89</span>
<span class="token number">3</span>    Carol     <span class="token number">67</span>
<span class="token number">4</span>    Henry     <span class="token number">79</span>
<span class="token number">5</span>  Jeffrey     <span class="token number">90</span>
<span class="token number">6</span>     Judy     <span class="token number">92</span>
<span class="token number">7</span>   Philip     <span class="token number">86</span>
<span class="token number">8</span>   Robert     <span class="token number">73</span>
<span class="token number">9</span>   Willam     <span class="token number">77</span>
</code></pre> 
<p>现在想把学生表student与学生成绩表score做一个关联，该如何操作呢？</p> 
<pre><code class="prism language-python">stu_score1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>student<span class="token punctuation">,</span> score<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>stu_score1<span class="token punctuation">)</span>
   Age  Height     Name Sex  Weight  Score
<span class="token number">0</span>   <span class="token number">14</span>    <span class="token number">69.0</span>   Alfred   M   <span class="token number">112.5</span>     <span class="token number">88</span>
<span class="token number">1</span>   <span class="token number">13</span>    <span class="token number">56.5</span>    Alice   F    <span class="token number">84.0</span>     <span class="token number">76</span>
<span class="token number">2</span>   <span class="token number">13</span>    <span class="token number">65.3</span>  Barbara   F    <span class="token number">98.0</span>     <span class="token number">89</span>
<span class="token number">3</span>   <span class="token number">14</span>    <span class="token number">62.8</span>    Carol   F   <span class="token number">102.5</span>     <span class="token number">67</span>
<span class="token number">4</span>   <span class="token number">14</span>    <span class="token number">63.5</span>    Henry   M   <span class="token number">102.5</span>     <span class="token number">79</span>
<span class="token number">5</span>   <span class="token number">13</span>    <span class="token number">62.5</span>  Jeffrey   M    <span class="token number">84.0</span>     <span class="token number">90</span>
<span class="token number">6</span>   <span class="token number">14</span>    <span class="token number">64.3</span>     Judy   F    <span class="token number">90.0</span>     <span class="token number">92</span>
<span class="token number">7</span>   <span class="token number">16</span>    <span class="token number">72.0</span>   Philip   M   <span class="token number">150.0</span>     <span class="token number">86</span>
<span class="token number">8</span>   <span class="token number">12</span>    <span class="token number">64.8</span>   Robert   M   <span class="token number">128.0</span>     <span class="token number">73</span>
<span class="token number">9</span>   <span class="token number">15</span>    <span class="token number">66.5</span>   Willam   M   <span class="token number">112.0</span>     <span class="token number">77</span>
</code></pre> 
<p>注意，默认情况下，merge函数实现的是两个表之间的内连接，即返回两张表中共同部分的数据。可以通过how参数设置连接的方式，left为左连接；right为右连接；outer为外连接。</p> 
<pre><code class="prism language-python">stu_score2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>student<span class="token punctuation">,</span> score<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>stu_score2<span class="token punctuation">)</span>
    Age  Height     Name Sex  Weight  Score
<span class="token number">0</span>    <span class="token number">14</span>    <span class="token number">69.0</span>   Alfred   M   <span class="token number">112.5</span>   <span class="token number">88.0</span>
<span class="token number">1</span>    <span class="token number">13</span>    <span class="token number">56.5</span>    Alice   F    <span class="token number">84.0</span>   <span class="token number">76.0</span>
<span class="token number">2</span>    <span class="token number">13</span>    <span class="token number">65.3</span>  Barbara   F    <span class="token number">98.0</span>   <span class="token number">89.0</span>
<span class="token number">3</span>    <span class="token number">14</span>    <span class="token number">62.8</span>    Carol   F   <span class="token number">102.5</span>   <span class="token number">67.0</span>
<span class="token number">4</span>    <span class="token number">14</span>    <span class="token number">63.5</span>    Henry   M   <span class="token number">102.5</span>   <span class="token number">79.0</span>
<span class="token number">5</span>    <span class="token number">12</span>    <span class="token number">57.3</span>    James   M    <span class="token number">83.0</span>    NaN
<span class="token number">6</span>    <span class="token number">12</span>    <span class="token number">59.8</span>     Jane   F    <span class="token number">84.5</span>    NaN
<span class="token number">7</span>    <span class="token number">15</span>    <span class="token number">62.5</span>    Janet   F   <span class="token number">112.5</span>    NaN
<span class="token number">8</span>    <span class="token number">13</span>    <span class="token number">62.5</span>  Jeffrey   M    <span class="token number">84.0</span>   <span class="token number">90.0</span>
<span class="token number">9</span>    <span class="token number">12</span>    <span class="token number">59.0</span>     John   M    <span class="token number">99.5</span>    NaN
<span class="token number">10</span>   <span class="token number">11</span>    <span class="token number">51.3</span>    Joyce   F    <span class="token number">50.5</span>    NaN
<span class="token number">11</span>   <span class="token number">14</span>    <span class="token number">64.3</span>     Judy   F    <span class="token number">90.0</span>   <span class="token number">92.0</span>
<span class="token number">12</span>   <span class="token number">12</span>    <span class="token number">56.3</span>   Louise   F    <span class="token number">77.0</span>    NaN
<span class="token number">13</span>   <span class="token number">15</span>    <span class="token number">66.5</span>    Marry   F   <span class="token number">112.0</span>    NaN
<span class="token number">14</span>   <span class="token number">16</span>    <span class="token number">72.0</span>   Philip   M   <span class="token number">150.0</span>   <span class="token number">86.0</span>
<span class="token number">15</span>   <span class="token number">12</span>    <span class="token number">64.8</span>   Robert   M   <span class="token number">128.0</span>   <span class="token number">73.0</span>
<span class="token number">16</span>   <span class="token number">15</span>    <span class="token number">67.0</span>   Ronald   M   <span class="token number">133.0</span>    NaN
<span class="token number">17</span>   <span class="token number">11</span>    <span class="token number">57.5</span>   Thomas   M    <span class="token number">85.0</span>    NaN
<span class="token number">18</span>   <span class="token number">15</span>    <span class="token number">66.5</span>   Willam   M   <span class="token number">112.0</span>   <span class="token number">77.0</span>
</code></pre> 
<p>左连接实现的是保留student表中的所有信息，同时将score表的信息与之配对，能配多少配多少，对于没有配对上的Name，将会显示成绩为NaN。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/41c61dc873ce33a603dcb7cdcfeb16cf/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">python爬虫入门</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/421c18247d13cd954d1d23770bba05f6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Spring MVC 入门总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>