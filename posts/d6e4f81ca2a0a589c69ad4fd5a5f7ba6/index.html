<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>yml eureka defaultzone 只生效第一个_二：教你 SpringBoot&#43;SpringCloud-使用Eureka实现服务注册与发现... - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="yml eureka defaultzone 只生效第一个_二：教你 SpringBoot&#43;SpringCloud-使用Eureka实现服务注册与发现..." />
<meta property="og:description" content="点击上方 &#34;程序员小乐&#34;关注, 星标或置顶一起成长
每天凌晨00点00分, 第一时间与你相约
每日英文
Themorewefind,themorewelose.Themoreweknow,themorewehurt.Themorewecare,themorewearesad.
得到越多，失去越多。懂得越多，伤得越多。在乎越多，难过越多。
每日掏心话
如果你越来越冷漠，你以为你成长了，但其实没有。长大应该是变温柔，对全世界都温柔。
来自：XuePeng77 | 责编：乐乐
链接：my.oschina.net/u/2450666/blog/1162531
程序员小乐(ID:study_tech)第 821 次推文 图片来自百度
往日回顾：微信技术总监：一亿用户背后的架构秘密
正文 手把手教你SpringBoot&#43;SpringCloud系列共8篇：
1、手把手教你 SpringBoot &#43; SpringCloud 开发环境搭建(一)
一、创建Eureka注册中心(Standalone Mode —— 独立模式)
1.1 创建Eureka Server工程
使用STS创建EurekaServer工程。
点击File —— New —— Spring Starter Project后，会弹出创建SpringBoot工程的窗口，输入工程信息后点击下一步。
工程信息可以选择构建工具，这里选择的Maven；
选择Packaging，是Jar包还是War包；
选择Java版本；
选择语言(支持Java、Kotlin和Groovy)；
Group、Artifact、Version和Description为maven的相关属性；
最后一个Package是我们定义的工程主类的包，SpringBoot默认会识别该包和其下的子包；
选择SpringBoot的版本，并搜索eureka，勾选Eureka Server后，点击Finish创建工程。
创建好的工程目录结构如下：
工程会自动为我们创建maven结构的工程，并且创建了OwlBookstoreEurekaServerApplication类和对应的测试类，在resources文件夹下还有一个空白的application.properties属性文件。
1.2 pom文件
为了将工程作为Eureka注册中心，我们在创建工程时引入了Eureka Server包，在pom文件中可以看到：
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;&gt;4.0.0cn.net.bysoft
owl-bookstore-eureka-server1.0-SNAPSHOTjarowl-bookstore-eureka-serverowl-bookstore-eureka-serverorg.springframework.boot
spring-boot-starter-parent1.5.4.RELEASEUTF-8UTF-81.8Dalston.SR1org.springframework.cloud
spring-cloud-starter-eureka-serverorg.springframework.boot
spring-boot-starter-testtestorg.springframework.boot
spring-boot-devtoolstruetrueorg.springframework.cloud
spring-cloud-dependencies${spring-cloud.version}pomimportorg.springframework.boot
spring-boot-maven-pluginorg.springframework.boot
spring-boot-maven-plugintrue
1.3 application文件" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/d6e4f81ca2a0a589c69ad4fd5a5f7ba6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-26T07:54:11+08:00" />
<meta property="article:modified_time" content="2020-11-26T07:54:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">yml eureka defaultzone 只生效第一个_二：教你 SpringBoot&#43;SpringCloud-使用Eureka实现服务注册与发现...</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>点击上方 "程序员小乐"关注, 星标或置顶一起成长</p> 
 <p>每天凌晨00点00分, 第一时间与你相约</p> 
 <p>每日英文</p> 
 <p>Themorewefind,themorewelose.Themoreweknow,themorewehurt.Themorewecare,themorewearesad.</p> 
 <p>得到越多，失去越多。懂得越多，伤得越多。在乎越多，难过越多。</p> 
 <p>每日掏心话</p> 
 <p>如果你越来越冷漠，你以为你成长了，但其实没有。长大应该是变温柔，对全世界都温柔。</p> 
 <p>来自：XuePeng77 | 责编：乐乐</p> 
 <p>链接：my.oschina.net/u/2450666/blog/1162531</p> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/68/3a/RKDorMxD_o.png" alt="b0aa82d4834082c8acb7bc7fadd94b17.png"> 
  </div> 
 </div> 
 <p>程序员小乐(ID:study_tech)第 821 次推文 图片来自百度</p> 
 <p>往日回顾：微信技术总监：一亿用户背后的架构秘密</p> 
 <p> 正文 </p> 
 <p><br>手把手教你SpringBoot+SpringCloud系列共8篇：<br>1、手把手教你 SpringBoot + SpringCloud 开发环境搭建(一)</p> 
 <p>一、创建Eureka注册中心(Standalone Mode —— 独立模式)</p> 
 <p>1.1 创建Eureka Server工程</p> 
 <p>使用STS创建EurekaServer工程。</p> 
 <p>点击File —— New —— Spring Starter Project后，会弹出创建SpringBoot工程的窗口，输入工程信息后点击下一步。</p> 
 <ul class="list-paddingleft-2"><li><p>工程信息可以选择构建工具，这里选择的Maven；</p></li><li><p>选择Packaging，是Jar包还是War包；</p></li><li><p>选择Java版本；</p></li><li><p>选择语言(支持Java、Kotlin和Groovy)；</p></li><li><p>Group、Artifact、Version和Description为maven的相关属性；</p></li><li><p>最后一个Package是我们定义的工程主类的包，SpringBoot默认会识别该包和其下的子包；</p></li></ul> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/aa/33/s5EmS89J_o.png" alt="5a6b7e1647576064a6c33d58a6892803.png"> 
  </div> 
 </div> 
 <p>选择SpringBoot的版本，并搜索eureka，勾选Eureka Server后，点击Finish创建工程。</p> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/33/fc/wcKb5JaJ_o.png" alt="5a4b9abf359e2b9069a248204cc08504.png"> 
  </div> 
 </div> 
 <p>创建好的工程目录结构如下：</p> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/ba/96/s2DFfBz0_o.png" alt="373880748779ef619a629b6ce48a05c6.png"> 
  </div> 
 </div> 
 <p>工程会自动为我们创建maven结构的工程，并且创建了OwlBookstoreEurekaServerApplication类和对应的测试类，在resources文件夹下还有一个空白的application.properties属性文件。</p> 
 <p>1.2 pom文件</p> 
 <p>为了将工程作为Eureka注册中心，我们在创建工程时引入了Eureka Server包，在pom文件中可以看到：</p> 
 <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt; xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;4.0.0cn.net.bysoft<br> owl-bookstore-eureka-server1.0-SNAPSHOTjarowl-bookstore-eureka-serverowl-bookstore-eureka-serverorg.springframework.boot<br> spring-boot-starter-parent1.5.4.RELEASEUTF-8UTF-81.8Dalston.SR1org.springframework.cloud<br> spring-cloud-starter-eureka-serverorg.springframework.boot<br> spring-boot-starter-testtestorg.springframework.boot<br> spring-boot-devtoolstruetrueorg.springframework.cloud<br> spring-cloud-dependencies${spring-cloud.version}pomimportorg.springframework.boot<br> spring-boot-maven-pluginorg.springframework.boot<br> spring-boot-maven-plugintrue</p> 
 <p>1.3 application文件</p> 
 <p>接下来，我们修改配置信息，启动Eureka Server。</p> 
 <p>SpringBoot支持yml格式的配置文件，在resources中创建一个application.yml文件，并编写如下内容：</p> 
 <p>spring:<br> application:<br> name: eureka-server<br>server:<br> port: 8761<br>eureka:<br> instance:<br> hostname: localhost<br> client:<br> registerWithEureka: false<br> fetchRegistry: false<br> serviceUrl:<br> defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/<br>debug: true<br>logging:<br> file: wol-bookstore-eureka-server.log<br> level:<br> root: info</p> 
 <ul class="list-paddingleft-2"><li><p>spring:application:name：给应用定义一个名称；</p></li><li><p>server:port：是应用的端口号；</p></li><li><p>eureka:instance:hostname：是应用所在的主机名；</p></li><li><p>eureka:client:registerWithEureka：用于应用是注册中心，所以不向注册中心注册自己；</p></li><li><p>eureka:client:fetchRegistry：用于应用是注册中心，所以不需要去检索服务；</p></li><li><p>eureka:client:serviceUrl:defaultZone：定义注册中心的地址；</p></li><li><p>debug：打开日志功能；</p></li><li><p>logging:file：日志文件指向当前应用的目录；</p></li><li><p>logging:level:root：输出级别为info；</p></li></ul> 
 <p>1.4 修改主类</p> 
 <p>最后用@EnableEurekaServer修饰主类OwlBookstoreEurekaServerApplication。</p> 
 <p>package cn.net.bysoft.owl.bootstore;<br>import org.springframework.boot.SpringApplication;<br>import org.springframework.boot.autoconfigure.SpringBootApplication;<br>import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;<br>/**<br> * </p> 
 <ul><li><br> * </li><li>使用<em>@EnableEurekaServer</em>来修饰主类；<br> * </li></ul> 
 <br> * 
 <br> * @author xuepeng 
 <br> */ 
 <br>@SpringBootApplication 
 <br>@EnableEurekaServer 
 <br>public class OwlBookstoreEurekaServerApplication { 
 <br> public static void main(String[] args) { 
 <br> SpringApplication.run(OwlBookstoreEurekaServerApplication.class, args); 
 <br> } 
 <br>} 
 <p>1.5 运行注册中心</p> 
 <p>使用SpringBootApp运行程序，程序运行后访问地址http://localhost:8761来进入注册中心。这里需要注意，虽然配置的是http://${eureka.instance.hostname}:${server.port}/eureka/，但是注册中心的地址不带有/eureka。</p> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/c3/4d/b1uctgYx_o.png" alt="7b8cb02f02a65d06177366b0996fa4e2.png"> 
  </div> 
 </div> 
 <p>到此，Eureka注册中心已经运行成功了。</p> 
 <p>二、服务注册</p> 
 <p>2.1 创建service-user工程</p> 
 <p>创建一个服务，命名为owl-bookstore-service-user。</p> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/a0/f8/phl00fnX_o.png" alt="46396d738ea670d947fa183d47255ce4.png"> 
  </div> 
 </div> 
 <p>2.2 pom文件</p> 
 <p>在pom文件中，加入spring-cloud-starter-eureka依赖。</p> 
 <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt; xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;4.0.0cn.net.bysoft<br> owl-bookstore-service-user1.0-SNAPSHOTjarowl-bookstore-service-userowl-bookstore-service-userorg.springframework.boot<br> spring-boot-starter-parent1.5.4.RELEASEUTF-8UTF-81.8Dalston.SR1org.springframework.cloud<br> spring-cloud-starter-eurekaorg.springframework.boot<br> spring-boot-starter-testtestorg.springframework.cloud<br> spring-cloud-dependencies${spring-cloud.version}pomimportorg.springframework.boot<br> spring-boot-maven-plugin</p> 
 <p>2.3 application文件配置</p> 
 <p>eureka:<br> client:<br> serviceUrl:<br> defaultZone: http://localhost:8761/eureka/<br>server:<br> port: 7001<br>spring:<br> application:<br> name: SERVICE-USER</p> 
 <ul class="list-paddingleft-2"><li><p>eureka:client:serviceUrl:defaultZone：设置注册中心的地址；</p></li><li><p>server:port：服务的端口号；</p></li><li><p>spring:application:name：服务的名称，该名称不要和其他的服务重名；</p></li></ul> 
 <p>2.4 编写简单的业务demo</p> 
 <div class="pgc-image pgc-card-fixWidth"> 
  <div class="pgc-img-wrapper ttcore-relative"> 
   <img src="https://images2.imgbox.com/b1/64/Na9ahUrz_o.png" alt="3cd8ab99a67f3c3c0c0da081771fedea.png"> 
  </div> 
 </div> 
 <p>cn.net.bysoft.owl.bookstore.service.user包下存放着主类，使用@EnableDiscoveryClient修饰主类：</p> 
 <p>package cn.net.bysoft.owl.bookstore.service.user;<br>import org.springframework.boot.SpringApplication;<br>import org.springframework.boot.autoconfigure.SpringBootApplication;<br>import org.springframework.cloud.client.discovery.EnableDiscoveryClient;<br>@SpringBootApplication<br>@EnableDiscoveryClient<br>public class OwlBookstoreServiceUserApplication {<!-- --><br> public static void main(String[] args) {<!-- --><br> SpringApplication.run(OwlBookstoreServiceUserApplication.class, args);<br> }<br>}</p> 
 <p>cn.net.bysoft.owl.bookstore.service.user.entity包下存放user服务的实体类：</p> 
 <p>package cn.net.bysoft.owl.bookstore.service.user.entity;<br>public class User {<!-- --><br> private final long id;<br> private final String name;<br> public User(long id, String name) {<!-- --><br> this.id = id;<br> this.name = name;<br> }<br> public long getId() {<!-- --><br> return id;<br> }<br> public String getName() {<!-- --><br> return name;<br> }<br>}</p> 
 <p>cn.net.bysoft.owl.bookstore.service.user.facade包下存放着具体的user服务：</p> 
 <p>package cn.net.bysoft.owl.bookstore.service.user.facade;<br>import java.util.List;<br>import cn.net.bysoft.owl.bookstore.service.user.entity.User;<br>public interface UserService {<!-- --><br> List getAll();<br>}</p> 
 <p>cn.net.bysoft.owl.bookstore.service.user.facade.impl包下存放着服务的实现，用@RestController修饰类，用@RequestMapping修饰方式，@Value用来读取application.yml文件中的server.port的值：</p> 
 <p>package cn.net.bysoft.owl.bookstore.service.user.facade.impl;<br>import java.util.ArrayList;<br>import java.util.List;<br>import org.springframework.beans.factory.annotation.Value;<br>import org.springframework.web.bind.annotation.RequestMapping;<br>import org.springframework.web.bind.annotation.RequestMethod;<br>import org.springframework.web.bind.annotation.RestController;<br>import cn.net.bysoft.owl.bookstore.service.user.entity.User;<br>import cn.net.bysoft.owl.bookstore.service.user.facade.UserService;<br>@RestController<br>public class UserServiceImpl implements UserService {<!-- --><br> @Value("${server.port}")<br> String port;<br> @RequestMapping(value = "users</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5190c41b8904532e51a13b84a4a5bffe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot 整合 Editormd（完整版）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5826a88befec7774b4ade3f8bb0472bc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">期望值（Expect value）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>