<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言程序的编译&#43;链接详解 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C语言程序的编译&#43;链接详解" />
<meta property="og:description" content="文章目录 前言一、引子二、翻译环境三、运行环境总结 前言 同学们在写代码的时候，我们往往要先创建一个源文件比如test.c。写完具体代码并运行后，我们的文件夹中会生成一个test.exe的文件，也就是我们这段代码的可执行程序。那test.c到底是怎样才生成test.exe的呢？这就是我们今天的内容：程序的编译
提示：以下是本篇文章正文内容，下面案例可供参考
一、引子 在ANSIC（标准C）的任何一种实现中，存在两个不同的环境。
第一种是翻译环境，在这个环境中源代码被转换成可执行的机器指令。
第二种是指向环境，它用于实际执行代码
我们把test.c变成test.exe时，会经理一个翻译环境，能运行test.exe的环境，叫运行环境
我们常说的：编译-链接-运行就是分别在翻译环境和运行环境中发生的，比如我们现在写了一个程序要进行2&#43;3的操作，那么这个操作经过上图步骤后就可以得到5
（图片来自比特就业课）
以我们以前写过的通讯录为例：我们写的源文件有test.c和contact.c那这两个源文件分别会经过编译器处理生成一个.obj目标文件。而生成的目标文件，最终会经过链接器处理，将这若干个目标文件和链接库链接，最后生成我们的可执行程序
ps：编译器是编译阶段的工具，链接器是链接阶段的工具,windows环境下目标文件是.obj，Linux环境下目标文件是.0
二、翻译环境 预处理
这里会进行如下操作：
1.头文件的包含，如#include&lt;stdio.h&gt;
2.#define定义的符号替换，如#define min 0
3.把代码中的注释删除 ps：并没有真正删除，而是编译阶段不会看到注释
编译
把C语言代码转化为汇编代码，这里会进行如下操作：
1.语法分析
2.词法分析
3.语义分析
4.符号汇总
汇编
把汇编代码转化称为二进制指令（机器指令），这里会形成符号表。
比如Add.c文件内有函数Add，会把Add函数名和函数所在地址放在符号表里。同理test.c文件里有函数Add和main函数，会把它们的函数名和函数所在地址放在符号表里。
链接
在经过预编译，编译和汇编相关操作后，我们会得到相关文件的目标文件，比如contact.obj和test.obj，那么我们在翻译环境的最后阶段需要做的就是把这些目标文件链接起来。这时会经历2个操作。
1.合并段表
文件在链接阶段会被分成几段进行操作，合并段表就是把相关文件对应的段连接到一起，如下图
2.符号表的合并和重定位
关于符号表合并，也就是将之前汇编部分产生的符号表合并，如下图
三、运行环境 程序执行的过程：
1.程序必须载入内存中，在有操作系统的环境中：一般由操作系统完成。在独立的环境中，程序的载入必须由手工安排，也可能是通过可执行代码置入只读内存来完成
2.程序的执行便开始，接着就调用main函数
3.开始执行程序代码。这个时候程序将使用一个运行时堆栈，存储函数的局部变量和返回地址。程序同时也可以使用静态内存，存储静态内存中的变量在程序的整个执行过程一直保留着他们的值
4.终止程序。正常终止main函数，但也有可能发生意外终止main函数。
总结 本文简单介绍了" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/02c48d98615427239a3d56dbbfb38afd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-18T19:18:26+08:00" />
<meta property="article:modified_time" content="2021-10-18T19:18:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言程序的编译&#43;链接详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_9" rel="nofollow">前言</a></li><li><a href="#_20" rel="nofollow">一、引子</a></li><li><a href="#_37" rel="nofollow">二、翻译环境</a></li><li><a href="#_67" rel="nofollow">三、运行环境</a></li><li><a href="#_75" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_9"></a>前言</h2> 
<p><font color="#999AAA">同学们在写代码的时候，我们往往要先创建一个源文件比如test.c。写完具体代码并运行后，我们的文件夹中会生成一个test.exe的文件，也就是我们这段代码的可执行程序。那test.c到底是怎样才生成test.exe的呢？这就是我们今天的内容：程序的编译</font><br> <img src="https://images2.imgbox.com/6f/2c/IfMlI8TK_o.png" alt="在这里插入图片描述"></p> 
<hr color="#000000" size='1"'> 
<p><font color="#999AAA">提示：以下是本篇文章正文内容，下面案例可供参考</font></p> 
<h2><a id="_20"></a>一、引子</h2> 
<p>在ANSIC（标准C）的任何一种实现中，存在两个不同的环境。<br> <font color="#999AAA">第一种是翻译环境，在这个环境中源代码被转换成可执行的机器指令。<br> 第二种是指向环境，它用于实际执行代码<br> <img src="https://images2.imgbox.com/51/04/LwAZQl0y_o.png" alt="在这里插入图片描述"></font></p> 
<p>我们把test.c变成test.exe时，会经理一个<strong>翻译环境</strong>，能运行test.exe的环境，叫<strong>运行环境</strong><br> <img src="https://images2.imgbox.com/47/dc/yfOfjqjb_o.png" alt="在这里插入图片描述"></p> 
<p>我们常说的：编译-链接-运行就是分别在翻译环境和运行环境中发生的，比如我们现在写了一个程序要进行2+3的操作，那么这个操作经过上图步骤后就可以得到5<br> <img src="https://images2.imgbox.com/d3/ca/Cx9giquN_o.png" alt="在这里插入图片描述"><br> （图片来自比特就业课）<br> 以我们以前写过的通讯录为例：我们写的源文件有test.c和contact.c那这两个<strong>源文件分别会经过编译器处理生成一个.obj目标文件。而生成的目标文件，最终会经过链接器处理，将这若干个目标文件和链接库链接，最后生成我们的可执行程序</strong><br> <img src="https://images2.imgbox.com/92/22/xXf9F1bP_o.png" alt="在这里插入图片描述"><br> ps：编译器是编译阶段的工具，链接器是链接阶段的工具,windows环境下目标文件是.obj，Linux环境下目标文件是.0</p> 
<h2><a id="_37"></a>二、翻译环境</h2> 
<p><strong>预处理</strong><br> 这里会进行如下操作：<br> 1.头文件的包含，如#include&lt;stdio.h&gt;<br> 2.#define定义的符号替换，如#define min 0<br> 3.把代码中的注释删除 ps：并没有真正删除，而是编译阶段不会看到注释</p> 
<p><strong>编译</strong><br> 把C语言代码转化为汇编代码，这里会进行如下操作：<br> 1.语法分析<br> 2.词法分析<br> 3.语义分析<br> 4.符号汇总<br> <strong>汇编</strong><br> 把汇编代码转化称为二进制指令（机器指令），这里会形成符号表。<br> <img src="https://images2.imgbox.com/c7/78/D8Mb7Tdo_o.png" alt="在这里插入图片描述"><br> 比如Add.c文件内有函数Add，会把Add函数名和函数所在地址放在符号表里。同理test.c文件里有函数Add和main函数，会把它们的函数名和函数所在地址放在符号表里。<br> <strong>链接</strong><br> 在经过预编译，编译和汇编相关操作后，我们会得到相关文件的目标文件，比如contact.obj和test.obj，那么我们在翻译环境的最后阶段需要做的就是把这些目标文件链接起来。这时会经历2个操作。<br> 1.合并段表<br> 文件在链接阶段会被分成几段进行操作，合并段表就是把相关文件对应的段连接到一起，如下图<br> <img src="https://images2.imgbox.com/e8/d0/fK5slseO_o.png" alt="在这里插入图片描述"></p> 
<p>2.符号表的合并和重定位<br> 关于符号表合并，也就是将之前汇编部分产生的符号表合并，如下图<br> <img src="https://images2.imgbox.com/7e/a8/KWsuB3J4_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_67"></a>三、运行环境</h2> 
<p>程序执行的过程：<br> 1.程序必须载入内存中，在有操作系统的环境中：一般由操作系统完成。在独立的环境中，程序的载入必须由手工安排，也可能是通过可执行代码置入只读内存来完成<br> 2.程序的执行便开始，接着就调用main函数<br> 3.开始执行程序代码。这个时候程序将使用一个运行时堆栈，存储函数的局部变量和返回地址。程序同时也可以使用静态内存，存储静态内存中的变量在程序的整个执行过程一直保留着他们的值<br> 4.终止程序。正常终止main函数，但也有可能发生意外终止main函数。</p> 
<hr color="#000000" size='1"'> 
<h2><a id="_75"></a>总结</h2> 
<p><font color="#999AAA">本文简单介绍了</font></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/783f9812a30e065672c65288fca8dc3e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring IoC容器以及Bean的创建过程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b5dc9059bbdcd193b02e3e1bc9c70cfd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">简单自动化测试：airTest vs 按键精灵</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>