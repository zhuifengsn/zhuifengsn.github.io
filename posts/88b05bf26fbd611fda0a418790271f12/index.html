<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Eelasticsearch字段数据类型 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Eelasticsearch字段数据类型" />
<meta property="og:description" content="映射的数据类型也就是es支持的数据类型，与Mysql中的数据类相似。但是具体的类型和MYSQL中有所区别，最主要的区别就在于ES中支持分词的数据类型，如：Text类型，可分词类型是用于支持全问检索的，这也是Es的核心的功能
数字类型 long integer short byte double float half_float scaled_float unsigned_long
基本数据类型 binary ：Base64字符串二进制类型boolean:布尔类型alias:字段别名 KeyWords keyWords:适用于索引结构化的字段，可以用于过滤，排序，聚合。KeyWords类型的字段只能通过精确搜索到。如ID，姓名这类字段应使用KeyWordsconstant_keyword:始终包含想通值的关键字字段wildcard：可正对类似grep的 3) Dates（时间类型）：包括date和 date_nanos
​ 4) alias：为现有字段定义别名。
​ 5) binary（二进制）：binary
​ 6) range（区间类型）：integer_range、float_range、long_range、double_range、date_range
​ 7) text：当一个字段是要被全文搜索的，比如Email内容、产品描述，这些字段应该使用text类型。设置text类型以后，字段内容会被分析，在生成倒排索 引以前，字符串会被分析器分成一个一个词项。text类型的字段不用于排序，很少用于聚合。（解释一下为啥不会为text创建正排索引：大量堆空间，尤其是 在加载高基数text字段时。字段数据一旦加载到堆中，就在该段的生命周期内保持在那里。同样，加载字段数据是一个昂贵的过程，可能导致用户遇到延迟问 题。这就是默认情况下禁用字段数据的原因）
​ ② 对象关系类型：
​ 1) object：用于单个JSON对象
​ 2) nested：用于JSON对象数组
​ 3) flattened：允许将整个JSON对象索引为单个字段。
​ ③ 结构化类型：
​ 1) geo-point：纬度/经度积分
​ 2) geo-shape：用于多边形等复杂形状
​ 3) point：笛卡尔坐标点
​ 2) shape：笛卡尔任意几何图形
​ ④ 特殊类型：
​ 1) IP地址：ip 用于IPv4和IPv6地址
​ 2) completion：提供自动完成建议" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/88b05bf26fbd611fda0a418790271f12/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-12T18:24:00+08:00" />
<meta property="article:modified_time" content="2023-11-12T18:24:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Eelasticsearch字段数据类型</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>映射的数据类型也就是es支持的数据类型，与Mysql中的数据类相似。但是具体的类型和MYSQL中有所区别，最主要的区别就在于ES中支持分词的数据类型，如：Text类型，可分词类型是用于支持全问检索的，这也是Es的核心的功能</p> 
<h2><a id="_1"></a>数字类型</h2> 
<p>long integer short byte double float half_float scaled_float unsigned_long</p> 
<h2><a id="_3"></a>基本数据类型</h2> 
<ul><li>binary ：Base64字符串二进制类型</li><li>boolean:布尔类型</li><li>alias:字段别名</li></ul> 
<h2><a id="KeyWords_7"></a>KeyWords</h2> 
<ul><li>keyWords:适用于索引结构化的字段，可以用于过滤，排序，聚合。KeyWords类型的字段只能通过精确搜索到。如ID，姓名这类字段应使用KeyWords</li><li>constant_keyword:始终包含想通值的关键字字段</li><li>wildcard：可正对类似grep的</li></ul> 
<p><strong>3)</strong> <strong>Dates</strong>（时间类型）：包括<a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.10/date.html" rel="nofollow"><code>date</code></a>和 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.10/date_nanos.html" rel="nofollow"><code>date_nanos</code></a></p> 
<p>​ 4) <strong>alias</strong>：为现有字段定义别名。</p> 
<p>​ 5) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/binary.html" rel="nofollow">binary</a>（二进制）：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/binary.html" rel="nofollow">binary</a></p> 
<p>​ 6) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/range.html" rel="nofollow">range</a>（区间类型）：integer_range、float_range、long_range、double_range、date_range<br> ​ 7) <strong>text：当一个字段是要被全文搜索的，比如Email内容、产品描述，这些字段应该使用text类型。设置text类型以后，字段内容会被分析，在生成倒排索 引以前，字符串会被分析器分成一个一个词项。text类型的字段不用于排序，很少用于聚合。（解释一下为啥不会为text创建正排索引：大量堆空间，尤其是 在加载高基数text字段时。字段数据一旦加载到堆中，就在该段的生命周期内保持在那里。同样，加载字段数据是一个昂贵的过程，可能导致用户遇到延迟问 题。这就是默认情况下禁用字段数据的原因）</strong><br> ​ <strong>② 对象关系类型：</strong><br> ​ <strong>1) object：用于单个JSON对象</strong><br> ​ <strong>2) nested：用于JSON对象数组</strong><br> ​ 3) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/flattened.html" rel="nofollow">flattened</a>：允许将整个JSON对象索引为单个字段。</p> 
<p>​ <strong>③ 结构化类型：</strong><br> ​ <strong>1) geo-point：纬度/经度积分</strong><br> ​ <strong>2) geo-shape：用于多边形等复杂形状</strong><br> ​ <strong>3) point：笛卡尔坐标点</strong><br> ​ <strong>2) shape：笛卡尔任意几何图形</strong><br> ​ ④ 特殊类型：<br> ​ <strong>1) IP地址：ip 用于IPv4和IPv6地址</strong><br> ​ <strong>2) <a href="#completion-suggester" rel="nofollow">completion</a>：提供自动完成建议</strong><br> ​ 3) tocken_count：计算字符串中令牌的数量<br> ​ 4) <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.7/mapper-murmur3.html" rel="nofollow">murmur3</a>：在索引时计算值的哈希并将其存储在索引中<br> ​ 5) <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.7/mapper-annotated-text.html" rel="nofollow">annotated-text</a>：索引包含特殊标记的文本（通常用于标识命名实体）<br> ​ 6) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/percolator.html" rel="nofollow">percolator</a>：接受来自query-dsl的查询<br> ​ 7) join：为同一索引内的文档定义父/子关系<br> ​ 8) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/rank-features.html" rel="nofollow">rank features</a>：记录数字功能以提高查询时的点击率。<br> ​ 9) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/dense-vector.html" rel="nofollow">dense vector</a>：记录浮点值的密集向量。<br> ​ 10) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/sparse-vector.html" rel="nofollow">sparse vector</a>：记录浮点值的稀疏向量。<br> ​ 11) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-as-you-type.html" rel="nofollow">search-as-you-type</a>：针对查询优化的文本字段，以实现按需输入的完成<br> ​ 12) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/histogram.html" rel="nofollow">histogram</a>：histogram 用于百分位数聚合的预聚合数值。</p> 
<p>​ 13) <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/constant-keyword.html" rel="nofollow">constant keyword</a>：keyword当所有文档都具有相同值时的情况的 专业化。<br> ​ ⑤ array（数组）：在Elasticsearch中，数组不需要专用的字段数据类型。默认情况下，任何字段都可以包含零个或多个值，但是，数组中的所有值都必须具有 相同的数据类型。<br> ​ ⑥新增：<br> ​ 1) date_nanos：date plus 纳秒<br> ​ 2) features：</p> 
<h4><a id="4%09_49"></a>4 两种映射类型</h4> 
<ul><li> <h5><a id="Dynamic_field_mapping_50"></a>Dynamic field mapping：</h5> 
  <ul><li> <h5><a id="%09%09%09%09_____%09long_51"></a>整数 =&gt; long</h5> </li><li> <h5><a id="%09%09%09_____%09float_52"></a>浮点数 =&gt; float</h5> </li><li> <h5><a id="true__false%09_%09boolean_53"></a>true || false =&gt; boolean</h5> </li><li> <h5><a id="%09%09_____________%09date_54"></a>日期 =&gt; date</h5> </li><li> <h5><a id="__________________________55"></a>数组 =&gt; 取决于数组中的第一个有效值</h5> </li><li> <h5><a id="_________________________object_56"></a>对象 =&gt; object</h5> </li><li> <h5><a id="_____________________textkeyword_57"></a>字符串 =&gt; 如果不是数字和日期类型，那会被映射为text和keyword两个类型</h5> 除了上述字段类型之外，其他类型都必须显示映射，也就是必须手工指定，因为其他类型ES无法自动识别。</li></ul> </li><li> <h5><a id="Expllcit_field_mapping_59"></a>Expllcit field mapping：手动映射</h5> <pre><code class="prism language-json"><span class="token constant">PUT</span> <span class="token operator">/</span>product
<span class="token punctuation">{<!-- --></span>
	<span class="token string-property property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token string-property property">"field"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      	<span class="token string-property property">"mapping_parameter"</span><span class="token operator">:</span> <span class="token string">"parameter_value"</span>
	   	<span class="token punctuation">}</span>
   	<span class="token punctuation">}</span>
 	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ul> 
<h4><a id="5__73"></a>5 映射参数</h4> 
<p>​ <strong>①</strong> <strong>index：是否对创建对当前字段创建倒排索引，默认true，如果不创建索引，该字段不会通过索引被搜索到,但是仍然会在source元数据中展示</strong><br> ​ ② <strong>analyzer：指定分析器（character filter、tokenizer、Token filters）。</strong><br> ​ ③ boost：对当前字段相关度的评分权重，默认1<br> ​ ④ coerce：是否允许强制类型转换 true “1”=&gt; 1 false “1”=&lt; 1<br> ​ ⑤ copy_to：该参数允许将多个字段的值复制到组字段中，然后可以将其作为单个字段进行查询<br> ​ <strong>⑥</strong> <strong>doc_values：为了提升排序和聚合效率，默认true，如果确定不需要对字段进行排序或聚合，也不需要通过脚本访问字段值，则可以禁用doc值以节省磁盘 空间（不支持text和annotated_text）</strong><br> ​ ⑦ dynamic：控制是否可以动态添加新字段<br> ​ 1) true 新检测到的字段将添加到映射中。（默认）<br> ​ 2) false 新检测到的字段将被忽略。这些字段将不会被索引，因此将无法搜索，但仍会出现在_source返回的匹配项中。这些字段不会添加到映射中，必须显式 添加新字段。<br> ​ 3) strict 如果检测到新字段，则会引发异常并拒绝文档。必须将新字段显式添加到映射中<br> ​ <strong>⑧</strong> <strong>eager_global_ordinals：用于聚合的字段上，优化聚合性能。</strong><br> ​ 1) Frozen indices（冻结索引）：有些索引使用率很高，会被保存在内存中，有些使用率特别低，宁愿在使用的时候重新创建，在使用完毕后丢弃数据， Frozen indices的数据命中频率小，不适用于高搜索负载，数据不会被保存在内存中，堆空间占用比普通索引少得多，Frozen indices是只读的，请求可能 是秒级或者分钟级。<em><strong>*eager_global_ordinals不适用于Frozen indices*</strong></em><br> ​ ⑨ <strong>enable：是否创建倒排索引，可以对字段操作，也可以对索引操作，如果不创建索引，让然可以检索并在_source元数据中展示，谨慎使用，该状态无法 修改。</strong></p> 
<pre><code>    PUT my_index
    {
      "mappings": {
        "enabled": false
      }
    }
</code></pre> 
<p>​ <strong>⑩</strong> <strong>fielddata：查询时内存数据结构，在首次用当前字段聚合、排序或者在脚本中使用时，需要字段为fielddata数据结构，并且创建倒排索引保存到堆中</strong><br> ​ <strong>⑪</strong> <strong>fields：给field创建多字段，用于不同目的（全文检索或者聚合分析排序）</strong><br> ​ ⑫ format：格式化</p> 
<pre><code>  "date": {
     "type":  "date",
     "format": "yyyy-MM-dd"
   }
</code></pre> 
<p>​ ⑬ ignore_above：超过长度将被忽略<br> ​ ⑭ ignore_malformed：忽略类型错误<br> ​ ⑮ index_options：控制将哪些信息添加到反向索引中以进行搜索和突出显示。仅用于text字段<br> ​ ⑯ Index_phrases：提升exact_value查询速度，但是要消耗更多磁盘空间<br> ​ ⑰ Index_prefixes：前缀搜索<br> ​ 1) min_chars：前缀最小长度，&gt;0，默认2（包含）<br> ​ 2) max_chars：前缀最大长度，&lt;20，默认5（包含）<br> ​ ⑱ meta：附加元数据<br> ​ ⑲ normalizer：<br> ​ <strong>⑳ norms：是否禁用评分（在filter和聚合字段上应该禁用）。</strong><br> ​ <strong>21 null_value：为null值设置默认值</strong><br> ​ 22 position_increment_gap：<br> ​ 23 proterties：除了mapping还可用于object的属性设置<br> ​ <strong>24 search_analyzer：设置单独的查询时分析器：</strong><br> ​ 25 similarity：为字段设置相关度算法，支持BM25、claassic（TF-IDF）、boolean<br> ​ <strong>26 store：设置字段是否仅查询</strong><br> ​ <strong>27 term_vector：运维参数</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee577ac3a0c13f8149055fff97e7dc7b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Linux 常用命令指南 - vino命令 vnc服务端</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7a5d7ca09fc60bf629b677287b66f2aa/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【前端异常】JavaScript错误处理：分析 Uncaught(in promise) error</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>