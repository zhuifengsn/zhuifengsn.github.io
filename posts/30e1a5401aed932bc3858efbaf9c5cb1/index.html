<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python（19）Excel表格操作Ⅰ - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python（19）Excel表格操作Ⅰ" />
<meta property="og:description" content="目录
导包 读取EXCEL文件
1、获取worksheet名称
2、设定当前工作表
3、输出目标单元格数据
4、工作表.rows（行）
5、工作表.columns（列）
小结 导包 要想使用 python 操作 Excel 文件，应当导入 openpyxl 包。在命令行中输入以下字段：
pip install openpyxl 导入包： import openpyxl 读取EXCEL文件 这里会使用 openpyxl.load_workbook() 方法打开Excel文件，请看示例代码：
import openpyxl file = &#39;test.xlsx&#39; ex = openpyxl.load_workbook(file) #打开test.xlsx文件 1、获取worksheet名称 worksheet，即下方的工作表，打开Excel表格后，下方左下角的 “＋”号可以建立新的worksheet。
在python中，我们使用 get_sheet_names() 方法获取全部的工作表名称，通过get_active_sheet()方法获取当前工作表的名称。
import openpyxl file = &#39;test.xlsx&#39; ex = openpyxl.load_workbook(file) #打开test.xlsx文件 allSheets = ex.get_sheet_names() print(&#34;所有工作表=&#34;,allSheets) local_Sheet = ex.get_active_sheet() print(&#39;当前工作表名称：&#39;,local_Sheet) 使用上述代码会发生警告的话，可以使用下面的代码达到更好的效果：
ex.sheetnamesex.active.title import openpyxl file = &#39;test.xlsx&#39; ex = openpyxl.load_workbook(file) #打开test." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/30e1a5401aed932bc3858efbaf9c5cb1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-30T13:03:18+08:00" />
<meta property="article:modified_time" content="2024-01-30T13:03:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python（19）Excel表格操作Ⅰ</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%AF%BC%E5%8C%85%C2%A0-toc" style="margin-left:40px;"><a href="#%E5%AF%BC%E5%8C%85%C2%A0" rel="nofollow">导包 </a></p> 
<p id="%E8%AF%BB%E5%8F%96EXCEL%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%E8%AF%BB%E5%8F%96EXCEL%E6%96%87%E4%BB%B6" rel="nofollow">读取EXCEL文件</a></p> 
<p id="1%E3%80%81%E8%8E%B7%E5%8F%96worksheet%E5%90%8D%E7%A7%B0-toc" style="margin-left:80px;"><a href="#1%E3%80%81%E8%8E%B7%E5%8F%96worksheet%E5%90%8D%E7%A7%B0" rel="nofollow">1、获取worksheet名称</a></p> 
<p id="%C2%A02%E3%80%81%E8%AE%BE%E5%AE%9A%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E8%A1%A8-toc" style="margin-left:80px;"><a href="#%C2%A02%E3%80%81%E8%AE%BE%E5%AE%9A%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E8%A1%A8" rel="nofollow"> 2、设定当前工作表</a></p> 
<p id="3%E3%80%81%E8%BE%93%E5%87%BA%E7%9B%AE%E6%A0%87%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE-toc" style="margin-left:80px;"><a href="#3%E3%80%81%E8%BE%93%E5%87%BA%E7%9B%AE%E6%A0%87%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE" rel="nofollow">3、输出目标单元格数据</a></p> 
<p id="%C2%A04%E3%80%81%E5%B7%A5%E4%BD%9C%E8%A1%A8.rows%EF%BC%88%E8%A1%8C%EF%BC%89-toc" style="margin-left:80px;"><a href="#%C2%A04%E3%80%81%E5%B7%A5%E4%BD%9C%E8%A1%A8.rows%EF%BC%88%E8%A1%8C%EF%BC%89" rel="nofollow"> 4、工作表.rows（行）</a></p> 
<p id="5%E3%80%81%E5%B7%A5%E4%BD%9C%E8%A1%A8.columns%EF%BC%88%E5%88%97%EF%BC%89-toc" style="margin-left:80px;"><a href="#5%E3%80%81%E5%B7%A5%E4%BD%9C%E8%A1%A8.columns%EF%BC%88%E5%88%97%EF%BC%89" rel="nofollow">5、工作表.columns（列）</a></p> 
<p id="%C2%A0%E5%B0%8F%E7%BB%93-toc" style="margin-left:40px;"><a href="#%C2%A0%E5%B0%8F%E7%BB%93" rel="nofollow"> 小结</a> </p> 
<h3 id="%E5%AF%BC%E5%8C%85%C2%A0">导包 </h3> 
<p>要想使用 python 操作 Excel 文件，应当导入<span style="color:#efedf6;"> </span><span style="color:#956fe7;"><strong>openpyxl </strong></span>包。在命令行中输入以下字段：</p> 
<pre><code>pip install openpyxl</code></pre> 
<p>导入包： </p> 
<pre><code class="language-python">import openpyxl</code></pre> 
<h3 id="%E8%AF%BB%E5%8F%96EXCEL%E6%96%87%E4%BB%B6">读取EXCEL文件</h3> 
<p>这里会使用 openpyxl.load_workbook() 方法打开Excel文件，请看示例代码：</p> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件</code></pre> 
<h4 id="1%E3%80%81%E8%8E%B7%E5%8F%96worksheet%E5%90%8D%E7%A7%B0">1、获取worksheet名称</h4> 
<p>worksheet，即下方的工作表，打开Excel表格后，下方左下角的 “＋”号可以建立新的worksheet。</p> 
<p class="img-center"><img alt="" height="40" src="https://images2.imgbox.com/62/8c/gjkK7j82_o.png" width="233"></p> 
<p> 在python中，我们使用 <span style="color:#956fe7;">get_sheet_names() </span><span style="color:#0d0016;">方法获取全部的工作表名称，通过</span><span style="color:#956fe7;">get_active_sheet()</span><span style="color:#0d0016;">方法获取当前工作表的名称。</span></p> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

allSheets = ex.get_sheet_names()
print("所有工作表=",allSheets)
local_Sheet = ex.get_active_sheet()
print('当前工作表名称：',local_Sheet)</code></pre> 
<p>使用上述代码会发生警告的话，可以使用下面的代码达到更好的效果：</p> 
<ul><li>ex.sheetnames</li><li>ex.active.title</li></ul> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

allSheets = ex.sheetnames
print("所有工作表=",allSheets)
local_Sheet = ex.active.title
print('当前工作表名称：',local_Sheet)</code></pre> 
<p><img alt="" height="71" src="https://images2.imgbox.com/85/ed/rTywrsDK_o.png" width="507"></p> 
<h4 id="%C2%A02%E3%80%81%E8%AE%BE%E5%AE%9A%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E8%A1%A8"> 2、设定当前工作表</h4> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

allSheets = ex.sheetnames
print("所有工作表=",allSheets)

ws = ex.get_sheet_by_name('Sheet3')
print("当前工作表=",ws.title)</code></pre> 
<p> <img alt="" height="81" src="https://images2.imgbox.com/6e/49/FG5UWay5_o.png" width="475"></p> 
<p> 也可以这么写，也能达到一样的效果：</p> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

allSheets = ex.sheetnames
print("所有工作表=",allSheets)

wb = ex.worksheets[2]
print("当前工作表=",wb.title)</code></pre> 
<h4 id="3%E3%80%81%E8%BE%93%E5%87%BA%E7%9B%AE%E6%A0%87%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE">3、输出目标单元格数据</h4> 
<figure class="image"> 
 <img alt="" height="388" src="https://images2.imgbox.com/33/65/Y194prcH_o.png" width="1086"> 
 <figcaption>
   本篇文章中使用的表格内容 
 </figcaption> 
</figure> 
<p></p> 
<ul><li>行和列：Excel工作表由行和列组成，行和列交叉形成单元格。每个单元格可以存储一个数据值、公式或函数等。</li><li>单元格：是Excel工作表中的最小单位，用于存储单一的数据值。单元格的地址由列号和行号确定，例如A1表示第1列第1行的单元格。</li></ul> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

ex.active = ex.worksheets[0]
print("当前工作表=",ex.active.title)
wb = ex.active
print("单元格A1=",wb['A1'].value)
print("单元格A2=",wb['A2'].value)
print("单元格B2=",wb['B1'].value)
print("单元格B3=",wb['B3'].value)
print("单元格C5=",wb['C10'].value)
</code></pre> 
<p> ​​​<img alt="" height="183" src="https://images2.imgbox.com/9c/e8/GMO0ivTf_o.png" width="854"></p> 
<h4 id="%C2%A04%E3%80%81%E5%B7%A5%E4%BD%9C%E8%A1%A8.rows%EF%BC%88%E8%A1%8C%EF%BC%89"> 4、工作表.rows（行）</h4> 
<p><code>.rows</code> 是 <code>openpyxl</code> 库中的一个属性，用于遍历 Excel 工作表中的所有行。在 <code>openpyxl</code> 中，每个工作表对象都有一个 <code>rows</code> 属性，它返回一个生成器，用于产生工作表中的所有行。 </p> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

wb = ex.worksheets[0]
print("当前工作表=",wb.title)
for row in wb.rows:
    for cell in row:
        print(cell.value, end=' ')
    print()</code></pre> 
<p class="img-center"><img alt="" height="165" src="https://images2.imgbox.com/66/61/dWf7SiJR_o.png" width="458"></p> 
<h4 id="5%E3%80%81%E5%B7%A5%E4%BD%9C%E8%A1%A8.columns%EF%BC%88%E5%88%97%EF%BC%89">5、工作表.columns（列）</h4> 
<p><code>.columns</code> 是 <code>openpyxl</code> 库中的一个属性，用于遍历 Excel 工作表中的所有列。在 <code>openpyxl</code> 中，每个工作表对象都有一个 <code>columns</code> 属性，它返回一个生成器，用于产生工作表中的所有列。 </p> 
<pre><code class="language-python">import openpyxl

file = 'test.xlsx'
ex = openpyxl.load_workbook(file) #打开test.xlsx文件

wb = ex.worksheets[0]
print("当前工作表=",wb.title)
for column in wb.columns:
    for cell in column:
        print(cell.value, end=' ')
    print()
</code></pre> 
<p class="img-center"><img alt="" height="138" src="https://images2.imgbox.com/0e/70/m7q8S6Cs_o.png" width="449"></p> 
<h3 id="%C2%A0%E5%B0%8F%E7%BB%93"> 小结</h3> 
<p>本篇文章中介绍了如何使用python语言操作Excel表格。主要内容包括，导包， 读取EXCEL文件 1、获取worksheet名称 2、设定当前工作表 3、输出目标单元格数据 4、工作表.rows（行） 5、工作表.columns（列）。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e40b7805acf89014f8a9df2dcea6c542/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Oracle查看指定表的索引</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/94f212bc991a6a51d26542a55cd6944e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【经典代码】将随机划分后的数据集数据和标签进行重排对应</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>