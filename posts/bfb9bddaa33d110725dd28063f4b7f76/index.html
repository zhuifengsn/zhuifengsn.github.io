<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>APP自动化之Poco框架 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="APP自动化之Poco框架" />
<meta property="og:description" content="今天给大家介绍一款自动化测试框架Poco，其脚本写法非常简洁、高效，其元素定位器效率更快，其本质基于python的第三方库，调试起来也会非常方便，能够很好的提升自动化测试效率，节省时间。
(一）背景 1. Poco介绍
Poco是一款跨平台的自动化测试框架，基于UI控件识别原理，适用于Android、iOS原生和各种主流的游戏引擎应用，由于Airtest是基于图像识别原理，所以Poco&#43;Airtest结合使用更适合混合应用。尤其是针对flutter app部分元素控件无法识别情况，采用airtest框架，针对元素控件的部分，采用Poco框架进行自动化测试。
2. Poco本质
Poco和Airtest框架一样，Poco实际上也是Python的一个第三方库，如果需要本地编写Poco脚本，需要先安装Pocoui库即可
pip install pocoui 3. 官方文档
https://airtest.doc.io.netease.com/IDEdocs/poco_framework/1_poco_info/
（二）使用Poco框架 1. 查看控件元素
在AirtestIDE连接待测设备后，然后在Poco辅助窗口选择对应的设备进行查看
备注：选择模式时，脚本编辑窗口顶部会让我们选择是否插入对应的初始化代码，我们选择Yes即可
2. 查看控件的方式
第一种：冻结模式
进入模式：点击下图冻结按钮
说明：单击下图箭头区域，则会进入冻结模式查看元素控件，光标移至右侧的元素位置，并点击相应元素控件，则自动会定位到页面层级，log窗口可以查看当前层面的元素属性。即使实际连接的被测设备已经离开当前页面，冻结模式也不会受影响，相当于一直冻结在这个页面，便于查看元素
退出方式：再次点击冻结按钮
第二种：检视模式
进入模式：点击下图检视按钮
说明：单击下图箭头区域，则会进入检视模式查看元素控件，与刚才的冻结模式最大的区别是，此时查看控件，如我们对控件进行操作，设备画面也会跟着变化
退出方式：再次点击检视按钮
3. 定位元素的方式
基本定位器
由于AirtestIDE内置Poco，直接导入即可使用，基本定位器就是poco(节点名或节点属性)
# -*- encoding=utf8 -*- __author__ = &#34;86150&#34; from poco.drivers.android.uiautomation import AndroidUiautomationPoco poco = AndroidUiautomationPoco(use_airtest_input=True, screenshot_each_action=False) # 单个条件 poco(text=&#34;中古屋&#34;) # 多个条件 poco(&#39;com.addcn.android.house591:id/grid_item_text&#39;,text=&#34;中古屋&#34;) 相对选择器
就是通过元素之间的层级关系进行选择，例如父子关系、兄弟关系、祖先后代关系等等，Poco控件给我们提供了利用树的层级关系来定位的各种方法：
子节点：child所有子节点：children子孙节点：offspring父节点：parent兄弟节点：sibling poco(&#34;plays&#34;).child(&#34;playBasic&#34;).offspring(&#34;star_single&#34;) 说明：这种方式较为繁琐，一般是通过属性和节点无法定位的时候，可以选择使用这种方式
正则表达式
正则表达式匹配时一种少见的方式，但也是非常好用的方式，按照下图通过属性定位的方式为：
# 1.text属性方式定位 poco(text=&#34;中古屋&#34;) # 换成正则表达式定位 poco(textMatches=&#34;正则表达式&#34;) poco(textMatches=&#34;.*中古屋&#34;) # 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/bfb9bddaa33d110725dd28063f4b7f76/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-01T19:57:45+08:00" />
<meta property="article:modified_time" content="2023-07-01T19:57:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">APP自动化之Poco框架</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>今天给大家介绍一款自动化测试框架Poco，其脚本写法非常简洁、高效，其元素定位器效率更快，其本质基于python的第三方库，调试起来也会非常方便，能够很好的提升自动化测试效率，节省时间。</p> 
<h3><a id="_5"></a>(一）背景</h3> 
<p><strong>1. Poco介绍</strong></p> 
<p>Poco是一款跨平台的自动化测试框架，基于UI控件识别原理，适用于Android、iOS原生和各种主流的游戏引擎应用，由于Airtest是基于图像识别原理，所以Poco+Airtest结合使用更适合混合应用。尤其是针对flutter app部分元素控件无法识别情况，采用airtest框架，针对元素控件的部分，采用Poco框架进行自动化测试。</p> 
<p><strong>2. Poco本质</strong></p> 
<p>Poco和Airtest框架一样，Poco实际上也是Python的一个第三方库，如果需要本地编写Poco脚本，需要先安装Pocoui库即可</p> 
<pre><code class="prism language-bash">pip <span class="token function">install</span> pocoui
</code></pre> 
<p><strong>3. 官方文档</strong></p> 
<p>https://airtest.doc.io.netease.com/IDEdocs/poco_framework/1_poco_info/</p> 
<h3><a id="Poco_30"></a>（二）使用Poco框架</h3> 
<p><strong>1. 查看控件元素</strong></p> 
<p>在AirtestIDE连接待测设备后，然后在Poco辅助窗口选择对应的设备进行查看</p> 
<p><img src="https://images2.imgbox.com/85/2d/wL4DuynB_o.png" alt="图片"></p> 
<p>备注：选择模式时，脚本编辑窗口顶部会让我们选择是否插入对应的初始化代码，我们选择Yes即可</p> 
<p><strong>2. 查看控件的方式</strong></p> 
<p><strong>第一种：冻结模式</strong></p> 
<p><strong>进入模式</strong>：点击下图冻结按钮</p> 
<p><strong>说明</strong>：单击下图箭头区域，则会进入冻结模式查看元素控件，光标移至右侧的元素位置，并点击相应元素控件，则自动会定位到页面层级，log窗口可以查看当前层面的元素属性。即使实际连接的被测设备已经离开当前页面，冻结模式也不会受影响，相当于一直冻结在这个页面，便于查看元素</p> 
<p><strong>退出方式</strong>：再次点击冻结按钮</p> 
<p><img src="https://images2.imgbox.com/9b/02/yAKDC0gP_o.png" alt="图片"></p> 
<p><strong>第二种：检视模式</strong></p> 
<p><strong>进入模式</strong>：点击下图检视按钮</p> 
<p><strong>说明</strong>：单击下图箭头区域，则会进入检视模式查看元素控件，与刚才的冻结模式最大的区别是，此时查看控件，如我们对控件进行操作，设备画面也会跟着变化</p> 
<p><strong>退出方式</strong>：再次点击检视按钮</p> 
<p><img src="https://images2.imgbox.com/11/21/uZvkpWZ5_o.png" alt="图片"></p> 
<p><strong>3. 定位元素的方式</strong></p> 
<p><strong>基本定位器</strong></p> 
<p>由于AirtestIDE内置Poco，直接导入即可使用，基本定位器就是poco(节点名或节点属性)</p> 
<pre><code class="prism language-bash"><span class="token comment"># -*- encoding=utf8 -*-</span>
__author__ <span class="token operator">=</span> <span class="token string">"86150"</span>
from poco.drivers.android.uiautomation <span class="token function">import</span> AndroidUiautomationPoco
poco <span class="token operator">=</span> AndroidUiautomationPoco<span class="token punctuation">(</span>use_airtest_input<span class="token operator">=</span>True, <span class="token assign-left variable">screenshot_each_action</span><span class="token operator">=</span>False<span class="token punctuation">)</span>

<span class="token comment"># 单个条件</span>
poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>

<span class="token comment"># 多个条件</span>
poco<span class="token punctuation">(</span><span class="token string">'com.addcn.android.house591:id/grid_item_text'</span>,text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/4d/95/Kodj4HnJ_o.png" alt="图片"></p> 
<p><strong>相对选择器</strong></p> 
<p>就是通过元素之间的层级关系进行选择，例如父子关系、兄弟关系、祖先后代关系等等，Poco控件给我们提供了利用树的层级关系来定位的各种方法：</p> 
<ul><li>子节点：child</li><li>所有子节点：children</li><li>子孙节点：offspring</li><li>父节点：parent</li><li>兄弟节点：sibling</li></ul> 
<pre><code class="prism language-bash">poco<span class="token punctuation">(</span><span class="token string">"plays"</span><span class="token punctuation">)</span>.child<span class="token punctuation">(</span><span class="token string">"playBasic"</span><span class="token punctuation">)</span>.offspring<span class="token punctuation">(</span><span class="token string">"star_single"</span><span class="token punctuation">)</span>
</code></pre> 
<p>说明：这种方式较为繁琐，一般是通过属性和节点无法定位的时候，可以选择使用这种方式</p> 
<p><strong>正则表达式</strong></p> 
<p>正则表达式匹配时一种少见的方式，但也是非常好用的方式，按照下图通过属性定位的方式为：</p> 
<pre><code class="prism language-bash"><span class="token comment"># 1.text属性方式定位</span>
poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>
<span class="token comment"># 换成正则表达式定位</span>
poco<span class="token punctuation">(</span>textMatches<span class="token operator">=</span><span class="token string">"正则表达式"</span><span class="token punctuation">)</span>
poco<span class="token punctuation">(</span>textMatches<span class="token operator">=</span><span class="token string">".*中古屋"</span><span class="token punctuation">)</span>

<span class="token comment"># 2.name属性方式定位</span>
poco<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'com.addcn.android.house591:id/grid_item_text'</span><span class="token punctuation">)</span>
<span class="token comment"># 换成正则表达式定位</span>
poco<span class="token punctuation">(</span>nameMatches<span class="token operator">=</span><span class="token string">"正则表达式"</span><span class="token punctuation">)</span>
poco<span class="token punctuation">(</span>nameMatches<span class="token operator">=</span><span class="token string">".*grid_item_text"</span><span class="token punctuation">)</span>
</code></pre> 
<p>说明：只要能够用 poco(xx=预期属性值) 来选择的控件，就可以用 poco(xxMatches=预期属性值的正则表达式) 来进行匹配定位，官方推荐优先使用属性或正则表达式定位，会更加简介高效</p> 
<p><strong>4. 操作元素的方式</strong></p> 
<p><strong>点击</strong></p> 
<pre><code class="prism language-bash"><span class="token comment"># 单击元素</span>
	poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>.click<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment"># 长按元素</span>
	poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>.long_click<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>滑动</strong></p> 
<p>Poco支持对控件进行滑动操作，我们需要先定位到这个控件，然后指定它按照某个方向滑动即可</p> 
<pre><code class="prism language-bash"><span class="token comment"># 向下滑动0.2个单位距离</span>
poco<span class="token punctuation">(</span><span class="token string">"com.addcn.android.house591:id/grid_item_text"</span><span class="token punctuation">)</span>.swipe<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0,0</span>.2<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 向上滑动0.2个单位距离</span>
poco<span class="token punctuation">(</span><span class="token string">"com.addcn.android.house591:id/grid_item_text"</span><span class="token punctuation">)</span>.swipe<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span>,-0.2<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 向下滑动0.1个单位距离</span>
poco<span class="token punctuation">(</span><span class="token string">"com.addcn.android.house591:id/grid_item_text"</span><span class="token punctuation">)</span>.swipe<span class="token punctuation">(</span><span class="token string">"down"</span><span class="token punctuation">)</span>

<span class="token comment"># 向上滑动0.1个单位距离</span>
poco<span class="token punctuation">(</span><span class="token string">"Handle"</span><span class="token punctuation">)</span>.swipe<span class="token punctuation">(</span><span class="token string">"up"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>获取元素的属性值</strong></p> 
<p>在IDE的poco辅助窗检索出来的控件属性，基本上都可以通过 attr 接口读取出来</p> 
<p><img src="https://images2.imgbox.com/cf/c6/uFHJdfIZ_o.png" alt="图片"></p> 
<pre><code class="prism language-bash">print<span class="token punctuation">(</span><span class="token string">"name："</span>+poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>.attr<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span><span class="token string">"type："</span>+poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>.attr<span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span><span class="token string">"texture："</span>+poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>.attr<span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">))</span>
print<span class="token punctuation">(</span><span class="token string">"texture："</span>+poco<span class="token punctuation">(</span>text<span class="token operator">=</span><span class="token string">"中古屋"</span><span class="token punctuation">)</span>.attr<span class="token punctuation">(</span><span class="token string">"texture"</span><span class="token punctuation">))</span>

<span class="token comment"># log日志输出</span>
name：com.addcn.android.house591:id/grid_item_text
type：android.widget.TextView
texture：中古屋
<span class="token punctuation">[</span>Finished<span class="token punctuation">]</span>
</code></pre> 
<p><strong>设置元素的属性值</strong></p> 
<p>通常情况需要给定位的元素输入文本内容，可以使用set_text()方法或setatrr()方法</p> 
<pre><code class="prism language-bash">from airtest.core.api <span class="token function">import</span> *
auto_setup<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>
from poco.drivers.android.uiautomation <span class="token function">import</span> AndroidUiautomationPoco
poco <span class="token operator">=</span> AndroidUiautomationPoco<span class="token punctuation">(</span>use_airtest_input<span class="token operator">=</span>True, <span class="token assign-left variable">screenshot_each_action</span><span class="token operator">=</span>False<span class="token punctuation">)</span>

<span class="token comment"># 先激活输入光标</span>
poco<span class="token punctuation">(</span><span class="token string">"com.addcn.android.house591:id/et_edittext"</span><span class="token punctuation">)</span>.click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 再执行输入动作</span>
poco<span class="token punctuation">(</span><span class="token string">"com.addcn.android.house591:id/et_edittext"</span><span class="token punctuation">)</span>.set_text<span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>

poco<span class="token punctuation">(</span><span class="token string">"com.addcn.android.house591:id/et_edittext"</span><span class="token punctuation">)</span>.setattr<span class="token punctuation">(</span><span class="token string">'text'</span>,<span class="token string">"456"</span><span class="token punctuation">)</span>
</code></pre> 
<p>Poco脚本相较于Appium脚本更加简洁、高效，使用起来更加方便，尤其是针对混合应用、Flutter APP 等应用能够结合Airtest框架一起使用，能够很好解决部分元素控件无法定位的问题。目前来说，我觉得是挺好用，下期可以出一篇两个测试框架结合的应用~</p> 
<p><strong>最后：</strong> 为了回馈铁杆粉丝们，我给大家整理了完整的软件测试视频学习教程，朋友们如果需要可以自行免费领取 <strong><code>【保证100%免费】</code></strong> <br> <img src="https://images2.imgbox.com/aa/c1/xc5hxWI3_o.png" alt="在这里插	入图片描述"></p> 
<p><strong>软件测试面试文档</strong></p> 
<p>我们学习必然是为了找到高薪的工作，下面这些面试题是来自阿里、腾讯、字节等一线互联网大厂最新的面试资料，并且有字节大佬给出了权威的解答，刷完这一套面试资料相信大家都能找到满意的工作。</p> 
<p><img src="https://images2.imgbox.com/3e/f4/KyJDrnp1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1e/b4/zffzy32Z_o.gif" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fa8c35043bd17e2859c3e8fb436f721e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux设备驱动程序：简单字符设备驱动</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cd0edbd8afa5c68b6609e81dd3d310d4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单片机通识之按键扫描框架(非死等消抖)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>