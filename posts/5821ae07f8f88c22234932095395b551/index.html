<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>u-boot在S3C2440上的移植问题及解决方法集锦（三） - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="u-boot在S3C2440上的移植问题及解决方法集锦（三）" />
<meta property="og:description" content="一、移植环境 主 机：VMWare6.5--Fedora 9 开发板：自制开发板 CPU：S3C2440； SDRAM：HY57V561620FTP-H； NOR flash：SST_39VF1601（2M）； NAND flash：K9F1G08U0B（128M）； 网卡芯片：DM9000EP
编译器：arm-linux-gcc-4.3.2 u-boot：u-boot-2009.08 linux kernel：linux-2.6.30 busybox：busybox-1.13.3 二、博客地址 http://blog.csdn.net/liuqiqi677 如有错误，欢迎指正。
三、参考资料 主要参考了黄刚的博客http://blogold.chinaunix.net/u3/101649/ ，他的博客写得相当不错，将嵌入式开发各个阶段的知识以边做边学的方式，辅以图片、解释，清晰地呈现给读者，能够让读者把握主线，对嵌入式开发有整体的了解。强烈推荐！！！ 四、问题及解决方法 7、Fedora9的bug，“No network connection” 我的虚拟机采用桥接的方式与Windows连接，并且在Fedora9中能够ping通Windows XP，但是右上角的网络连接图标无论是否手动激活网卡都会一直提示 &#34;No network connection&#34;，如图7所示，显示一把红色小叉。 图7 网络连接图标显示无连接 这个问题之前一直存在，但是没有找到解决方法，就搁置下来了。后来，我想用tftp将linux内核下载到开发板上，但是一直不能成功，我就怀疑是不是网络部分没有配置好，因此又去仔细研究了一下，终于发现问题所在！这实际上是 Fedora 9 的一个bug。（以前的版本没用过不清楚）
造成这个问题的原因是 Network Configuration 图形设置界面的默认选项值与 /etc/sysconfig/network-scripts/ifcfg-eth0 配置文件的默认值不一致。 刚装完系统的情况下：在 Network Configuration 中，编辑 Device 下的 eth0，会发现 &#34;Controlled by NetworkManager&#34; 是不打勾的。不打勾则值为 &#34;no&#34;。 而在 /etc/sysconfig/network-scripts/ifcfg-eth0 中对应上面的选项有一行：“NM_CONTROLLED = ”。 留空意味着取默认值，默认值为 &#34;yes&#34;。同一个选项，一边显示为 no，另一边则默认为 yes，能不出问题吗？解决方法很简单，要么就在图形界面下打勾，要么就把配置文本改成 &#34;yes&#34;。我比较懒，就直接在复选框上打钩了。 重启系统，如图9所示，一切恢复正常。 图8 选中Controlled by NetworkManager 图9 网络连接正常 8、开发板能够ping通主机，但tftp下载失败 我在 Fedora 9 中配置好主机的tftp服务（适合Fedora 9的rpm包我已经上传到http://download." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/5821ae07f8f88c22234932095395b551/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-03-31T16:57:00+08:00" />
<meta property="article:modified_time" content="2011-03-31T16:57:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">u-boot在S3C2440上的移植问题及解决方法集锦（三）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><span style="font-size: medium;"><strong>一、移植环境</strong> </span> </p> 
<ul><li><span style="font-size: small;">主   机：VMWare6.5--Fedora 9</span> </li><li><span style="font-size: small;">开发板：自制开发板</span> </li></ul> 
<p><span style="font-size: small;">              CPU：S3C2440；    SDRAM：HY57V561620FTP-H；    NOR flash：SST_39VF1601（2M）；</span> </p> 
<p><span style="font-size: small;">              NAND flash：K9F1G08U0B（128M）；    网卡芯片：DM9000EP<br> </span> </p> 
<ul><li><span style="font-size: small;">编译器：arm-linux-gcc-4.3.2</span> </li><li><span style="font-size: small;">u-boot：u-boot-2009.08</span> </li><li><span style="font-size: small;">linux kernel：linux-2.6.30</span> </li><li><span style="font-size: small;">busybox：busybox-1.13.3</span> </li></ul> 
<p><span style="font-size: medium;"><strong>二、博客地址</strong> </span> </p> 
<p><span style="font-size: medium;"><strong>      </strong> <a href="http://blog.csdn.net/liuqiqi677"><span style="font-size: small;">http://blog.csdn.net/liuqiqi677</span> </a> </span> </p> 
<p><span style="font-size: medium;"><span style="font-size: small;">      如有错误，欢迎指正。<br> </span> </span> </p> 
<p><span style="font-size: medium;"><strong>三、参考资料</strong> </span> </p> 
<p><strong>      </strong> <span style="font-size: small;">主要参考了黄刚的博客<a href="http://blogold.chinaunix.net/u3/101649/" rel="nofollow">http://blogold.chinaunix.net/u3/101649/</a> ，他的博客写得相当不错，将嵌入式开发各个阶段的知识以边做边学的方式，辅以图片、解释，清晰地呈现给读者，能够让读者把握主线，对嵌入式开发有整体的了解。强烈推荐！！！</span> <strong><br> </strong> </p> 
<p><span style="font-size: medium;"><strong>四、问题及解决方法</strong> </span> </p> 
<p><strong>     <span style="font-size: small;"> <span style="color: #ff0000;">7、Fedora9的bug，“No network connection”</span> </span> </strong> </p> 
<p> <strong>      </strong> <span style="font-size: small;">我的虚拟机采用桥接的方式与Windows连接，并且在Fedora9中能够ping通Windows XP，但是右上角的网络连接图标无论是否手动激活网卡都会一直提示 "No network connection"，如图7所示，显示一把红色小叉。</span> </p> 
<p style="text-align: center;"><img src="https://images2.imgbox.com/96/6d/ZaQ9B3Kl_o.gif" alt=""> </p> 
<p style="text-align: center;"><span style="font-size: small;">图7 网络连接图标显示无连接</span> </p> 
<p><span style="font-size: small;">      这个问题之前一直存在，但是没有找到解决方法，就搁置下来了。后来，我想用tftp将linux内核下载到开发板上，但是一直不能成功，我就怀疑是不是网络部分没有配置好，因此又去仔细研究了一下，终于发现问题所在！这实际上是 Fedora 9 的一个bug。（以前的版本没用过不清楚）<br>       造成这个问题的原因是 Network Configuration 图形设置界面的默认选项值与 /etc/sysconfig/network-scripts/ifcfg-eth0 配置文件的默认值不一致。</span> </p> 
<p><span style="font-size: small;">      刚装完系统的情况下：在 Network Configuration 中，编辑 Device 下的 eth0，会发现 "Controlled by NetworkManager" 是不打勾的。不打勾则值为 "no"。</span> <span style="font-size: small;">而在 /etc/sysconfig/network-scripts/ifcfg-eth0 </span> <span style="font-size: small;">中对应上面的选项有一行：“NM_CONTROLLED = ”。</span> <span style="font-size: small;">留空意味着取默认值，默认值为 "yes"。同一个选项，一边显示为 no，另一边则默认为 yes，能不出问题吗？解决方法很简单，要么就在图形界面下打勾，要么就把配置文本改成 "yes"。我比较懒，就直接在复选框上打钩了。</span> <span style="font-size: small;">重启系统，如图9所示，一切恢复正常。</span> </p> 
<p style="text-align: center;"><span style="font-size: small;"><img src="https://images2.imgbox.com/8b/e3/m3pMi3Sk_o.gif" alt=""> </span> </p> 
<p style="text-align: center;"><span style="font-size: small;">图8 选中Controlled by NetworkManager</span> </p> 
<p style="text-align: center;"><span style="font-size: small;"><img src="https://images2.imgbox.com/d5/17/151Ddq5w_o.gif" alt=""> </span> </p> 
<p style="text-align: center;"><span style="font-size: small;">图9 网络连接正常</span> </p> 
<p style="text-align: left;"><span style="font-size: small;">      </span> <strong><span style="font-size: small;"><span style="color: #ff0000;">8、开发板能够ping通主机，但tftp下载失败</span> </span> </strong> </p> 
<p style="text-align: left;"><strong><span style="font-size: small;"><span style="color: #ff0000;">      </span> </span> </strong> <span style="font-size: small;">我在 Fedora 9 中配置好主机的tftp服务（适合Fedora 9的rpm包我已经上传到<a href="http://download.csdn.net/source/3145778">http://download.csdn.net/source/3145778</a> ，并附有一个简单的安装说明欢迎大家下载，没有资源分了，赚点分，大家不要拍我呀），在 Fedora 9 中进行本地测试十分正常，并且开发板也能够ping通主机，但是在使用tftp想将主机中上的zImage（linux内核文件）下载到开发板上时，却出现了问题，终端一直显示‘T T T T T T T T T T T T T’，最后，提示‘</span> <span style="font-size: small;"><strong><span style="color: #ff0000;">Retry count exceeded; starting again</span> ’</strong> </span> <span style="font-size: small;">。</span> </p> 
<p style="text-align: left;"><span style="font-size: small;">      网上查了一下，原因归纳起来大致有两点：1、网卡连接超时；2、xinetd和tftp服务没有开启；3、防火墙没关。</span> <span style="font-size: small;">首先针对第一种，我修改了 net/net.c 中对网络延时的设置，结果还是不行。第二种情况，两个服务我都打开了的。第三种情况，我检查了 Windows 和 Fedora 9 的防火墙，都关掉了（在Fedora9的服务中，还要将iptables和ip6tables两个服务关掉，并且重启系统，这两个也是防火墙）。但是，为什么还是不行呢？我突然意识到，除了这两个防火墙，杀毒软件通常还有一个防火墙，我的杀毒软件是卡巴的，进入卡巴，关掉它的防火墙，再次测试，下载成功！</span> </p> 
<p style="text-align: center;"><span style="font-size: small;"><img src="https://images2.imgbox.com/57/ae/wfnDlXQX_o.gif" alt=""> <br> </span> </p> 
<p style="text-align: center;"><span style="font-size: small;">图10 关掉卡巴的防火墙</span> </p> 
<p style="text-align: left;"><span style="font-size: small;">      </span> <strong><span style="font-size: small;"><span style="color: #ff0000;">9、request_module: runaway loop modprobe binfmt-464c</span> </span> </strong> </p> 
<p style="text-align: left;"><strong><span style="font-size: small;"><span style="color: #ff0000;">      </span> </span> </strong> <span style="font-size: small;">进入busybox的 _install/bin 目录下，执行 # file busybox 命令，检查编译的文件系统是基于ARM的还是X386的，我的上面显示居然是基于X386的，但是我一开始就配置过的呀，重新打开Makefile，一看，居然没有改过来，可能是我忘记保存了ORZ。</span> <span style="font-size: small;">把第164行改成CROSS_COMPILE = arm-linux- ，189行改成ARCH = arm，重新编译下载，问题解决了。</span> </p> 
<p style="text-align: left;"><span style="font-size: small;">      ^_^<br> </span> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d5f69309f50ef7c1f7b8f3e908c5fde7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MFC线程局部存储</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fbc9cda08536ef8b3d4dd8503b19a1c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">RTTI运行时识别类型信息</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>