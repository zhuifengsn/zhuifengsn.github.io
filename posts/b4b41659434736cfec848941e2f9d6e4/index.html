<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python数据分析】pandas知识总结(超全面) - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Python数据分析】pandas知识总结(超全面)" />
<meta property="og:description" content="文章目录 Series初始化创建通过字典创建索引数据对齐缺失值处理 DataFrame通过字典创建初始化创建索引获取列值获取行值特别注意 数据对齐缺失值处理排序常用函数 时间序列普通的时间处理方式pandas时间处理产生时间序列时间序列的应用csv文件读取及时间序列转换csv文件中的缺失值处理 Series 创建一维数据表
初始化创建 # 可以指定索引index sr1 = pd.Series(np.arange(10), index=list(string.ascii_uppercase[:10])) print(sr1) # A 0 # B 1 # C 2 # D 3 # E 4 # F 5 # G 6 # H 7 # I 8 # J 9 # dtype: int32 # 可以不指定索引 index 默认以0开始作为索引 sr2 = pd.Series(np.arange(10)) print(sr2) # 0 0 # 1 1 # 2 2 # 3 3 # 4 4 # 5 5 # 6 6 # 7 7 # 8 8 # 9 9 # dtype: int32 通过字典创建 d = {&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/b4b41659434736cfec848941e2f9d6e4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-10-04T12:51:11+08:00" />
<meta property="article:modified_time" content="2021-10-04T12:51:11+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python数据分析】pandas知识总结(超全面)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#Series_1" rel="nofollow">Series</a></li><li><ul><li><a href="#_3" rel="nofollow">初始化创建</a></li><li><a href="#_36" rel="nofollow">通过字典创建</a></li><li><a href="#_48" rel="nofollow">索引</a></li><li><a href="#_87" rel="nofollow">数据对齐</a></li><li><a href="#_126" rel="nofollow">缺失值处理</a></li></ul> 
    </li><li><a href="#DataFrame_152" rel="nofollow">DataFrame</a></li><li><ul><li><a href="#_158" rel="nofollow">通过字典创建</a></li><li><a href="#_172" rel="nofollow">初始化创建</a></li><li><a href="#_195" rel="nofollow">索引</a></li><li><ul><li><a href="#_203" rel="nofollow">获取列值</a></li><li><a href="#_226" rel="nofollow">获取行值</a></li><li><a href="#_281" rel="nofollow">特别注意</a></li></ul> 
     </li><li><a href="#_302" rel="nofollow">数据对齐</a></li><li><a href="#_328" rel="nofollow">缺失值处理</a></li><li><a href="#_360" rel="nofollow">排序</a></li><li><a href="#_394" rel="nofollow">常用函数</a></li></ul> 
    </li><li><a href="#_405" rel="nofollow">时间序列</a></li><li><ul><li><a href="#_407" rel="nofollow">普通的时间处理方式</a></li><li><a href="#pandas_423" rel="nofollow">pandas时间处理</a></li><li><ul><li><a href="#_425" rel="nofollow">产生时间序列</a></li><li><a href="#_495" rel="nofollow">时间序列的应用</a></li><li><a href="#csv_576" rel="nofollow">csv文件读取及时间序列转换</a></li><li><ul><li><a href="#csv_667" rel="nofollow">csv文件中的缺失值处理</a></li></ul> 
     </li></ul> 
    </li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="Series_1"></a>Series</h4> 
<blockquote> 
 <p>创建一维数据表</p> 
</blockquote> 
<h5><a id="_3"></a>初始化创建</h5> 
<pre><code class="prism language-python"><span class="token comment"># 可以指定索引index</span>
sr1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_uppercase<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr1<span class="token punctuation">)</span>
<span class="token comment"># A    0</span>
<span class="token comment"># B    1</span>
<span class="token comment"># C    2</span>
<span class="token comment"># D    3</span>
<span class="token comment"># E    4</span>
<span class="token comment"># F    5</span>
<span class="token comment"># G    6</span>
<span class="token comment"># H    7</span>
<span class="token comment"># I    8</span>
<span class="token comment"># J    9</span>
<span class="token comment"># dtype: int32</span>

<span class="token comment"># 可以不指定索引 index 默认以0开始作为索引</span>
sr2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">)</span>
<span class="token comment"># 0    0</span>
<span class="token comment"># 1    1</span>
<span class="token comment"># 2    2</span>
<span class="token comment"># 3    3</span>
<span class="token comment"># 4    4</span>
<span class="token comment"># 5    5</span>
<span class="token comment"># 6    6</span>
<span class="token comment"># 7    7</span>
<span class="token comment"># 8    8</span>
<span class="token comment"># 9    9</span>
<span class="token comment"># dtype: int32</span>
</code></pre> 
<h5><a id="_36"></a>通过字典创建</h5> 
<pre><code class="prism language-python">d <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"zdz"</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string">"tel"</span><span class="token punctuation">:</span> <span class="token string">"10000"</span><span class="token punctuation">}</span>
sr1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr1<span class="token punctuation">)</span>
<span class="token comment"># name      zdz</span>
<span class="token comment"># age        13</span>
<span class="token comment"># tel     10000</span>
<span class="token comment"># dtype: object</span>
</code></pre> 
<h5><a id="_48"></a>索引</h5> 
<blockquote> 
 <p>索引方式和之前的np中索引一样，可以数值索引，也可以直接按照字典的方式索引<code>(sr[key])</code>来获取某行的值</p> 
 <p><strong><code>index</code>属性用于获取所有的行索引值</strong></p> 
 <p>使用<code>iloc</code>和<code>loc</code>两种方式进行索引，其中<code>iloc</code>是以<strong>行序号</strong>作为索引，而<code>loc</code>则是以<strong>行标签</strong>作为索引。</p> 
</blockquote> 
<pre><code class="prism language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 0  获取第0行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取第1 2 3行</span>
<span class="token comment"># 1    1</span>
<span class="token comment"># 2    2</span>
<span class="token comment"># 3    3</span>

sr1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_uppercase<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr1<span class="token punctuation">.</span>index<span class="token punctuation">)</span>  <span class="token comment"># 获取行索引</span>
<span class="token comment"># Index(['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'], dtype='object')</span>

sr <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sr2 <span class="token operator">=</span> sr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># sr2里面的索引代表的是标签值 key  不能表示sr2中元素的序号</span>

<span class="token comment"># 要想用整数作为标签 则使用iloc 和 loc函数来作为区分</span>
<span class="token comment"># # loc[key]里面的数字解释为key 也就是标签值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 10</span>
<span class="token comment"># print(sr2.loc[0])  # 报错</span>
<span class="token comment"># 使用切片操作切出标签 前包后包</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 10 11 12 13</span>

<span class="token comment"># iloc[idx]里面的数字解释为索引值  也就是元素序号</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 19</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 10</span>
<span class="token comment"># 同样可以进行切片操作 切出前4行  前包后不包</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr2<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="_87"></a>数据对齐</h5> 
<blockquote> 
 <p>通过相加操作可以将两个索引不按顺序对应的数组对齐。它会自动选择相同索引处的值相加。</p> 
</blockquote> 
<pre><code class="prism language-python">sr1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sr2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sr <span class="token operator">=</span> sr1 <span class="token operator">+</span> sr2
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span>
<span class="token comment"># a    26</span>
<span class="token comment"># c    14</span>
<span class="token comment"># d    35</span>
<span class="token comment"># dtype: int64</span>

sr3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sr <span class="token operator">=</span> sr1 <span class="token operator">+</span> sr3
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span>
<span class="token comment"># a    26.0</span>
<span class="token comment"># b     NaN</span>
<span class="token comment"># c    14.0</span>
<span class="token comment"># d    35.0</span>
<span class="token comment"># dtype: float64</span>
<span class="token comment"># 一个里面有  另一个里面没有  就设置为nan</span>
<span class="token comment"># 使用函数 add sub div mul fill_value = 0 用0补齐</span>
sr <span class="token operator">=</span> sr1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>sr3<span class="token punctuation">)</span>  <span class="token comment"># 效果同上</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span>
<span class="token comment"># a    26.0</span>
<span class="token comment"># b     NaN</span>
<span class="token comment"># c    14.0</span>
<span class="token comment"># d    35.0</span>
<span class="token comment"># dtype: float64</span>
sr <span class="token operator">=</span> sr1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>sr3<span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span>
<span class="token comment"># a    26.0</span>
<span class="token comment"># b     4.0</span>
<span class="token comment"># c    14.0</span>
<span class="token comment"># d    35.0</span>
</code></pre> 
<h5><a id="_126"></a>缺失值处理</h5> 
<pre><code class="prism language-python">sr <span class="token operator">=</span> sr1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>sr3<span class="token punctuation">)</span>  <span class="token comment"># 效果同上</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># a    False</span>
<span class="token comment"># b     True</span>
<span class="token comment"># c    False</span>
<span class="token comment"># d    False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># a     True</span>
<span class="token comment"># b    False</span>
<span class="token comment"># c     True</span>
<span class="token comment"># d     True</span>
<span class="token comment"># dtype: bool</span>
<span class="token comment"># 通过上述两个函数实现空值过滤</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">[</span>sr<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 同上 丢弃nan</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将nan的值fill为0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>sr<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 除了nan之外的数组的平均值</span>

</code></pre> 
<h4><a id="DataFrame_152"></a>DataFrame</h4> 
<blockquote> 
 <p>创建二维数据表</p> 
 <p><strong><code>DataFrame</code>是<code>Series</code>的容器</strong></p> 
</blockquote> 
<h5><a id="_158"></a>通过字典创建</h5> 
<blockquote> 
 <p>创建多维数组可以<strong>先指定列名</strong>，每个列下面可以用数组添加数据。</p> 
</blockquote> 
<pre><code class="prism language-python">a <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment"># 指定列名 字典为基础创建</span>
<span class="token comment">#    a  b</span>
<span class="token comment"># 0  1  5</span>
<span class="token comment"># 1  2  6</span>
<span class="token comment"># 2  3  7</span>
<span class="token comment"># 3  4  8</span>
</code></pre> 
<h5><a id="_172"></a>初始化创建</h5> 
<blockquote> 
 <p>可以同时指定行列名，若不指定，<strong>默认为从0开始的数字作为行列名</strong>。</p> 
</blockquote> 
<pre><code class="prism language-python">t <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">"ABCD"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># index 指定行索引 columns指定列索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token comment">#    A  B   C   D</span>
<span class="token comment"># a  0  1   2   3</span>
<span class="token comment"># b  4  5   6   7</span>
<span class="token comment"># c  8  9  10  11</span>
</code></pre> 
<pre><code class="prism language-python">t <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token comment">#    0  1   2   3</span>
<span class="token comment"># 0  0  1   2   3</span>
<span class="token comment"># 1  4  5   6   7</span>
<span class="token comment"># 2  8  9  10  11</span>
</code></pre> 
<h5><a id="_195"></a>索引</h5> 
<blockquote> 
 <p>直接以<code>[]</code>的方式进行索引获得的是<strong>列数据</strong></p> 
 <p><strong><code>iloc</code>通过序号来索引行列数据</strong></p> 
 <p><strong><code>loc</code>通过标签来索引行列数据</strong></p> 
</blockquote> 
<h6><a id="_203"></a>获取列值</h6> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取A列数据</span>
<span class="token comment"># a    0</span>
<span class="token comment"># b    4</span>
<span class="token comment"># c    8</span>
<span class="token comment"># Name: A, dtype: int32</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># &lt;class 'pandas.core.series.Series'&gt;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 获取A列数据</span>
<span class="token comment"># a    0</span>
<span class="token comment"># b    4</span>
<span class="token comment"># c    8</span>
<span class="token comment"># Name: A, dtype: int32</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1列数据</span>
<span class="token comment"># a    1</span>
<span class="token comment"># b    5</span>
<span class="token comment"># c    9</span>
<span class="token comment"># Name: B, dtype: int32</span>
</code></pre> 
<h6><a id="_226"></a>获取行值</h6> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取'a'行数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 获取a行1列的数据 只能这样获取 第二维可以使数字索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 可以这样获取B列的数据</span>
<span class="token comment"># print(t.loc['a', 1]) # 报错</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 获取a行1列的数据 第二维必须是列索引标签 不能是数字序号索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取'a'行数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># &lt;class 'pandas.core.series.Series'&gt;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 同上</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 同上</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取a-c行数据</span>
<span class="token comment">#    A  B   C   D</span>
<span class="token comment"># a  0  1   2   3</span>
<span class="token comment"># b  4  5   6   7</span>
<span class="token comment"># c  8  9  10  11</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'pandas.core.frame.DataFrame'&gt;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取a~c行 A~C列</span>
<span class="token comment">#    A  B   C</span>
<span class="token comment"># a  0  1   2</span>
<span class="token comment"># b  4  5   6</span>
<span class="token comment"># c  8  9  10</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 获取a c行 A C列</span>
<span class="token comment">#    A   C</span>
<span class="token comment"># a  0   2</span>
<span class="token comment"># c  8  10</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 获取a行1列的数据 只能这样获取 第二维可以使用数字索引</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 可以这样获取B列的数据</span>
<span class="token comment"># print(t.loc['a', 1]) # 报错</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 获取a行1列的数据 第二维必须是列索引标签 不能是数字</span>

<span class="token comment"># 通过数字索引获取行数据 iloc === integer location</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 等价于t.loc['a']</span>
<span class="token comment"># A    0</span>
<span class="token comment"># B    1</span>
<span class="token comment"># C    2</span>
<span class="token comment"># D    3</span>
<span class="token comment"># Name: a, dtype: int32</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 1 0行1列数据</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 0行数据</span>
<span class="token comment"># A    0</span>
<span class="token comment"># B    1</span>
<span class="token comment"># C    2</span>
<span class="token comment"># D    3</span>

</code></pre> 
<h6><a id="_281"></a>特别注意</h6> 
<blockquote> 
 <p>通过<strong>列表获取</strong>的和<strong>直接通过行索引获取</strong>的得到的数据类型不一样。</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># A    0</span>
<span class="token comment"># B    1</span>
<span class="token comment"># C    2</span>
<span class="token comment"># D    3</span>
<span class="token comment"># Name: a, dtype: int32</span>
<span class="token comment"># &lt;class 'pandas.core.series.Series'&gt;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#    A  B  C  D</span>
<span class="token comment"># a  0  1  2  3</span>
<span class="token comment"># &lt;class 'pandas.core.frame.DataFrame'&gt;</span>
</code></pre> 
<h5><a id="_302"></a>数据对齐</h5> 
<pre><code class="prism language-python">df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'x'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'x'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df1 <span class="token operator">+</span> df2
<span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
<span class="token comment">#    x   y</span>
<span class="token comment"># a  1   7</span>
<span class="token comment"># b  2   8</span>
<span class="token comment"># c  4  10</span>
<span class="token comment"># d  5  11</span>
</code></pre> 
<pre><code class="prism language-python">df1<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>nan
df1<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>nan
<span class="token comment">#      x     y</span>
<span class="token comment"># a  1.0   7.0</span>
<span class="token comment"># b  2.0   8.0</span>
<span class="token comment"># c  4.0  10.0</span>
<span class="token comment"># d  NaN   NaN</span>
</code></pre> 
<h5><a id="_328"></a>缺失值处理</h5> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">"any"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 默认how = any  axis=0 以行为依据</span>
<span class="token comment">#      x    y</span>
<span class="token comment"># a  1.0  7.0</span>
<span class="token comment"># b  2.0  8.0</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 列属性全为nan才会删除那一行</span>
<span class="token comment">#      x     y</span>
<span class="token comment"># a  1.0   7.0</span>
<span class="token comment"># b  2.0   8.0</span>
<span class="token comment"># c  NaN  10.0</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>how<span class="token operator">=</span><span class="token string">"all"</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#      x     y</span>
<span class="token comment"># a  1.0   7.0</span>
<span class="token comment"># b  2.0   8.0</span>
<span class="token comment"># c  NaN  10.0</span>
<span class="token comment"># d  NaN   NaN</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#       y</span>
<span class="token comment"># a   7.0</span>
<span class="token comment"># b   8.0</span>
<span class="token comment"># c  10.0</span>
</code></pre> 
<h5><a id="_360"></a>排序</h5> 
<pre><code class="prism language-python">ac <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> by<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span>  <span class="token comment"># 按照列排序  行为轴</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ac<span class="token punctuation">)</span>
<span class="token comment">#    x   y</span>
<span class="token comment"># a  1   7</span>
<span class="token comment"># b  2   8</span>
<span class="token comment"># c  4  10</span>
<span class="token comment"># d  5  11</span>
ar <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> by<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 按照行排序 按照a这一行进行排序 列为轴</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ar<span class="token punctuation">)</span>
<span class="token comment">#     y  x</span>
<span class="token comment"># a   7  1</span>
<span class="token comment"># b   8  2</span>
<span class="token comment"># c  10  4</span>
<span class="token comment"># d  11  5</span>
ai <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># 按照行索引排序</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ai<span class="token punctuation">)</span>
<span class="token comment">#    x   y</span>
<span class="token comment"># d  5  11</span>
<span class="token comment"># c  4  10</span>
<span class="token comment"># b  2   8</span>
<span class="token comment"># a  1   7</span>

ai <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># 按照列索引排序</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ai<span class="token punctuation">)</span>
<span class="token comment">#     y  x</span>
<span class="token comment"># a   7  1</span>
<span class="token comment"># b   8  2</span>
<span class="token comment"># c  10  4</span>
<span class="token comment"># d  11  5</span>
</code></pre> 
<h5><a id="_394"></a>常用函数</h5> 
<blockquote> 
 <p>注意轴<code>axis</code>的作用</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 行不变列变  说明求的是每一行的平均值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 默认 列不变行变  说明求的是每一列的平均值  忽略nan值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df3<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># nan视为0</span>
</code></pre> 
<h4><a id="_405"></a>时间序列</h4> 
<h5><a id="_407"></a>普通的时间处理方式</h5> 
<pre><code class="prism language-python"><span class="token keyword">import</span> dateutil
<span class="token keyword">import</span> datetime
t <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2021-9-24'</span><span class="token punctuation">,</span> <span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>  <span class="token comment"># 将字符串解析为日期</span>
<span class="token comment"># dateutil 可以自动解析日期</span>
d <span class="token operator">=</span> dateutil<span class="token punctuation">.</span>parser<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'2020-9-24'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
d <span class="token operator">=</span> dateutil<span class="token punctuation">.</span>parser<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'2020/09/08'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
d <span class="token operator">=</span> dateutil<span class="token punctuation">.</span>parser<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'2020.09.08'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
</code></pre> 
<h5><a id="pandas_423"></a>pandas时间处理</h5> 
<h6><a id="_425"></a>产生时间序列</h6> 
<blockquote> 
 <p>自动解析任意形式的时间字符串</p> 
</blockquote> 
<pre><code class="prism language-python">pdate <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2020-09-24'</span><span class="token punctuation">,</span> <span class="token string">'2021/09/24'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 可以传入一个列表 里面是时间字符串 自动解析为DatetimeIndex</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pdate<span class="token punctuation">)</span>
<span class="token comment"># DatetimeIndex(['2020-09-24', '2021-09-24'], dtype='datetime64[ns]', freq=None)</span>
</code></pre> 
<blockquote> 
 <p>产生某个日期范围内的时间</p> 
</blockquote> 
<pre><code class="prism language-python">x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2020-01-01'</span><span class="token punctuation">,</span> <span class="token string">'2020-3-2'</span><span class="token punctuation">)</span>  <span class="token comment"># 设定起止日期点</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>从指定日期开始，连续产生指定天数，并设置产生的频率参数<code>freq</code></p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token comment"># 从指定日期开始 连续产生指定天数</span>
x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2021-9-24'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># 产生30天</span>

x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2021-09-24'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'H'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 每小时输出一个 产生10个</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
DatetimeIndex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2021-09-24 00:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 01:00:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 02:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 03:00:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 04:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 05:00:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 06:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 07:00:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 08:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 09:00:00'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              dtype<span class="token operator">=</span><span class="token string">'datetime64[ns]'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'H'</span><span class="token punctuation">)</span>

<span class="token comment"># 按照周week输出  每周日输出</span>
x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2020-09-24'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'W-SUN'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
DatetimeIndex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2020-09-27'</span><span class="token punctuation">,</span> <span class="token string">'2020-10-04'</span><span class="token punctuation">,</span> <span class="token string">'2020-10-11'</span><span class="token punctuation">,</span> <span class="token string">'2020-10-18'</span><span class="token punctuation">,</span>
               <span class="token string">'2020-10-25'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-01'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-08'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-15'</span><span class="token punctuation">,</span>
               <span class="token string">'2020-11-22'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-29'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              dtype<span class="token operator">=</span><span class="token string">'datetime64[ns]'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'W-SUN'</span><span class="token punctuation">)</span>

<span class="token comment"># 每周一输出</span>
x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2020-09-24'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'W-MON'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
DatetimeIndex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2020-09-28'</span><span class="token punctuation">,</span> <span class="token string">'2020-10-05'</span><span class="token punctuation">,</span> <span class="token string">'2020-10-12'</span><span class="token punctuation">,</span> <span class="token string">'2020-10-19'</span><span class="token punctuation">,</span>
               <span class="token string">'2020-10-26'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-02'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-09'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-16'</span><span class="token punctuation">,</span>
               <span class="token string">'2020-11-23'</span><span class="token punctuation">,</span> <span class="token string">'2020-11-30'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              dtype<span class="token operator">=</span><span class="token string">'datetime64[ns]'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'W-MON'</span><span class="token punctuation">)</span>

<span class="token comment"># 工作日输出  只输出工作日</span>
x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2021-09-24'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">)</span>  <span class="token comment"># Business</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
DatetimeIndex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2021-09-24'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-27'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-28'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-29'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-30'</span><span class="token punctuation">,</span> <span class="token string">'2021-10-01'</span><span class="token punctuation">,</span> <span class="token string">'2021-10-04'</span><span class="token punctuation">,</span> <span class="token string">'2021-10-05'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-10-06'</span><span class="token punctuation">,</span> <span class="token string">'2021-10-07'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              dtype<span class="token operator">=</span><span class="token string">'datetime64[ns]'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">)</span>

<span class="token comment"># 每隔1h20min输出一个</span>
x <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2021-09-24'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'1h20min'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
DatetimeIndex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'2021-09-24 00:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 01:20:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 02:40:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 04:00:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 05:20:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 06:40:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 08:00:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 09:20:00'</span><span class="token punctuation">,</span>
               <span class="token string">'2021-09-24 10:40:00'</span><span class="token punctuation">,</span> <span class="token string">'2021-09-24 12:00:00'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              dtype<span class="token operator">=</span><span class="token string">'datetime64[ns]'</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">'80T'</span><span class="token punctuation">)</span>

</code></pre> 
<h6><a id="_495"></a>时间序列的应用</h6> 
<blockquote> 
 <p>将时间序列作为一维甚至多维数据的行索引</p> 
</blockquote> 
<pre><code class="prism language-python">sr <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">'2020-01-01'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>日期索引 比如查看2020年2月的数据 或者只查看2020年的数据</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">[</span><span class="token string">'2020-2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 2020-02-01    31</span>
<span class="token comment"># 2020-02-02    32</span>
<span class="token comment"># 2020-02-03    33</span>
<span class="token comment"># ...</span>
<span class="token comment"># 2020-02-27    57</span>
<span class="token comment"># 2020-02-28    58</span>
<span class="token comment"># 2020-02-29    59</span>
<span class="token comment"># Freq: D, dtype: int32</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">[</span><span class="token string">'2020'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> 
<blockquote> 
 <p>日期进行切片，查看某个时间范围内的数据</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>sr<span class="token punctuation">[</span><span class="token string">'2017'</span><span class="token punctuation">:</span><span class="token string">'2018-02'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 2017-01-01    366</span>
<span class="token comment"># 2017-01-02    367</span>
<span class="token comment"># 2017-01-03    368</span>
<span class="token comment"># 2017-01-04    369</span>
<span class="token comment"># 2017-01-05    370</span>
<span class="token comment">#              ...</span>
<span class="token comment"># 2018-02-24    785</span>
<span class="token comment"># 2018-02-25    786</span>
<span class="token comment"># 2018-02-26    787</span>
<span class="token comment"># 2018-02-27    788</span>
<span class="token comment"># 2018-02-28    789</span>
<span class="token comment"># Freq: D, Length: 424, dtype: int32</span>
</code></pre> 
<blockquote> 
 <p>按照<strong>某个标准进行重采样</strong> 比如按周求和、按月求和、求均值等操作。</p> 
</blockquote> 
<pre><code class="prism language-python">sw <span class="token operator">=</span> sr<span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">'W'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 按周求和</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sw<span class="token punctuation">)</span>
<span class="token comment"># 2016-01-03       3</span>
<span class="token comment"># 2016-01-10      42</span>
<span class="token comment"># 2016-01-17      91</span>
<span class="token comment"># 2016-01-24     140</span>
<span class="token comment"># 2016-01-31     189</span>
<span class="token comment">#               ...</span>
<span class="token comment"># 2018-09-02    6804</span>
<span class="token comment"># 2018-09-09    6853</span>
<span class="token comment"># 2018-09-16    6902</span>
<span class="token comment"># 2018-09-23    6951</span>

sm <span class="token operator">=</span> sr<span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">'M'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 按月求和</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sm<span class="token punctuation">)</span>
<span class="token comment"># 2016-01-31      465</span>
<span class="token comment"># 2016-02-29     1305</span>
<span class="token comment"># 2016-03-31     2325</span>
<span class="token comment"># 2016-04-30     3165</span>
<span class="token comment"># 2016-05-31     4216</span>
<span class="token comment"># 2016-06-30     4995</span>
<span class="token comment"># 2016-07-31     6107</span>
<span class="token comment"># 2016-08-31     7068</span>
<span class="token comment"># 2016-09-30     7755</span>
<span class="token comment"># 2016-10-31     8959</span>
<span class="token comment"># 2016-11-30     9585</span>
<span class="token comment"># 2016-12-31    10850</span>
<span class="token comment"># 2017-01-31    11811</span>
<span class="token comment"># 2017-02-28    11494</span>
<span class="token comment"># 2017-03-31    13640</span>
<span class="token comment"># 2017-04-30    14115</span>
<span class="token comment"># 2017-05-31    15531</span>
<span class="token comment"># 2017-06-30    15945</span>
<span class="token comment"># 2017-07-31    17422</span>
<span class="token comment"># 2017-08-31    18383</span>
</code></pre> 
<h6><a id="csv_576"></a>csv文件读取及时间序列转换</h6> 
<blockquote> 
 <p>test.csv</p> 
</blockquote> 
<table><thead><tr><th align="center"></th><th align="center">date</th><th align="center">open</th><th align="center">close</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">2020/3/1</td><td align="center">1000</td><td align="center">2000</td></tr><tr><td align="center">1</td><td align="center">2020/3/2</td><td align="center">1001</td><td align="center">2001</td></tr><tr><td align="center">2</td><td align="center">2020/3/3</td><td align="center">1002</td><td align="center">2002</td></tr><tr><td align="center">3</td><td align="center">2020/3/4</td><td align="center">1003</td><td align="center">2003</td></tr><tr><td align="center">4</td><td align="center">2020/3/5</td><td align="center">1004</td><td align="center">2004</td></tr><tr><td align="center">5</td><td align="center">2020/3/6</td><td align="center">1005</td><td align="center">2005</td></tr><tr><td align="center">6</td><td align="center">2020/3/7</td><td align="center">1006</td><td align="center">2006</td></tr><tr><td align="center">7</td><td align="center">2020/3/8</td><td align="center">1007</td><td align="center">2007</td></tr><tr><td align="center">8</td><td align="center">2020/3/9</td><td align="center">1008</td><td align="center">2008</td></tr><tr><td align="center">9</td><td align="center">2020/3/10</td><td align="center">1009</td><td align="center">2009</td></tr></tbody></table> 
<blockquote> 
 <p>读取csv文件</p> 
</blockquote> 
<pre><code class="prism language-python">csv <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>csv<span class="token punctuation">)</span>
<span class="token comment">#    Unnamed: 0       date    open   close</span>
<span class="token comment"># 0           0   2020/3/1  1000.0  2000.0</span>
<span class="token comment"># 1           1   2020/3/2  1001.0  2001.0</span>
<span class="token comment"># 2           2   2020/3/3  1002.0  2002.0</span>
<span class="token comment"># 3           3   2020/3/4  1003.0  2003.0</span>
<span class="token comment"># 4           4   2020/3/5  1004.0  2004.0</span>
<span class="token comment"># 5           5   2020/3/6  1005.0  2005.0</span>
<span class="token comment"># 6           6   2020/3/7  1006.0  2006.0</span>
<span class="token comment"># 7           7   2020/3/8  1007.0  2007.0</span>
<span class="token comment"># 8           8   2020/3/9  1008.0  2008.0</span>
<span class="token comment"># 9           9  2020/3/10  1009.0  2009.0</span>
<span class="token comment"># 希望以第0列作为索引 但是默认第0列被视为unamed行</span>
</code></pre> 
<blockquote> 
 <p>指定某列作为行索引</p> 
</blockquote> 
<pre><code class="prism language-python">csv <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">'date'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>csv<span class="token punctuation">)</span>
<span class="token comment">#           Unnamed: 0    open   close</span>
<span class="token comment"># date</span>
<span class="token comment"># 2020/3/1            0  1000.0  2000.0</span>
<span class="token comment"># 2020/3/2            1  1001.0  2001.0</span>
<span class="token comment"># 2020/3/3            2  1002.0  2002.0</span>
<span class="token comment"># 2020/3/4            3  1003.0  2003.0</span>
<span class="token comment"># 2020/3/5            4  1004.0  2004.0</span>
<span class="token comment"># 2020/3/6            5  1005.0  2005.0</span>
<span class="token comment"># 2020/3/7            6  1006.0  2006.0</span>
<span class="token comment"># 2020/3/8            7  1007.0  2007.0</span>
<span class="token comment"># 2020/3/9            8  1008.0  2008.0</span>
<span class="token comment"># 2020/3/10           9  1009.0  2009.0</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>csv<span class="token punctuation">.</span>index<span class="token punctuation">)</span>  <span class="token comment"># 输出索引  可以看出其类型为Index对象</span>
<span class="token comment"># Index(['2020/3/1', '2020/3/2', '2020/3/3', '2020/3/4', '2020/3/5', '2020/3/6',</span>
<span class="token comment">#        '2020/3/7', '2020/3/8', '2020/3/9', '2020/3/10'],</span>
<span class="token comment">#       dtype='object', name='date')</span>
</code></pre> 
<blockquote> 
 <p>将<code>csv</code>文件中的<strong>日期转换为<code>DatetimeIndex</code>对象</strong>，便于之后索引。<br> 可以在<code>read_csv</code>函数中添加参数<code>parse_date</code>的值为<code>True</code>或者日期所在的列名(如<code>date</code>)。</p> 
</blockquote> 
<pre><code class="prism language-python">c <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">'date'</span><span class="token punctuation">,</span> parse_dates<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token string">'date'</span><span class="token punctuation">,</span> parse_dates<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token comment"># DatetimeIndex(['2020-03-01', '2020-03-02', '2020-03-03', '2020-03-04',</span>
<span class="token comment">#                '2020-03-05', '2020-03-06', '2020-03-07', '2020-03-08',</span>
<span class="token comment">#                '2020-03-09', '2020-03-10'],</span>
<span class="token comment">#               dtype='datetime64[ns]', name='date', freq=None)</span>
</code></pre> 
<blockquote> 
 <p>为csv文件添加<strong>列索引名</strong> 也就是设置<code>header</code>参数为<code>None</code>，自定义列索引名<code>names</code></p> 
</blockquote> 
<pre><code class="prism language-python">c <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'test.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
           a     b     c
<span class="token number">0</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">1</span>  <span class="token number">1000</span>  <span class="token number">2000</span>
<span class="token number">1</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">2</span>  <span class="token number">1001</span>  <span class="token number">2001</span>
<span class="token number">2</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span>  <span class="token number">1002</span>  <span class="token number">2002</span>
<span class="token number">3</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">4</span>  <span class="token number">1003</span>  <span class="token number">2003</span>
<span class="token number">4</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">5</span>  <span class="token number">1004</span>  <span class="token number">2004</span>
<span class="token number">5</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">6</span>  <span class="token number">1005</span>  <span class="token number">2005</span>
<span class="token number">6</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">7</span>  <span class="token number">1006</span>  <span class="token number">2006</span>
<span class="token number">7</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">8</span>  <span class="token number">1007</span>  <span class="token number">2007</span>
<span class="token number">8</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">9</span>  <span class="token number">1008</span>  <span class="token number">2008</span>
<span class="token number">9</span>  <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span>  <span class="token number">1009</span>  <span class="token number">2009</span>
</code></pre> 
<h6><a id="csv_667"></a>csv文件中的缺失值处理</h6> 
<blockquote> 
 <p>a.csv</p> 
</blockquote> 
<table><thead><tr><th align="center">0</th><th align="center">2020/3/1</th><th align="center">1000</th><th align="center">2000</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">2020/3/2</td><td align="center">1001</td><td align="center">2001</td></tr><tr><td align="center">2</td><td align="center">2020/3/3</td><td align="center">1002</td><td align="center">2002</td></tr><tr><td align="center">3</td><td align="center">2020/3/4</td><td align="center"><strong>NaN</strong></td><td align="center">2003</td></tr><tr><td align="center">4</td><td align="center">2020/3/5</td><td align="center">1004</td><td align="center">2004</td></tr><tr><td align="center">5</td><td align="center">2020/3/6</td><td align="center">1005</td><td align="center">2005</td></tr><tr><td align="center">6</td><td align="center">2020/3/7</td><td align="center">1006</td><td align="center">2006</td></tr><tr><td align="center">7</td><td align="center">2020/3/8</td><td align="center">1007</td><td align="center">2007</td></tr><tr><td align="center">8</td><td align="center">2020/3/9</td><td align="center">1008</td><td align="center">2008</td></tr><tr><td align="center">9</td><td align="center">2020/3/10</td><td align="center">1009</td><td align="center">2009</td></tr></tbody></table> 
<pre><code class="prism language-python">c <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'a.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># 列索引为数字序号 默认</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
   <span class="token number">0</span>          <span class="token number">1</span>     <span class="token number">2</span>     <span class="token number">3</span>
<span class="token number">0</span>  <span class="token number">0</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">1</span>  <span class="token number">1000</span>  <span class="token number">2000</span>
<span class="token number">1</span>  <span class="token number">1</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">2</span>  <span class="token number">1001</span>  <span class="token number">2001</span>
<span class="token number">2</span>  <span class="token number">2</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span>  <span class="token number">1002</span>  <span class="token number">2002</span>
<span class="token number">3</span>  <span class="token number">3</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">4</span>  NaN   <span class="token number">2003</span>
<span class="token number">4</span>  <span class="token number">4</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">5</span>  <span class="token number">1004</span>  <span class="token number">2004</span>
<span class="token number">5</span>  <span class="token number">5</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">6</span>  <span class="token number">1005</span>  <span class="token number">2005</span>
<span class="token number">6</span>  <span class="token number">6</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">7</span>  <span class="token number">1006</span>  <span class="token number">2006</span>
<span class="token number">7</span>  <span class="token number">7</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">8</span>  <span class="token number">1007</span>  <span class="token number">2007</span>
<span class="token number">8</span>  <span class="token number">8</span>   <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">9</span>  <span class="token number">1008</span>  <span class="token number">2008</span>
<span class="token number">9</span>  <span class="token number">9</span>  <span class="token number">2020</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span>  <span class="token number">1009</span>  <span class="token number">2009</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 打印第二列</span>
<span class="token comment"># 0    1000.0</span>
<span class="token comment"># 1    1001.0</span>
<span class="token comment"># 2    1002.0</span>
<span class="token comment"># 3       NaN</span>
<span class="token comment"># 4    1004.0</span>
<span class="token comment"># 5    1005.0</span>
<span class="token comment"># 6    1006.0</span>
<span class="token comment"># 7    1007.0</span>
<span class="token comment"># 8    1008.0</span>
<span class="token comment"># 9    1009.0</span>
<span class="token comment"># Name: 2, dtype: float64</span>
<span class="token comment"># NaN被识别为float型数</span>

<span class="token comment"># 将NaN改成None</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 0    1000</span>
<span class="token comment"># 1    1001</span>
<span class="token comment"># 2    1002</span>
<span class="token comment"># 3    None</span>
<span class="token comment"># 4    1004</span>
<span class="token comment"># 5    1005</span>
<span class="token comment"># 6    1006</span>
<span class="token comment"># 7    1007</span>
<span class="token comment"># 8    1008</span>
<span class="token comment"># 9    1009</span>
<span class="token comment"># Name: 2, dtype: object</span>
<span class="token comment"># None被识别为object</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># &lt;class 'str'&gt; 因为一列的所有数据为同一类型 因此被识别为str对象</span>
</code></pre> 
<blockquote> 
 <p>需要将csv文件中的<code>None</code>转换为<code>NaN</code>，<code>na_values</code>指将<code>None</code>识别为<code>NaN</code></p> 
</blockquote> 
<pre><code class="prism language-python">c <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'a.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> na_values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'None'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token comment">#    0          1       2     3</span>
<span class="token comment"># 0  0   2020/3/1  1000.0  2000</span>
<span class="token comment"># 1  1   2020/3/2  1001.0  2001</span>
<span class="token comment"># 2  2   2020/3/3  1002.0  2002</span>
<span class="token comment"># 3  3   2020/3/4     NaN  2003</span>
</code></pre> 
<pre><code class="prism language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 可以看出None变成了NaN 并且类型变为浮点数</span>
<span class="token comment"># 0    1000.0</span>
<span class="token comment"># 1    1001.0</span>
<span class="token comment"># 2    1002.0</span>
<span class="token comment"># 3       NaN</span>
<span class="token comment"># Name: 2, dtype: float64</span>
</code></pre> 
<blockquote> 
 <p>将<code>None</code>替换为<code>NaN</code>之后，存进csv文件(<code>to_csv</code>)，但是<code>NaN</code>在文件中默认不显示的，因此需要指定<code>na_rep</code>参数来替换<code>NaN</code>，此处<strong>替换为字符串<code>null</code></strong>。</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token comment"># 将数据写进csv</span>
c<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'out.csv'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> na_rep<span class="token operator">=</span><span class="token string">'null'</span><span class="token punctuation">)</span>
<span class="token comment"># 默认NaN在csv文件中不显示，因此需要用na_seq参数来指定NaN处显示的值</span>
<span class="token comment"># columns指定显示的列数 header指定是否显示列名 index指定是否要显示行索引</span>
</code></pre> 
<blockquote> 
 <p>out.csv</p> 
</blockquote> 
<table><thead><tr><th align="center">0</th><th align="center">2020/3/1</th><th align="center">1000</th><th align="center">2000</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">2020/3/2</td><td align="center">1001</td><td align="center">2001</td></tr><tr><td align="center">2</td><td align="center">2020/3/3</td><td align="center">1002</td><td align="center">2002</td></tr><tr><td align="center">3</td><td align="center">2020/3/4</td><td align="center">null</td><td align="center">2003</td></tr><tr><td align="center">4</td><td align="center">2020/3/5</td><td align="center">1004</td><td align="center">2004</td></tr><tr><td align="center">5</td><td align="center">2020/3/6</td><td align="center">1005</td><td align="center">2005</td></tr><tr><td align="center">6</td><td align="center">2020/3/7</td><td align="center">1006</td><td align="center">2006</td></tr><tr><td align="center">7</td><td align="center">2020/3/8</td><td align="center">1007</td><td align="center">2007</td></tr><tr><td align="center">8</td><td align="center">2020/3/9</td><td align="center">1008</td><td align="center">2008</td></tr><tr><td align="center">9</td><td align="center">2020/3/10</td><td align="center">1009</td><td align="center">2009</td></tr></tbody></table>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/990a8047ef6236ea6d5433bdcb62c693/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">用树莓派操控Arduino转动舵机到特定角度(5行代码)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3f8324c53632322d94aacf12e181c871/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mvcc1</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>