<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言字符串 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C语言字符串" />
<meta property="og:description" content="字符串 c 语言没有专门用于存储字符串的变量类型，字符串都被存储在 char 类型的数组中。数组由连续的存储单元组成，字符串中的字符被存储在相邻的存储单元中，每个单元存储一个字符，c 语言用数组末尾的字符 \o 标记字符串的结束。
c 中的字符串一定是以空字符结束，这意味着数组的容量必须至少比待存储字符串的字符数多 1，以上图中有14个存储单元，却只能存储13个字符，剩下一个字节留给空字符。 字符串常量 用双引号括起来的内容称为字符串的字面量，也叫做字符串常量。双引号中的字符和编译器自动加入末尾的 \0 字符，都作为字符串存储在内存中，如：” hello world ! ” 、” good morning “ 、 “ i am a student ” 都是字符串字面量。另外注意一点，你的字符串字面量之间如果没有间隔，或用空白字符分隔，c 会自动将它们串联起来。
#include&lt;stdio.h&gt; int main(void) { char a[]=&#34;hello &#34;&#34;world &#34; &#34;!&#34;; char b[]=&#34;hello world !&#34;; printf(&#34;a[]=%s b[]=%s\n&#34;,a,b); return 0; } 它们的输出是相同的：
字符串变量 我们字符串变量一般有两种方法创建，指针或者是数组
#include&lt;stdio.h&gt; int main(void) { char a[]=&#34;hello world !&#34;; //数组 char* b=&#34; hello world !&#34;; //指针 } 数组形式（ a [ ] ）在计算机的内存中分配为一个内含14个元素的数组，每个元素初始化为字符串字面量对应的字符。通常，字符串都作为可执行文件的一部分存储在数据段中。当把程序载入内存时，也载入了程序中的字符串。字符串存储在静态存储区中，但是，程序在开始运行时才会为该数组分配内存。此时才将字符串拷贝到数组中，此时字符串有两份，一个是在静态内存中的字符串字面量，另一个是存储在 a[ ] 数组中的字符串。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/89580f0979e24ab458979e672422dfbd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-25T08:58:55+08:00" />
<meta property="article:modified_time" content="2022-04-25T08:58:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言字符串</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <blockquote> 
 <p id="main-toc"></p> 
 <hr id="hr-toc"> 
 <p></p> 
 <p></p> 
 <h3 id="%E5%AD%97%E7%AC%A6%E4%B8%B2">字符串</h3> 
 <p>    c 语言没有专门用于存储字符串的变量类型，字符串都被存储在 char 类型的数组中。数组由连续的存储单元组成，字符串中的字符被存储在相邻的存储单元中，每个单元存储一个字符，c 语言用数组末尾的字符 \o 标记字符串的结束。</p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f2/67/25oAPsm8_o.png">      c 中的字符串一定是以空字符结束，这意味着数组的容量必须至少比待存储字符串的字符数多 1，以上图中有14个存储单元，却只能存储13个字符，剩下一个字节留给空字符。      </p> 
 <h4 id="%C2%A0%20%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B8%B8%E9%87%8F"></h4> 
 <h4></h4> 
 <h4 id="%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B8%B8%E9%87%8F">字符串常量</h4> 
 <p>     用双引号括起来的内容称为字符串的字面量，也叫做字符串常量。双引号中的字符和编译器自动加入末尾的 \0 字符，都作为字符串存储在内存中，如：<em>” hello world ! ” 、” good morning “ 、 “ i am a student ”</em> 都是字符串字面量。另外注意一点，你的字符串字面量之间如果没有间隔，或用空白字符分隔，c 会自动将它们串联起来。</p> 
 <pre><code>#include&lt;stdio.h&gt;
int main(void)
{
	char a[]="hello ""world "   "!";
	char b[]="hello world !";

	printf("a[]=%s     b[]=%s\n",a,b);
	
	return 0;
	
}

</code></pre> 
 <p>它们的输出是相同的：</p> 
 <p><img alt="" src="https://images2.imgbox.com/3d/0a/kOhlw8Fi_o.png"></p> 
 <p></p> 
 <p></p> 
 <h4></h4> 
 <h4 id="%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%98%E9%87%8F">字符串变量</h4> 
 <p>我们字符串变量一般有两种方法创建，指针或者是数组</p> 
 <pre><code>#include&lt;stdio.h&gt;
int main(void)
{
	char a[]="hello world !";   //数组
	char* b=" hello world !";   //指针
	
}</code></pre> 
 <p>    <span style="background-color:#38d8f0;">数组形式</span>（ a [ ] ）在计算机的内存中分配为一个内含14个元素的数组，每个元素初始化为字符串字面量对应的字符。通常，字符串都作为可执行文件的一部分存储在数据段中。当把程序载入内存时，也载入了程序中的字符串。字符串存储在静态存储区中，但是，程序在开始运行时才会为该数组分配内存。此时才将字符串拷贝到数组中，此时字符串有两份，一个是在静态内存中的字符串字面量，另一个是存储在 a[ ] 数组中的字符串。</p> 
 <p>文字有点晦涩，我们结合图看看  </p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/19/17/jlFLMnVo_o.gif"></p> 
 <p></p> 
 <p> <span style="background-color:#a2e043;">指针形式</span>（ *b ）也使得编译器为字符串在静态存储区预留14个元素的空间。一旦开始执行程序，它会把字符串地址存储在指针变量中。该变量指向该字符串的首字符。 </p> 
 <p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/af/9f/LUC4IJ1f_o.gif"></p> 
 <p></p> 
 <p>其实不用关心太多，你只要知道，初始化数组把静态存储区的字符串拷贝到数组中，你的数组得到的只是它的副本，而初始化指针只把字符串的地址拷贝给指针，你得的是静态存储区字符串的地址。</p> 
 <h4></h4> 
 <h4></h4> 
 <h3 id="%E6%95%B0%E7%BB%84%E5%92%8C%E6%8C%87%E9%92%88%E7%9A%84%E9%80%89%E6%8B%A9%EF%BC%9A">数组和指针的选择：</h3> 
 <p>     那么我们用数组还是用指针呢？它们一个存着地址一个存着副本，所以肯定是有差别的对吧，我们精简的了解一下，因为书上真的很复杂写了一大堆的例子，我们提取一下精华：</p> 
 <p>     字符串字面量是 const 的数据（常量），由于 *b 指向这个 const 数据，所以实际上 b 是 <em>const  char * b</em> ，但是由于历史的原因，编译器接受不带 const 的写法，这意味这不能用 b 改变它指向的数据，但是仍然可以改变 b 的值，就是让 b 指向别的位置。如果把一个字符串字面量拷贝给一个数组，就可以随意改变数据，除非把数组声明为 const，数组元素是变量，但是数组名不是变量。</p> 
 <pre><code>#include&lt;stdio.h&gt;
int main(void)
{
	char a[]="hello world !";  //数组
	a[0]='H';
	printf("a[]=%s\n",a);
	
	char* b="hello world !";   //指针
	b[0]='H';   
	printf("*s=%s\n",b);
	
	return 0;
	
}

</code></pre> 
 <p style="text-align:center;"></p> 
 <p>    <img alt="" src="https://images2.imgbox.com/1f/97/7JEZy6WH_o.gif">     </p> 
 <p>我用的是 Dev -C++ ，在我电脑上编译它过了，但是这个指针形式并没有输出，这就很好的证明了上面说的对吧，你用指针你不能修改字符串字面量（字符串常量），因为你的指针是 <em>const char *</em>，所以你可以在把指针初始化为字符串字面量时使用 const 限定符：<strong>const char * b</strong>，书上推荐我们这样用，这也是比较安全的做法，看见 const 我们就知道不能去修改它。<span style="background-color:#dad5e9;">总之，初始化数组把静态存储区的字符串拷贝到数组中，而初始化指针只把字符串的地址拷贝给指针</span>，如何选择取决于你想用程序做什么，如果你要去构造一个字符串→数组，如果你要处理一个字符串→指针。</p> 
 <h4></h4> 
 <h4 id="%E8%A1%A5%E5%85%85">补充</h4> 
 <p>       再说一下指针，就是当你用多个指针初始化的字符串字面量是一样的，它们得到的是同一个地址，编译器可以使用内存中的一个副本表示所以完全相同的字符串字面量。</p> 
 <pre><code>#include&lt;stdio.h&gt;
int main(void)
{
	char* a="hello world !"; 
	char* b="hello world !"; 
	char* c="hello world !"; 
	
	printf("a= %p\n",a);
	printf("b= %p\n",b);
	printf("c= %p\n",a);
	
	return 0;
	
}

</code></pre> 
 <p>你看它们的地址是不是一模一样</p> 
 <p><img alt="" src="https://images2.imgbox.com/3f/ea/OfW8Tcko_o.png"></p> 
 <p style="text-align:center;"></p> 
 <p> 所以你有没有懂懂一点点这个(你初始化指针是 const )，如果允许你修改的话：</p> 
 <p>    char* a="hello world !"; <br>     char* b="hello world !"; <br>     char* c="hello world !"; <br>     <br>     printf("a= %p\n",a);<br>     a[0]='y';               <br>     printf("b= %p\n",b);<br>     printf("c= %p\n",a);</p> 
 <p>那后面两个输出都变成“ yello world ”，如果编译器使用这种单次副本表示法，并允许 a[ 0 ] 修改 ‘ h ’，那将影响所有使用该字符串的代码。而把数组初始化为字符串字面量却不会导致类似问题，因为数组获得的原始字符串的副本。总之，<span style="background-color:#dad5e9;">如果你打算修改字符串，就不要用指针去初始化</span>。<br>     </p> 
</blockquote> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d70ad0281389b8e12d550a64505ea144/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Jenkins如何使用以及配置环境</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/cf7147da1f8447ed9273fd25434d8bae/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">嵌入式开发使用 GCC编译器警告错误问题</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>