<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>shell脚本基础 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="shell脚本基础" />
<meta property="og:description" content="shell脚本基础 1.变量 1.1什么是变量 变量即可以变化的量
[root@lwq ~]# a=1 [root@lwq ~]# a=2 [root@lwq ~]# echo $a 2 1.2变量名称注意事项 只能包含字母，数字，下划线，并且不能以数字开头不应该跟系统中已有的环境变量重名，尽量不要全部使用大写，尽量不要用“-”下划线开头 [rot@lwq ~]# ppp=1 [root@lwq ~]# echo $ppp 1 最好做到见名知义不能使用程序中的保留字，例如if,for等变量名区分大小写变量名中有多个单词时有两种方法表示 单词间使用下划线分隔 首单词小写，后面单词的首字母大写 teacherName=tom studentName=jerry teacher_name=tom student_name=jerry 变量作用：
保存表达式运算的结果至内存，方便复用或更改
若无变量而需复用表达式运算的结果只能重新运算，耗时较长
可以把变量理解为一个存储信息的容器
[root@lwq ~]# mkdir test;cd test;echo &#39;hello world&#39; &gt; abc [root@lwq test]# ls abc [root@lwq test]# cat abc hello world [root@lwq ~]# a=$(pwd;ls) [root@lwq ~]# echo $a /root 2019.sh anaconda-ks.cfg 1.3变量类型 字符型数值型 整型 浮点型布尔型 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/e9c8aafb3e44ceb4b0b6a1b43cc04f55/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-06-20T11:50:33+08:00" />
<meta property="article:modified_time" content="2019-06-20T11:50:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">shell脚本基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="shell_0"></a>shell脚本基础</h2> 
<h3><a id="1_1"></a>1.变量</h3> 
<h4><a id="11_2"></a>1.1什么是变量</h4> 
<p>变量即可以变化的量</p> 
<pre><code>[root@lwq ~]# a=1
[root@lwq ~]# a=2
[root@lwq ~]# echo $a
2
</code></pre> 
<h4><a id="12_10"></a>1.2变量名称注意事项</h4> 
<ul><li>只能包含字母，数字，下划线，并且不能以数字开头</li><li>不应该跟系统中已有的环境变量重名，尽量不要全部使用大写，尽量不要用“-”下划线开头</li></ul> 
<pre><code>[rot@lwq ~]# ppp=1
[root@lwq ~]# echo $ppp
1
</code></pre> 
<ul><li>最好做到见名知义</li><li>不能使用程序中的保留字，例如if,for等</li><li>变量名区分大小写</li><li>变量名中有多个单词时有两种方法表示</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 单词间使用下划线分隔</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 首单词小写，后面单词的首字母大写</li></ul> 
<pre><code>teacherName=tom
studentName=jerry

teacher_name=tom
student_name=jerry
</code></pre> 
<p><strong>变量作用：</strong><br> 保存表达式运算的结果至内存，方便复用或更改<br> 若无变量而需复用表达式运算的结果只能重新运算，耗时较长<br> 可以把变量理解为一个存储信息的容器</p> 
<pre><code>[root@lwq ~]# mkdir test;cd test;echo 'hello world' &gt; abc
[root@lwq test]# ls
abc
[root@lwq test]# cat abc
hello world
</code></pre> 
<pre><code>[root@lwq ~]# a=$(pwd;ls)
[root@lwq ~]# echo $a
/root  2019.sh  anaconda-ks.cfg  
</code></pre> 
<h4><a id="13_50"></a>1.3变量类型</h4> 
<ul><li>字符型</li><li>数值型</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 整型</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 浮点型</li><li>布尔型</li></ul> 
<h4><a id="14_58"></a>1.4变量操作</h4> 
<ul><li>设置变量</li><li>引用变量（单引号 双引号 $引用变量）</li></ul> 
<pre><code>[root@lwq ~]# a=10
[root@lwq ~]# echo $a
10
[root@lwq ~]# echo '$a'
$a
[root@lwq ~]# echo "$a"
10```
[root@lwq ~]# cat &gt; abc &lt;&lt;EOF
&gt; $a
&gt; bb
&gt; cc
&gt; EOF
[root@lwq ~]# cat abc
10
bb
cc
[root@lwq ~]# cat &gt; abc &lt;&lt;'EOF'
&gt; $a
&gt; bb
&gt; cc
&gt; EOF
[root@lwq ~]# cat abc
$a
bb
cc
</code></pre> 
<ul><li>撤销变量</li></ul> 
<pre><code>[root@lwq ~]# a=10
[root@lwq ~]# echo $a
10
[root@lwq ~]# unset a
[root@lwq ~]# echo $a

[root@lwq ~]# 
</code></pre> 
<h4><a id="15bash_103"></a>1.5bash变量类型</h4> 
<ul><li>环境变量</li><li>本地变量（局部变量）</li><li>位置变量</li><li>特殊变量（bash内置的，用来保存某些特殊数据的变量，也称系统变量）</li></ul> 
<h4><a id="151_109"></a>1.5.1本地变量</h4> 
<ol><li>VAR-NAME=VALUE 本地变量（只在本地生效），作用域为当前shell进程。对当前shell外的其他进程，包括当前shell的父shell,子shell进程均无效<br> <code>[root@lwq ~]# yum -y install psmisc</code><br> <code>[root@lwq ~]# pstree</code></li></ol> 
<pre><code>[root@lwq ~]# vim liu.sh
#!/bin/bash

teacher_name1=tom
teacher_name2=tom2
student_name1=jerry
student_name2=jerry2

echo $teacher_name1

[root@lwq ~]# bash liu.sh
tom
[root@lwq ~]# echo $teacher_name1
[root@lwq ~]# bash liu.sh
tom
</code></pre> 
<ol start="2"><li>local VAR-NAME=VALUE 局部变量，作用域为当前代码段，常用于函数</li></ol> 
<h4><a id="152_134"></a>1.5.2环境变量</h4> 
<p>export VAR-NAME=VALUE 作用域为当前shell进程及其子进程</p> 
<pre><code>[root@lwq ~]# export a=50
[root@lwq ~]# echo $a
50
[root@lwq ~]# bash
[root@lwq ~]# pstree
sshd───sshd───bash───bash───pstree
[root@lwq ~]# bash
[root@lwq ~]# bash
[root@lwq ~]# pstree
sshd───sshd───bash───bash───bash───bash───pstree
exit
</code></pre> 
<h4><a id="153_149"></a>1.5.3位置变量</h4> 
<p><strong>$1,$2,$3,… 用来引用脚本的参数<br> shift [num] 位置变量使用完以后退出，后面的参数向前推进</strong></p> 
<pre><code>[root@lwq ~]# vim 2019.sh
#!/bin/bash

lzy=$1
lan=$2

echo $lzy
echo -------
echo $lan

[root@lwq ~]# bash 2019.sh linux natasha
linux
-------
natasha
</code></pre> 
<pre><code>[root@lwq ~]# vim qinggong.sh
#!/bin/bash

lzy=$1
lan=$2
qinggong=$3
shihao=$4

for i in $*;do
    echo $lzy
    echo $lan
    echo $qinggong
    echo $shihao
    echo -----
    shift 2

done
[root@lwq ~]# bash 2019.sh linux natasha qinggong shihao
linux
natasha
qinggong
shihao
-----
linux
natasha
qinggong
shihao
-----
linux
natasha
qinggong
shihao
-----
linux
natasha
qinggong
shihao
-----

</code></pre> 
<pre><code>[root@lwq ~]# vim liu.sh
#!/bin/bash

linux=$1
natasha=$2
ppp=$3

echo $linux 
shift 2
echo $natasha
shift 2
echo $ppp
shift 2

[root@lwq ~]# bash liu.sh linux natasha
linux
natasha
</code></pre> 
<h4><a id="154_233"></a>1.5.4特殊变量</h4> 
<p>$# 是传给脚本的参数个数</p> 
<pre><code>[root@lwq ~]# vim qinggong.sh
#!/bin/bash

echo $#
[root@lwq ~]# bash qinggong.sh 
0
</code></pre> 
<p>$0 是脚本本身的名字</p> 
<pre><code>[root@lwq ~]# vim qinggong.sh 
#!/bin/bash

echo $0
[root@lwq ~]# bash qinggong.sh 1 2 3 4
qinggong.sh
[root@lwq ~]# chmod +x qinggong.sh
[root@lwq ~]# ./qinggong.sh 
./qinggong.sh
</code></pre> 
<p>$! 是shell最后运行的后台Process进程的PID</p> 
<pre><code>[root@lwq ~]# vim qinggong.sh 
#!/bin/bash

a=1
echo $a
echo $!
[root@lwq ~]# bash qinggong.sh
1
</code></pre> 
<p>$@ 是传给脚本的所有参数的列表</p> 
<pre><code>[root@lwq ~]# vim qinggong.sh
#!/bin/bash

echo $@
[root@lwq ~]# bash qinggong.sh 1 2 3 4
1 2 3 4
</code></pre> 
<p>$* 是以一个单字符串显示所有向脚本传递的参数，与位置变量不同，参数可超过9个</p> 
<pre><code>[root@lwq ~]# vim qinggong.sh
#!/bin/bash

echo $*
[root@lwq ~]# bash qinggong.sh 1 2 3 4
1 2 3 4
</code></pre> 
<pre><code>$$脚本运行当前进程id号
[root@lwq ~]# vim qinggong.sh 
#!/bin/bash

echo $$
[root@lwq ~]# bash qinggong.sh 
8760
[root@lwq ~]# ps -ef | grep 8760
root       8762   8703  0 16:50 pts/0    00:00:00 grep --color=auto8760

[root@lwq ~]# vim qinggong.sh
#!/bin/bash


echo $$
sleep 600
[root@lwq ~]# bash qinggong.sh 
8819
此时开一个终端
[root@lwq ~]# ps -ef | grep 8819
root       8819   8703  0 17:02 pts/0    00:00:00 bash qinggong.sh
root       8820   8819  0 17:02 pts/0    00:00:00 sleep 600
root       8824   8769  0 17:03 pts/1    00:00:00 grep --color=auto8819
[root@lwq ~]# kill -9 8819 8820
回第一个终端
[root@lwq ~]# bash qinggong.sh 
8819
已杀死
</code></pre> 
<p>$? 是显示上条命令的退出状态，0表示没有错误，其他表示有错误</p> 
<h4><a id="155bash_316"></a>1.5.5bash内建环境变量</h4> 
<ul><li>PATH</li><li>SHELL</li><li>UID</li><li>HISTSIZE</li><li>HOME</li><li>PWD</li><li>HISTFILE</li><li>PS1</li></ul> 
<pre><code>[root@lwq ~]# echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin
[root@lwq ~]# echo $SHELL
/bin/bash
[root@lwq ~]# echo $UID
0
[root@lwq ~]# echo $HISTSIZE
1000
[root@lwq ~]# echo $HOME
/root
[root@lwq ~]# echo $PWD
/root
[root@lwq ~]# echo $HISTFILE
/root/.bash_history
[root@lwq ~]# echo $PS1
[\u@\h \W]\$
[root@lwq ~]# PS1='[\lwq@liu\W]'
[1wq@liu~]bash
[root@lwq ~]# PS1='[\lwq@liu\qqq]'
[1wq@liu\qqq]bash
[root@lwq ~]# 
</code></pre> 
<h4><a id="156_350"></a>1.5.6只读变量（常量）</h4> 
<p>readonly VAR-NAME=VALUE 不能修改值，不能销毁，只能等shell进程终止时随之消亡</p> 
<pre><code>[root@lwq ~]# readonly a=10
[root@lwq ~]# echo $a
10
[root@lwq ~]# a=20
-bash: a: 只读变量 
[root@lwq ~]# echo $a
10
[root@lwq ~]# readonly a=20
-bash: a: 只读变量
[root@lwq ~]# unset a
-bash: unset: a: 无法反设定: 只读 variable
[root@lwq ~]# echo $a
10
[root@lwq ~]# exit
</code></pre> 
<h3><a id="2_369"></a>2.脚本基础</h3> 
<h3><a id="21_370"></a>2.1什么是脚本</h3> 
<p>按实际需要，结合命令流程控制机制实现的源程序。说白点就是命令的堆砌。</p> 
<h3><a id="22_373"></a>2.2程序返回值</h3> 
<p>程序执行以后有两类返回值：</p> 
<ul><li> <p>程序执行的结果</p> </li><li> <p>程序状态返回代码（0-255）</p> </li><li class="task-list-item"> <p><input type="checkbox" class="task-list-item-checkbox" disabled> 0：正确执行</p> </li></ul> 
<pre><code>[root@lwq ~]# echo $?
0
</code></pre> 
<ul><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 1-255：错误执行，1、2、127系统预留，有特殊意义</li></ul> 
<pre><code>[root@lwq ~]# vim 88.sh
#!bin/bash 

mkdir 100
cd 100/
touch 1 2 3
mkdir 4 5 6

[root@lwq ~]# bash 88.sh
[root@lwq 100]# ls
1  2  3  4  5  6
[root@lwq 100]# ls -l
总用量 0
-rw-r--r--. 1 root root 0 6月  12 11:06 1
-rw-r--r--. 1 root root 0 6月  12 11:06 2
-rw-r--r--. 1 root root 0 6月  12 11:06 3
drwxr-xr-x. 2 root root 6 6月  12 11:06 4
drwxr-xr-x. 2 root root 6 6月  12 11:06 5
drwxr-xr-x. 2 root root 6 6月  12 11:06 6

</code></pre> 
<pre><code>执行脚本方法：
1. bash+脚本名
2. /bin/bash+脚本名
3. chmod+x 脚本名
   绝对路径+脚本名
4. chmod+x 脚本名
   相对路径+脚本名
</code></pre> 
<h3><a id="23_418"></a>2.3脚本测试</h3> 
<p>bash -n scriptname //检查脚本是否有语法错误<br> bash -x scriptname //单步执行，检查脚本错在哪里</p> 
<h3><a id="24_422"></a>2.4写脚本注意事项</h3> 
<ul><li>禁止将未成功执行过的代码直接写进脚本</li><li>脚本中的命令一定要用绝对路径</li><li>（最好开两个终端，方便排错）</li></ul> 
<h3><a id="25shell_428"></a>2.5shell算术运算</h3> 
<ul><li>let 算数运算表达式</li></ul> 
<pre><code>let C=$A+$B
</code></pre> 
<ul><li>$[ 算数运算表达式]</li></ul> 
<pre><code>C=$[$A+$B]
</code></pre> 
<pre><code>[root@lwq ~]# vim 612.sh
#!/bin/bash

A=3
B=6

echo "$[$A+$B]"

[root@lwq ~]# bash 612.sh
9

</code></pre> 
<ul><li>$((算数运算表达式))</li></ul> 
<pre><code>C=$(($A+$B))
</code></pre> 
<pre><code>[root@lwq ~]# vim 612.sh
#!/bin/bash

A=3
B=6

echo "$(($A+$B))"

[root@lwq ~]# bash 612.sh
9
</code></pre> 
<ul><li>expr算数运算表达式，表达式中各操作数及运算符之间要有间隔，而且要使用命令引用</li></ul> 
<pre><code>C=`expr $A + $B`
</code></pre> 
<pre><code>[root@lwq ~]# vim 612.sh
#!/bin/bash

A=3
B=6

echo `expr $A + $B`

[root@lwq ~]# bash 612.sh
9

</code></pre> 
<p>除法：</p> 
<pre><code>yum -y install bc
[root@lwq ~]# echo "scale=1;3/2"|bc
1.5
[root@lwq ~]# echo "scale=2;3/2"|bc
1.50
</code></pre> 
<p>scale小数点后有几位</p> 
<h3><a id="26_494"></a>2.6命令间的逻辑关系</h3> 
<ul><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 逻辑与：&amp;&amp;<br> 第一个条件为假时，第二个条件不用再判断，最终结果已经有<br> 第一个条件为真时，第二个条件必须得判断</li><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled> 逻辑或：| |<br> 前一个命令的结果为真时，第二个命令就不执行<br> 前一个命令的结果为假时，第二个命令就必须执行</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/17d59c2ee5779f5ff8690edfd467ccbb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vector或数组求最大值、最小值</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/66417c3c3d5008e31b6c25047ea9c310/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机网络运输层习题5-38</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>