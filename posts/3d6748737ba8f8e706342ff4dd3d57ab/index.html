<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>centos将sh文件设置为开机自动执行 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="centos将sh文件设置为开机自动执行" />
<meta property="og:description" content="一、先创建一个sh文件 vim redis-6.0.3.sh 这个是redis执行的sh脚本内容
#!/bin/sh
# chkconfig: 2345 80 90
# Simple Redis init.d script conceived to work on Linux systems
# as it does use of the /proc filesystem.
REDISPORT=7000 # 对应redis.conf文件的端口
EXEC=/usr/redis/redis-6.0.3/src/redis-server # redis-server 文件的位置
CLIEXEC=/usr/redis/redis-6.0.3/src/redis-cli # redis-cli 文件的位置
PIDFILE=/var/run/redis_${REDISPORT}.pid # 进程文件的位置
CONF=&#34;/usr/redis/redis-6.0.3/redis.conf&#34; # 配置文件的位置
case &#34;$1&#34; in
start)
if [ -f $PIDFILE ] # 如果redis进程文件存在
then
echo &#34;$PIDFILE exists, process is already running or crashed&#34;
else" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/3d6748737ba8f8e706342ff4dd3d57ab/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-23T15:12:54+08:00" />
<meta property="article:modified_time" content="2024-02-23T15:12:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">centos将sh文件设置为开机自动执行</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、先创建一个sh文件</h2> 
<pre><code>vim redis-6.0.3.sh</code></pre> 
<p>这个是redis执行的sh脚本内容</p> 
<blockquote> 
 <p>#!/bin/sh<br> # chkconfig: 2345 80 90<br> # Simple Redis init.d script conceived to work on Linux systems<br> # as it does use of the /proc filesystem.</p> 
 <p>REDISPORT=7000     # 对应redis.conf文件的端口<br> EXEC=/usr/redis/redis-6.0.3/src/redis-server  # redis-server 文件的位置<br> CLIEXEC=/usr/redis/redis-6.0.3/src/redis-cli  # redis-cli 文件的位置</p> 
 <p>PIDFILE=/var/run/redis_${REDISPORT}.pid  # 进程文件的位置<br> CONF="/usr/redis/redis-6.0.3/redis.conf"   # 配置文件的位置</p> 
 <p>case "$1" in<br>     start)<br>         if [ -f $PIDFILE ]  # 如果redis进程文件存在<br>         then<br>                 echo "$PIDFILE exists, process is already running or crashed"<br>         else<br>                 echo "Starting Redis server..."<br>                 $EXEC $CONF <br>         fi<br>         ;;<br>     stop)<br>         if [ ! -f $PIDFILE ]<br>         then<br>                 echo "$PIDFILE does not exist, process is not running"<br>         else<br>                 PID=$(cat $PIDFILE)<br>                 echo "Stopping ..."<br>                 $CLIEXEC -h 192.168.139.128 -p $REDISPORT shutdown  # 该命令为  redis-cli -h ip地址 -p 端口 shutdown<br>                 while [ -x /proc/${PID} ]<br>                 do<br>                     echo "Waiting for Redis to shutdown ..."<br>                     sleep 1<br>                 done<br>                 echo "Redis stopped"<br>         fi<br>         ;;<br>     *)<br>         echo "Please use start or stop as first argument"<br>         ;;<br> esac</p> 
</blockquote> 
<p><span style="color:#fe2c24;"><strong>解析</strong></span></p> 
<p>#!/bin/sh  <strong>//这个是脚本固定写法</strong></p> 
<p>#chkconfig:2345 10 90    <strong><span style="color:#374151;"><span style="background-color:#ffffff;">//此行的2345参数表示,在哪些运行级别启动,</span></span>10是启动优先级，90是停止优先级，优先级范围是0－100，数字越大，优先级越低。</strong></p> 
<blockquote> 
 <p><span style="color:#374151;"><span style="background-color:#ffffff;">其中2345是默认启动级别，级别有0-6共7个级别。</span></span></p> 
 <p><span style="color:#374151;"><span style="background-color:#ffffff;">等级0表示：表示关机 　　<br> 等级1表示：单用户模式 　　<br> 等级2表示：无网络连接的多用户命令行模式 　　<br> 等级3表示：有网络连接的多用户命令行模式 　　<br> 等级4表示：不可用 　　<br> 等级5表示：带图形界面的多用户模式 　　<br> 等级6表示：重新启动</span></span></p> 
</blockquote> 
<h2>二、为这个脚本加上可执行权限</h2> 
<pre><code>chmod +x redis-6.0.3.sh</code></pre> 
<h2>三、将脚本移动到/etc/rc.d/init.d目录下</h2> 
<p>/usr/redis/redis-6.0.3.sh是sh脚本文件存放的路径</p> 
<pre><code>mv /usr/redis/redis-6.0.3.sh /etc/rc.d/init.d </code></pre> 
<h2>四、设置该脚本为开机自运行</h2> 
<p>4.1 将脚本加入chkconfig命令进行管理</p> 
<pre><code>cd /etc/rc.d/init.d
#将脚本加入chkconfig命令进行管理
chkconfig --add redis-6.0.3.sh 
#设置为开机自运行
chkconfig redis-6.0.3.sh on
</code></pre> 
<h2>拓展</h2> 
<p>如果要移除</p> 
<pre><code>cd /etc/rc.d/init.d
#关闭开机自启动
chkconfig redis-6.0.3.sh off
#将脚本从chkconfig移除
chkconfig --del redis-6.0.3.sh</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c9b928297d05be97fc595f0857bccd80/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器学习中的决策树算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0838e73f59e20b2cef17e59a012d38e1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">五.索引的数据结构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>