<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>makefile和make - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="makefile和make" />
<meta property="og:description" content="一、make的安装 输入命令：sudo apt install make
需要密码，根据提示输入密码即可。
二、makefile和make命令的介绍 makefile文件：Linux上的项目工程管理工具，可以实现自动化编译。
主要用于项目工程里源文件过多，makefile文件可以根据类型，功能，模块，将这些源文件分好到不同目录里,makefile文件里面就可以定义一系列的规则来指定哪一些文件先需要进行编译,文件需要重新编译，甚至更复杂的操作，makefile文件就像一个shell脚本一样，可以一系列命令。|
make：是一个命令，可以解释makefile文件中的指令
eg:现有main.c，add.c，max.c三个文件需要编译
文件内容如下：
若需要编译这三个文件需要：gcc -o main main.c add.c max.c
若只修改了其中一个文件，要想编译，就需将这三个文件都重新编译一遍，文件若很多，就很麻烦。
这时我们可以使用makefile文件，提供编写效率，通过make命令执行makefile文件，这时只会将修改过的文件或依赖修改过的文件的文件重新编译，不受影响的文件不会重新编译。
makefile文件使用如下： makefile文件内容如下：
直接执行make命令自动执行makefile文件中的命令生成对应的可执行文件
若我们只修改main.c 中的文件
使用make命令执行
若觉得文件编译过程中生成的.o文件没有用处，还可以通过编写makefile文件删除
执行命令：make clean
makefile文件最好不要自己改名
三、gdb调试 1） Debug版本和Release版本区别 Debug版本叫做开发版本或者可调试版本，生成的可执行文件里面包含调试需要用到的信息。我们作为开发人员，最常用的就是debug版本产生的可执行文件。
Release版本是发行版本，面向用户的，里面没有调试信息，所以体积会相较于debug版本非常的小.
注意:gcc默认生成的是Release版本。
2)gcc生成Debug版本的可执行文件 Debug版本的生成：因为调试信息是在编译阶段加入到可重定向的目标文件（.o）中的，所以必须在编译阶段就让它添加调试信息。
命令如下：
1、首先gcc -c main.c -g(生成的中间文件main.o这时包含调试信息)
然后再通过gcc -o main main.o(生成了Debug版本的可执行文件)
2、一步生成 gcc -o main main.c -g
-g只能加在编译时或者一步生成时
3）通过gdb进入调试 首先需要将源文件编译，链接生成debug版本的可执行文件，然后通过“gdb debug版本的可执行文件名”，就可以进入到gdb调试模式。
示例：
一个有问题的main.c文件
编译运行时，发现程序存在bug
通过gdb调试，寻找问题(先生成debug版本的可执行文件，再进入gdb模式去查看问题)
gdb命令： l //显示当前文件的源代码(回车显示后面没显示出来的) list filename：num //显示filename文件中第num行附近的源代码 b 行号 // 给指定行下断点 r （run） //启动程序q //退出调试 p buff//临时打印数组所有元素的值p val //临时打印变量val的值p &amp; val //临时 打印变量val的地址p a&#43;b // 临时打印表达式的值p *parr@num //通过指向数组的指针打印数组的元素值n （next）//单步执行，逐过程执 display buff//自动显示监视对象，操作格式和p一致info break //显示所有断点信息info display//自动显示所有监视对象信息undisplay 编号//删除对应的自动显示监视对象delete 断点编号//删除编号断点c （continue）//继续执行，直到执行到下一个断点 s //进去到将要被调用的函数中（逐语句）finish //跳出函数ptype val // 显示变量val的数据类型 前面通过调试，我们发现程序问题在比较这一块，比较的时候将回车\n也比较了，所以导致的bug" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/70e2fe2685d121c6537d7a58dee5af8e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-05T18:47:34+08:00" />
<meta property="article:modified_time" content="2022-05-05T18:47:34+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">makefile和make</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、make的安装</h2> 
<p>输入命令：<strong>sudo apt install make</strong></p> 
<p>需要密码，根据提示输入密码即可。</p> 
<h2>二、makefile和make命令的介绍</h2> 
<p><strong>makefile文件：</strong>Linux上的项目工程管理工具，可以实现自动化编译。</p> 
<p>主要用于项目工程里源文件过多，makefile文件可以根据类型，功能，模块，将这些源文件分好到不同目录里,makefile文件里面就可以定义一系列的规则来指定哪一些文件先需要进行编译,文件需要重新编译，甚至更复杂的操作，makefile文件就像一个shell脚本一样，可以一系列命令。|</p> 
<p><strong>make：是一个命令，可以解释makefile文件中的指令</strong></p> 
<p>eg:现有main.c，add.c，max.c三个文件需要编译</p> 
<p>文件内容如下：</p> 
<p><img alt="" height="437" src="https://images2.imgbox.com/ab/ec/AWj8wssx_o.png" width="648"></p> 
<p>若需要编译这三个文件需要：<strong>gcc -o main main.c add.c max.c</strong></p> 
<p><img alt="" height="79" src="https://images2.imgbox.com/f6/71/BQlLbDEE_o.png" width="666"></p> 
<p>若只修改了其中一个文件，要想编译，就需将这三个文件都重新编译一遍，文件若很多，就很麻烦。</p> 
<p>这时我们可以使用makefile文件，提供编写效率，通过make命令执行makefile文件，这时只会将修改过的文件或依赖修改过的文件的文件重新编译，不受影响的文件不会重新编译。</p> 
<h3>makefile文件使用如下：</h3> 
<p>makefile文件内容如下：</p> 
<p><img alt="" height="378" src="https://images2.imgbox.com/c8/e9/4lxQFtQ9_o.png" width="733"></p> 
<p> 直接执行make命令自动执行makefile文件中的命令生成对应的可执行文件</p> 
<p><img alt="" height="172" src="https://images2.imgbox.com/fb/a1/YgTPRHLv_o.png" width="622"></p> 
<p> <img alt="" height="66" src="https://images2.imgbox.com/2e/2d/QAMOAvM5_o.png" width="480"></p> 
<p>若我们只修改main.c 中的文件</p> 
<p><img alt="" height="251" src="https://images2.imgbox.com/58/2d/n2ypxERz_o.png" width="385"></p> 
<p> 使用make命令执行</p> 
<p><img alt="" height="146" src="https://images2.imgbox.com/c0/aa/Ij4Vdcws_o.png" width="729"></p> 
<p> 若觉得文件编译过程中生成的.o文件没有用处，还可以通过编写makefile文件删除</p> 
<p><img alt="" height="330" src="https://images2.imgbox.com/63/c8/zRDgHm50_o.png" width="558"></p> 
<p>执行命令：<strong>make clean</strong></p> 
<p> <img alt="" height="261" src="https://images2.imgbox.com/30/1f/UIpb4P0f_o.png" width="670"></p> 
<p><strong>makefile文件最好不要自己改名</strong></p> 
<h2> 三、gdb调试</h2> 
<h3>1） Debug版本和Release版本区别</h3> 
<p><strong>Debug版本</strong>叫做开发版本或者可调试版本，生成的可执行文件里面包含调试需要用到的信息。我们作为开发人员，最常用的就是debug版本产生的可执行文件。<br><strong>Release版本</strong>是发行版本，面向用户的，里面没有调试信息，所以体积会相较于debug版本非常的小.<br> 注意:<span style="color:#fe2c24;"><strong>gcc默认生成的是Release版本。</strong></span></p> 
<h3>2)gcc生成Debug版本的可执行文件</h3> 
<p>Debug版本的生成：因为调试信息是在编译阶段加入到可重定向的目标文件（.o）中的，所以必须在编译阶段就让它添加调试信息。</p> 
<p>命令如下：</p> 
<p>1、首先<strong>gcc -c main.c -g</strong>(生成的中间文件main.o这时包含调试信息)</p> 
<p>    然后再通过<strong>gcc -o main main.o</strong>(生成了Debug版本的可执行文件)</p> 
<p>2、一步生成 <strong>gcc -o main main.c -g</strong></p> 
<p><span style="color:#fe2c24;">-g只能加在编译时或者一步生成时</span></p> 
<h3>3）通过gdb进入调试</h3> 
<p>首先需要将源文件编译，链接生成debug版本的可执行文件，然后通过“<strong>gdb debug版本的可执行文件名</strong>”，就可以进入到gdb调试模式。</p> 
<p>示例：</p> 
<p>一个有问题的main.c文件</p> 
<p><img alt="" height="456" src="https://images2.imgbox.com/95/2b/JBPL52nj_o.png" width="633"></p> 
<p> 编译运行时，发现程序存在bug</p> 
<p><img alt="" height="337" src="https://images2.imgbox.com/a5/12/x5VM50qX_o.png" width="674"></p> 
<p> 通过gdb调试，寻找问题(先生成debug版本的可执行文件，再进入gdb模式去查看问题)</p> 
<p><img alt="" height="386" src="https://images2.imgbox.com/d0/d7/ZT3N8Onp_o.png" width="721"></p> 
<h4> gdb命令：</h4> 
<ul><li><strong> <span style="color:#fe2c24;">l </span></strong>    //显示当前文件的源代码(回车显示后面没显示出来的)</li></ul> 
<p><img alt="" height="538" src="https://images2.imgbox.com/26/c4/BxIdvhsX_o.png" width="930"></p> 
<ul><li> <span style="color:#fe2c24;"><strong>list filename：num</strong></span>  //显示filename文件中第num行附近的源代码<img alt="" height="239" src="https://images2.imgbox.com/6f/13/gDbYxGWV_o.png" width="540"></li><li><span style="color:#fe2c24;"><strong> b 行号 </strong></span>  // 给指定行下断点</li></ul> 
<p><img alt="" height="63" src="https://images2.imgbox.com/30/55/8FuIuSYI_o.png" width="473"></p> 
<ul><li><span style="color:#fe2c24;"><strong> r</strong></span> （run） //启动程序</li><li><span style="color:#fe2c24;"><strong>q</strong></span>  //退出调试</li></ul> 
<p><img alt="" height="122" src="https://images2.imgbox.com/d4/ee/XaVujTBu_o.png" width="476"></p> 
<ul><li><span style="color:#fe2c24;"><strong>p buff</strong></span>//临时打印数组所有元素的值</li><li><span style="color:#fe2c24;"><strong>p val</strong></span> //临时打印变量val的值</li><li><strong><span style="color:#fe2c24;">p &amp; val</span></strong>  //临时 打印变量val的地址</li><li><span style="color:#fe2c24;"><strong>p a+b</strong></span>  // 临时打印表达式的值</li><li><span style="color:#fe2c24;"><strong>p *parr@num</strong></span>  //通过指向数组的指针打印数组的元素值</li><li><span style="color:#fe2c24;"><strong>n </strong></span> （next）//单步执行，逐过程执</li></ul> 
<p><img alt="" height="379" src="https://images2.imgbox.com/d0/cc/sdCjcK4q_o.png" width="721"></p> 
<ul><li><span style="color:#fe2c24;"><strong> display buff</strong></span>//自动显示监视对象，操作格式和p一致</li><li><span style="color:#fe2c24;"><strong>info break</strong></span> //显示所有断点信息</li><li><span style="color:#fe2c24;"><strong>info display</strong></span>//自动显示所有监视对象信息</li><li><span style="color:#fe2c24;"><strong>undisplay 编号</strong></span>//删除对应的自动显示监视对象</li><li><span style="color:#fe2c24;"><strong>delete 断点编号</strong></span>//删除编号断点</li><li><img alt="" height="698" src="https://images2.imgbox.com/98/41/KV4xpXtm_o.png" width="845"></li><li><span style="color:#fe2c24;"><strong>c   （continue）</strong></span>//继续执行，直到执行到下一个断点<img alt="" height="596" src="https://images2.imgbox.com/a8/09/ERtcFgjF_o.png" width="708"></li></ul> 
<ul><li><span style="color:#fe2c24;"><strong>s </strong></span> //进去到将要被调用的函数中（逐语句）</li><li><span style="color:#fe2c24;"><strong>finish  </strong></span> //跳出函数</li><li><span style="color:#fe2c24;"><strong>ptype  val  </strong></span>// 显示变量val的数据类型<img alt="" height="64" src="https://images2.imgbox.com/46/a7/aJqaFX1X_o.png" width="517"></li></ul> 
<p> 前面通过调试，我们发现程序问题在比较这一块，比较的时候将回车\n也比较了，所以导致的bug</p> 
<p><img alt="" height="427" src="https://images2.imgbox.com/22/ca/wYT59Jv4_o.png" width="469"></p> 
<p> <img alt="" height="242" src="https://images2.imgbox.com/0f/c8/w5UklKYO_o.png" width="655"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cd25384d39edd0d0dca0eb43322b7e7c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">机器学习（一）协同过滤推荐算法</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/62bcbb29a9f6685df2b0e3d1af53fff5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">nfs-kernel-server服务启动失败解决</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>