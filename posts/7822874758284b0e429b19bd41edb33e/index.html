<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>单片机51 定时器 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="单片机51 定时器" />
<meta property="og:description" content="一、基本概念 1.1简介 单片机的定时器是一种内部功能模块，用于产生计时、计数、延时等功能。定时器通常由一个或多个计数器和相关的控制逻辑组成。单片机的定时器可以运行在不同的工作模式下，以适应不同的计时和计数需求。
C51中的定时器和计数器是同一个硬件电路支持的，通过寄存器配置不同，就可以将他当做定时器
或者计数器使用。
确切的说，定时器和计数器区别是致使他们背后的计数存储器加1的信号不同。当配置为定时器使
用时，每经过1个机器周期，计数存储器的值就加1。而当配置为计数器时，每来一个负跳变信号
(信号从P3.4 或者P3.5引脚输入)，就加1，以此达到计数的目的。
标准C51有2个定时器/计数器：T0和T1。他们的使用方法一致。C52相比C51多了一个T2。
1.2 如何定时 定时器的本质原理： 每经过一个机器周期，就加1 :寄存器
晶振： 晶振(晶体震荡器)，又称数字电路的“心脏”，是各种电子产品里面必不可少的频率元器件。数字电
路的所有工作都离不开时钟，晶振的好坏、晶振电路设计的好坏，会影响到整个系统的稳定性。
时钟周期： 时钟周期也称为振荡周期，定义为时钟频率的倒数。时钟周期是计算机中最基本的、最小的时间单
位。在一个时钟周期内，CPU仅完成一个最基本的动作。时钟周期是一个时间的量。更小的时钟周
期就意味着更高的工作频率。
机器周期： 机器周期也称为CPU周期。在计算机中，为了便于管理，常把一条指令的执行过程划分为若干个阶
段（如取指、译码、执行等），每一阶段完成一个基本操作。完成一个基本操作所需要的时间称为
机器周期。一般情况下，一个机器周期由若干个时钟周期组成。
1.3 时间计算方式 二、 程序 2.1 非中断模式 定时10ms led状态翻转一次：
#include &lt;stdio.h&gt; #include &#34;reg52.h&#34; sbit led = P3^6; sbit key1 = P2^1; //void Timer0Init(void)	//10毫秒@11.0592MHz //{ //	AUXR &amp;= 0x7F;	//定时器时钟12T模式 //	TMOD &amp;= 0xF0;	//设置定时器模式 //	TL0 = 0x00;	//设置定时初值 //	TH0 = 0xDC;	//设置定时初值 //	TF0 = 0;	//清除TF0标志 //	TR0 = 1;	//定时器0开始计时 //} int main() { int cnt =0; TMOD &amp;= 0xF0;	//设置定时器模式 TL0 = 0x00;	//设置定时初值 TH0 = 0xDC;	//设置定时初值 TF0 = 0;	//清除TF0标志 TR0 = 1;	//定时器0开始计时 while(1) { if(TF0 == 1) { TF0= 0; TL0 = 0x00;	//设置定时初值 TH0 = 0xDC;	//设置定时初值 cnt&#43;&#43;; if(cnt&gt;100) { led = !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/7822874758284b0e429b19bd41edb33e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-26T21:30:44+08:00" />
<meta property="article:modified_time" content="2024-02-26T21:30:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">单片机51 定时器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>一、基本概念</h2> 
<h3>1.1简介</h3> 
<p>单片机的定时器是一种内部功能模块，用于产生计时、计数、延时等功能。定时器通常由一个或多个计数器和相关的控制逻辑组成。单片机的定时器可以运行在不同的工作模式下，以适应不同的计时和计数需求。</p> 
<p>C51中的定时器和计数器是同一个硬件电路支持的，通过寄存器配置不同，就可以将他当做定时器<br> 或者计数器使用。<br> 确切的说，定时器和计数器区别是致使他们背后的计数存储器加1的信号不同。当配置为定时器使<br> 用时，每经过1个机器周期，计数存储器的值就加1。而当配置为计数器时，每来一个负跳变信号<br> (信号从P3.4 或者P3.5引脚输入)，就加1，以此达到计数的目的。<br> 标准C51有2个定时器/计数器：T0和T1。他们的使用方法一致。C52相比C51多了一个T2。</p> 
<h3>1.2 如何定时</h3> 
<p>定时器的本质原理： 每经过一个机器周期，就加1 :寄存器</p> 
<h4>晶振：</h4> 
<p>晶振(晶体震荡器)，又称数字电路的“心脏”，是各种电子产品里面必不可少的频率元器件。数字电<br> 路的所有工作都离不开时钟，晶振的好坏、晶振电路设计的好坏，会影响到整个系统的稳定性。<br>  </p> 
<h4>时钟周期：</h4> 
<p>时钟周期也称为振荡周期，定义为时钟频率的倒数。时钟周期是计算机中最基本的、最小的时间单<br> 位。在一个时钟周期内，CPU仅完成一个最基本的动作。时钟周期是一个时间的量。更小的时钟周<br> 期就意味着更高的工作频率。</p> 
<h4>机器周期：</h4> 
<p>机器周期也称为CPU周期。在计算机中，为了便于管理，常把一条指令的执行过程划分为若干个阶<br> 段（如取指、译码、执行等），每一阶段完成一个基本操作。完成一个基本操作所需要的时间称为<br> 机器周期。一般情况下，一个机器周期由若干个时钟周期组成。</p> 
<h3>1.3 时间计算方式</h3> 
<h3 style="text-align:center;"><img alt="" src="https://images2.imgbox.com/21/d4/MwVhefXm_o.png"></h3> 
<h2>二、 程序</h2> 
<h3>2.1 非中断模式</h3> 
<p>定时10ms led状态翻转一次：</p> 
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include "reg52.h"
sbit led = P3^6;
sbit key1 = P2^1;

//void Timer0Init(void)		//10毫秒@11.0592MHz
//{
//	AUXR &amp;= 0x7F;		//定时器时钟12T模式
//	TMOD &amp;= 0xF0;		//设置定时器模式
//	TL0 = 0x00;		//设置定时初值
//	TH0 = 0xDC;		//设置定时初值
//	TF0 = 0;		//清除TF0标志
//	TR0 = 1;		//定时器0开始计时
//}


int main()
{

  int cnt =0;
  TMOD &amp;= 0xF0;		//设置定时器模式
	TL0 = 0x00;		//设置定时初值
	TH0 = 0xDC;		//设置定时初值
	TF0 = 0;		//清除TF0标志
	TR0 = 1;		//定时器0开始计时
  
  
  while(1) {
    if(TF0 == 1) {
      TF0= 0;
      TL0 = 0x00;		//设置定时初值
	    TH0 = 0xDC;		//设置定时初值
      cnt++;
      if(cnt&gt;100) {
        led = !led;
        cnt = 0;
        
      }
    }
  }


return 0;
}</code></pre> 
<h3 style="background-color:transparent;">2.2 中断模式</h3> 
<p></p> 
<pre><code class="language-cpp">#include "reg52.h"
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

sbit LED1 = P3^7;
sbit LED2 = P3^6;
int cnt = 0;

void Delay300ms()		//@11.0592MHz
{
	unsigned char i, j, k;

//	_nop_();
	i = 3;
	j = 26;
	k = 223;
	do
	{
		do
		{
			while (--k);
		} while (--j);
	} while (--i);
}


void TimeInit()
{

  TMOD =0X01;

  TL0 = 0X00;
  TH0 = 0XDC;
  
  TR0 = 1;
  TF0 = 0;
  ET0 = 1;
  EA = 1;
}

int main()
{
  LED1 = 1;

  TimeInit();
  
  while(1)
  {
    LED1 = 0;
    Delay300ms();
    LED1 = 1;
    Delay300ms();
  }

  return 0;
}

void TimeOHandler() interrupt 1
{
  cnt++;
  TL0 = 0X00;
  TH0 = 0XDC;
  
  if(cnt == 100) {
    cnt =0;
    LED2 =!LED2;
  }

}
</code></pre> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2d46d06554f4b6a4402ace305621785d/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【机器学习科学库】全md文档笔记：Matplotlib详细使用方法（已分享，附代码）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f983eef755a91174155e43e1f9a795d2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ConvNeXt V2：用MAE训练CNN</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>