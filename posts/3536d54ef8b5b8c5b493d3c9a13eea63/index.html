<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【WinForm详细教程八】WinForm中的TreeView控件 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【WinForm详细教程八】WinForm中的TreeView控件" />
<meta property="og:description" content="文章目录 `TreeView` 基本的知识属性方法事件 `TreeView` 案例演示案例一：案例二：【WinForm详细教程】源代码获取方式 TreeView 控件 用于展示分层数据，它以树形结构展示信息，每个节点可以有一个或多个子节点。TreeView 控件允许用户以可展开和可折叠的形式查看复杂的层次信息。
TreeView 基本的知识 属性 Nodes: 一个 TreeNodeCollection，包含控件的根节点。SelectedNode: 获取或设置当前选中的 TreeNode。CheckBoxes: 确定是否在每个树节点旁边显示复选框。ShowPlusMinus: 确定是否显示用于展开和折叠树节点的加号和减号。ShowLines: 确定是否显示树节点之间的连接线。 方法 BeginUpdate(): 暂停绘制控件，可以用于在添加大量节点时避免重绘，提高性能。EndUpdate(): 恢复正常绘制控件，与 BeginUpdate() 配对使用。CollapseAll(): 折叠所有的树节点。ExpandAll(): 展开所有的树节点。GetNodeAt(): 返回位于指定点的 TreeNode。 事件 AfterCheck / BeforeCheck: 在节点的复选框被用户选中或取消选中之后/之前发生。AfterSelect / BeforeSelect: 在选择某个节点之后/之前发生。AfterCollapse / BeforeCollapse: 在节点被折叠之后/之前发生。AfterExpand / BeforeExpand: 在节点被展开之后/之前发生。NodeMouseClick: 当鼠标单击 TreeNode 时发生。 节点介绍 - TreeNode
Name: 节点的唯一标识符。Text: 节点显示的文本。Nodes: 子节点的集合。 动态加载菜单表
数据库中存储节点与子节点的关系，但层次关系不明显。动态加载数据到 TreeView 控件的流程： 从数据库获取表数据。使用递归方法创建节点，并添加到 TreeView。调用方法在 TreeView 中创建并显示层次结构数据。 TreeView 节点的勾选处理
当父节点勾选或取消勾选时，所有子节点状态跟随变化。任一子节点勾选，父节点也应勾选。所有子节点都未勾选，父节点也不勾选。 TreeView 案例演示 案例一： namespace WinFormsTest { public partial class frmTreeView : Form { public frmTreeView() { InitializeComponent(); } private void frmTreeView_Load(object sender, EventArgs e) { TreeView fileTree = new TreeView(); // 单独设置 Width 和 Height fileTree." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/3536d54ef8b5b8c5b493d3c9a13eea63/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-08T17:41:48+08:00" />
<meta property="article:modified_time" content="2023-11-08T17:41:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【WinForm详细教程八】WinForm中的TreeView控件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#TreeView__4" rel="nofollow">`TreeView` 基本的知识</a></li><li><ul><li><a href="#_6" rel="nofollow">属性</a></li><li><a href="#_14" rel="nofollow">方法</a></li><li><a href="#_22" rel="nofollow">事件</a></li></ul> 
  </li><li><a href="#TreeView__52" rel="nofollow">`TreeView` 案例演示</a></li><li><ul><li><a href="#_54" rel="nofollow">案例一：</a></li><li><a href="#_109" rel="nofollow">案例二：</a></li><li><a href="#WinForm_229" rel="nofollow">【WinForm详细教程】源代码获取方式</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<p><code>TreeView</code> 控件 用于展示分层数据，它以树形结构展示信息，每个节点可以有一个或多个子节点。<code>TreeView </code>控件允许用户以可展开和可折叠的形式查看复杂的层次信息。</p> 
<h2><a id="TreeView__4"></a><code>TreeView</code> 基本的知识</h2> 
<h3><a id="_6"></a>属性</h3> 
<ul><li><strong>Nodes</strong>: 一个 TreeNodeCollection，包含控件的根节点。</li><li><strong>SelectedNode</strong>: 获取或设置当前选中的 TreeNode。</li><li><strong>CheckBoxes</strong>: 确定是否在每个树节点旁边显示复选框。</li><li><strong>ShowPlusMinus</strong>: 确定是否显示用于展开和折叠树节点的加号和减号。</li><li><strong>ShowLines</strong>: 确定是否显示树节点之间的连接线。</li></ul> 
<h3><a id="_14"></a>方法</h3> 
<ul><li><strong>BeginUpdate()</strong>: 暂停绘制控件，可以用于在添加大量节点时避免重绘，提高性能。</li><li><strong>EndUpdate()</strong>: 恢复正常绘制控件，与 <code>BeginUpdate()</code> 配对使用。</li><li><strong>CollapseAll()</strong>: 折叠所有的树节点。</li><li><strong>ExpandAll()</strong>: 展开所有的树节点。</li><li><strong>GetNodeAt()</strong>: 返回位于指定点的 TreeNode。</li></ul> 
<h3><a id="_22"></a>事件</h3> 
<ul><li><strong>AfterCheck</strong> / <strong>BeforeCheck</strong>: 在节点的复选框被用户选中或取消选中之后/之前发生。</li><li><strong>AfterSelect</strong> / <strong>BeforeSelect</strong>: 在选择某个节点之后/之前发生。</li><li><strong>AfterCollapse</strong> / <strong>BeforeCollapse</strong>: 在节点被折叠之后/之前发生。</li><li><strong>AfterExpand</strong> / <strong>BeforeExpand</strong>: 在节点被展开之后/之前发生。</li><li><strong>NodeMouseClick</strong>: 当鼠标单击 TreeNode 时发生。</li></ul> 
<p><strong>节点介绍 - TreeNode</strong></p> 
<ul><li><strong>Name</strong>: 节点的唯一标识符。</li><li><strong>Text</strong>: 节点显示的文本。</li><li><strong>Nodes</strong>: 子节点的集合。</li></ul> 
<p><strong>动态加载菜单表</strong></p> 
<ul><li>数据库中存储节点与子节点的关系，但层次关系不明显。</li><li>动态加载数据到 TreeView 控件的流程： 
  <ol><li>从数据库获取表数据。</li><li>使用递归方法创建节点，并添加到 TreeView。</li><li>调用方法在 TreeView 中创建并显示层次结构数据。</li></ol> </li></ul> 
<p><strong>TreeView 节点的勾选处理</strong></p> 
<ul><li>当父节点勾选或取消勾选时，所有子节点状态跟随变化。</li><li>任一子节点勾选，父节点也应勾选。</li><li>所有子节点都未勾选，父节点也不勾选。</li></ul> 
<h2><a id="TreeView__52"></a><code>TreeView</code> 案例演示</h2> 
<h3><a id="_54"></a>案例一：</h3> 
<pre><code class="prism language-c#">namespace WinFormsTest
{
    public partial class frmTreeView : Form
    {
        public frmTreeView()
        {
            InitializeComponent();
        }

        private void frmTreeView_Load(object sender, EventArgs e)
        {
            TreeView fileTree = new TreeView();
            // 单独设置 Width 和 Height
            fileTree.Width = 200;  // 设置宽度为200像素
            fileTree.Height = 600; // 设置高度为400像素

            // 或者使用 Size 属性同时设置宽度和高度
            fileTree.Size = new Size(200, 300); // 宽度200像素，高度400像素
            // 开始更新节点，防止在添加节点时进行重绘
            fileTree.BeginUpdate();
            TreeNode rootNode = new TreeNode("我的电脑");
            fileTree.Nodes.Add(rootNode);
            // 添加几个文件夹作为子节点
            TreeNode documentsNode = new TreeNode("文档");
            TreeNode picturesNode = new TreeNode("图片");
            TreeNode musicNode = new TreeNode("音乐");
            TreeNode videoNode = new TreeNode("视频");
            rootNode.Nodes.Add(documentsNode);
            rootNode.Nodes.Add(picturesNode);
            rootNode.Nodes.Add(musicNode);
            rootNode.Nodes.Add(videoNode);
            // 完成节点添加后，恢复控件的绘制
            fileTree.EndUpdate();
            fileTree.AfterSelect += new TreeViewEventHandler(fileTree_AfterSelect);
            this.Controls.Add(fileTree);
        }
        private void fileTree_AfterSelect(object sender, TreeViewEventArgs e)
        {
            if (e.Node.Text != "我的电脑")
            {
                // 当用户选择一个节点时，显示选中节点的信息
                MessageBox.Show("选中的文件夹: " + e.Node.Text);
            }
        }
    }
}
</code></pre> 
<p><strong>效果：</strong></p> 
<p><img src="https://images2.imgbox.com/7b/f3/zoPlKJhV_o.gif" alt="动画10"></p> 
<h3><a id="_109"></a>案例二：</h3> 
<pre><code class="prism language-c#">using System.Data;
using WinFormsTest.Helper;
namespace WinFormsTest
{
    public partial class frmTreeView2 : Form
    {
        public frmTreeView2()
        {
            InitializeComponent();
        }

        private void frmTreeView2_Load(object sender, EventArgs e)
        {
            treeView1.Nodes.Clear();//清除所有节点
            //1. 获取数据
            DataTable dtMenus = DBHelper.GetDataTable("select Id,MName,ParentId from MenuInfos", 1);
            //3.调用方法,添加节点
            CreateNode(dtMenus, null, 0);
        }

        //2.添加节点（递归）
        private void CreateNode(DataTable dt, TreeNode pNode, int parentId)
        {
            //1.获取要创建的节点数据
            DataRow[] rows = dt.Select("ParentId=" + parentId);
            if (rows.Length &gt; 0)
            {
                foreach (DataRow r in rows)
                {
                    //2.新建子节点
                    TreeNode node = new TreeNode();
                    node.Name = r["Id"].ToString();
                    node.Text = r["MName"].ToString();
                    //3.直接添加到TreeView Nodes  还是添加指定节点的Nodes里？ 
                    if (pNode != null)
                        pNode.Nodes.Add(node);
                    else
                        treeView1.Nodes.Add(node);
                    //4.判断当前节点下有没有子节点
                    //这个是递归，直到rows为0即当前节点没有子节点时结束递归
                    CreateNode(dt, node, int.Parse(node.Name));
                }
            }
        }
        
/添加父子勾选关联功能        
//1.父节点勾选或取消，它的所有子节点与它一致  
//2.只要有一个子节点勾选，父节点就勾选
//	子节点全部不勾选，父节点就不勾选
        bool isMouseClick = true;
        private void treeView1_NodeMouseClick_1(object sender, TreeNodeMouseClickEventArgs e)
        {
            isMouseClick = false;
            //子节点勾选
            SetChildNodesState(e.Node);
            //父节点勾选
            SetParentNodeState(e.Node);
            isMouseClick = true;
        }
        private void treeView1_AfterCheck_1(object sender, TreeViewEventArgs e)
        {
            if (isMouseClick)
            {
                treeView1.SelectedNode = e.Node; //当前操作节点选中
            }
        }

        //递归处理子节点的勾选
        private void SetChildNodesState(TreeNode node)
        {
            if (node.Nodes.Count &gt; 0)
            {
                foreach (TreeNode n in node.Nodes)
                {
                    n.Checked = node.Checked;
                    SetChildNodesState(n);
                }
            }
        }
        private void SetParentNodeState(TreeNode node)
        {
            TreeNode pNode = node.Parent;//获取父节点
            if (pNode != null)
            {
                bool bl = false;

                foreach (TreeNode n in pNode.Nodes)
                {
                    if (n.Checked)
                    {
                        bl = true;
                        break;
                    }
                }
                pNode.Checked = bl;
                SetParentNodeState(pNode);
            }
        }
    }
}
</code></pre> 
<p><strong>效果：</strong></p> 
<p>新建一个SQL数据库</p> 
<p><img src="https://images2.imgbox.com/0b/61/Dt2OPkEZ_o.png" alt="image-20231107192018880"></p> 
<p>展示</p> 
<p><img src="https://images2.imgbox.com/87/d7/xYLKeeYr_o.gif" alt="请添加图片描述"></p> 
<p>添加父子勾选关联功能后</p> 
<p><img src="https://images2.imgbox.com/6b/8b/a23XprTu_o.gif" alt="动画12"></p> 
<h3><a id="WinForm_229"></a>【WinForm详细教程】源代码获取方式</h3> 
<p><img src="https://images2.imgbox.com/bf/d7/e2eipcOZ_o.jpg" alt="在这里插入图片描述"></p> 
<p>精彩推荐：<br> <a href="https://blog.csdn.net/QH2107/article/details/126334608">【C#进阶一】C#中的数组(Array)、集合(ArrayList，Queue，Stack, HashList)、List＜T＞、字典(Dictionary＜K,T＞)和双向链表LinkedList</a><br> <a href="https://blog.csdn.net/QH2107/article/details/126611016">【C#进阶八】C#中的序列化与反序列化下（二进制序列化、XML序列化及JSON序列化）</a></p> 
<p><a href="https://blog.csdn.net/QH2107/article/details/133977594?spm=1001.2014.3001.5502">【C#进阶】C#语法中一些常用知识点总结</a><br> <a href="https://blog.csdn.net/QH2107/article/details/134023917?spm=1001.2014.3001.5502">【WinForm详细教程一】WinForm中的窗体、Label、TextBox及Button控件、RadioButton和CheckBox、ListBox</a><br> <a href="https://blog.csdn.net/QH2107/article/details/134100572?spm=1001.2014.3001.5502">【WinForm详细教程三】WinForm中的NumericUpDown、PictureBox、RichTextBox及三种Timer控件</a><br> <a href="https://blog.csdn.net/QH2107/article/details/134151206?spm=1001.2014.3001.5501">【WinForm详细教程四】WinForm中的ProgressBar 、ImageList和ListView控件</a><br> <a href="https://blog.csdn.net/QH2107/article/details/134192251?spm=1001.2014.3001.5501">【WinForm详细教程五】WinForm中的MenuStrip 、ContextMenuStrip 、ToolStrip、StatusStrip控件</a><br> <a href="https://blog.csdn.net/QH2107/article/details/134200338?spm=1001.2014.3001.5501">【WinForm详细教程六】WinForm中的GroupBox和Panel 、TabControl 、SplitContainer控件</a><br> <a href="https://blog.csdn.net/QH2107/article/details/134118303?spm=1001.2014.3001.5501">【C#进阶】C#中的委托、事件、回调函数、匿名函数和lambda表达式</a></p> 
<blockquote> 
 <p>如果你对智能建造专业感兴趣，或者是相关方向的学生，老师或者从业人员，欢迎通过微信公众号【智能建造小硕】加入我们！</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/13/d9/UxtaVORI_o.png" alt="在这里插入图片描述"><br> 希望有所帮助，同时欢迎关注我们，后面将更新更多相关内容！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a83e23e4921b1bbda5a68b6eebb477f8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【java学习笔记2】数组-移除元素</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9c1602600ad8f60fffa336fe1d74d485/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">自然语言处理（一）：RNN</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>