<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C语言结构体中的冒号用法 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C语言结构体中的冒号用法" />
<meta property="og:description" content="﻿﻿ 结构体中的冒号表示位域。
位域出现的原因是由于某些信息的存储表示只需要几个bit位就可以表示而不需要一个完整的字节，同时也是为了节省存储空间和方便处理。
其表示形式为：
struct 位域结构名
{
类型说明符 位域名：位域长度
}
例如：
struct bit_struct
{
int bit1:3;
int bit2:5;
int bit3:7;
}data;
其中bit_struct表示位域结构体，bit1、bit2、bit3表示对应的位域，data表示位域结构体定义的变量。整个位域结构体占用2个字节，bit1占3位，bit2占5位，bit1和bit2共用一个字节，bit3占7位，独占一个字节。
说明：
1、位域必须存储在同一个类型中，不能跨类型，同时也说明位域的长度不会超过所定义类型的长度。如果一个定义类型单元里所剩空间无法存放下一个域，则下一个域应该从下一单元开始存放。例如：所定义的类型是int类型，一共32为，目前用掉了25位还剩下7位，这时要存储一个8位的位域元素，那么这个元素就只能从下一个int类型的单元开始而不会在前面一个int类型中占7为后面的int类型中占1位。
2、如果位域的位域长度为0表示是个空域，同时下一个域应当从下一个字节单元开始存放。
3、使用无名的位域来作为填充和调整位置，切记该位域是不能被使用的。
4、位域的本质上就是一种结构体类型，不同的是其成员是按二进制位来分配的。
​
好，说到这里可能理解起来有点抽象，那下面通过一个例子来说明说有问题吧（注意：int是分正负的）！
1 /***********************************************************
2 * Function : 验证位域
3 *
4 * Result : a = 1, b = -2, c = 3, d = -2, e = -4
5 * a = 3, b = 0, c = 7, d = -1, e = -3" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/d9170e79d70f6d9b3f3ff1b6595cf959/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-12-16T14:37:33+08:00" />
<meta property="article:modified_time" content="2015-12-16T14:37:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C语言结构体中的冒号用法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="top:0px">
  ﻿﻿ 
</div> 
<p>结构体中的冒号表示位域。</p> 
<p><br> </p> 
<p>位域出现的原因是由于某些信息的存储表示只需要几个bit位就可以表示而不需要一个完整的字节，同时也是为了节省存储空间和方便处理。</p> 
<p><br> </p> 
<p>其表示形式为：</p> 
<p>struct 位域结构名</p> 
<p>{<!-- --></p> 
<p>    类型说明符  位域名：位域长度<br> </p> 
<p>}</p> 
<p>例如：</p> 
<p>struct  bit_struct</p> 
<p><span style="font-family:微软雅黑,sans-serif">{<!-- --></span><br> </p> 
<p><span style="font-family:微软雅黑,sans-serif">    int  bit1:3;<br> </span></p> 
<p><span style="font-family:微软雅黑,sans-serif">    int  bit2:5;<br> </span></p> 
<p><span style="font-family:微软雅黑,sans-serif">    int  bit3:7;<br> </span></p> 
<p>}data;</p> 
<p>其中bit_struct表示位域结构体，bit1、bit2、bit3表示对应的位域，data表示位域结构体定义的变量。整个位域结构体占用2个字节，bit1占3位，bit2占5位，bit1和bit2共用一个字节，bit3占7位，独占一个字节。</p> 
<p><br> </p> 
<p>说明：</p> 
<p>1、位域必须存储在同一个类型中，不能跨类型，同时也说明位域的长度不会超过所定义类型的长度。如果一个定义类型单元里所剩空间无法存放下一个域，则下一个域应该从下一单元开始存放。例如：所定义的类型是int类型，一共32为，目前用掉了25位还剩下7位，这时要存储一个8位的位域元素，那么这个元素就只能从下一个int类型的单元开始而不会在前面一个int类型中占7为后面的int类型中占1位。</p> 
<p>2、如果位域的位域长度为0表示是个空域，同时下一个域应当从下一个字节单元开始存放。</p> 
<p>3、使用无名的位域来作为填充和调整位置，切记该位域是不能被使用的。</p> 
<p>4、位域的本质上就是一种结构体类型，不同的是其成员是按二进制位来分配的。<br> </p> 
<p>​<br> </p> 
<p>好，说到这里可能理解起来有点抽象，那下面通过一个例子来说明说有问题吧（注意：int是分正负的）！</p> 
<p>  1 /***********************************************************</p> 
<p>  2  * Function         :  验证位域</p> 
<p>  3  *</p> 
<p>  4  * Result           :  a = 1, b = -2, c = 3, d = -2, e = -4</p> 
<p>  5  *                     a = 3, b = 0, c = 7, d = -1, e = -3</p> 
<p>  6  *</p> 
<p>  7  * Result Analysis  : 之所以出现负数的原因是由于int型默认是有符号型的，所以两位的位域赋值2时就会溢出，</p> 
<p>  8  *                    成为10，高位是表示符号，1表示负号。10取反加1之后就是10，也就是2，所以值是-2</p> 
<p>  9  *</p> 
<p> 10  * Create Data      : 2015-12-16</p> 
<p> 11  *</p> 
<p> 12  * Author           : ***</p> 
<p> 13  *</p> 
<p> 14  * Others           : </p> 
<p> 15  *</p> 
<p> 16  * Modified Data    :</p> 
<p> 17  *</p> 
<p> 18  * Modifier         :</p> 
<p> 19  *</p> 
<p> 20  * Modify Reason    :</p> 
<p> 21  *</p> 
<p> 22  * *******************************************************/</p> 
<p> 23 #include &lt;stdio.h&gt;</p> 
<p> 24         </p> 
<p> 25 #define  SYS_OK         0</p> 
<p> 26 #define  SYS_FAILED     1</p> 
<p> 27 typedef int SYS_TYPE;</p> 
<p> 28         </p> 
<p> 29 SYS_TYPE main()</p> 
<p> 30 {       </p> 
<p> 31     struct bit_st</p> 
<p> 32     {<!-- --></p> 
<p> 33         int a:3; //第一个字节的0~2位</p> 
<p> 34         int  :0; //这里是说明的第二点，空域。下一个位域b将会从下一个字节开始，位3~7为全0。</p> 
<p> 35         int b:2; //下一个字节也就是第二个字节的0~1位</p> 
<p> 36         int c:5; //第二个字节紧接b之后的2~6位</p> 
<p> 37         int d:2; //这里是说明的第一点，d占用第三个字节的0~1位，因为前面一个字节只剩下一位不能存放d，所以另起一个字节存放。</p> 
<p> 38         int  :2; //这里说明的是第三点，d域后的两个位2~3不能使用。</p> 
<p> 39         int e:3; //存放在第三个字节的第4~6位</p> 
<p> 40     }data, *pData;</p> 
<p> 41     </p> 
<p> 42     data.a = 1;</p> 
<p> 43     data.b = 2; //注意此处b只占2位，所以取值范围为-2~1，超过-2或者1就出现错误，所以赋值时注意位域的范围</p> 
<p> 44     data.c = 3; </p> 
<p> 45     data.d = 2; </p> 
<p> 46     data.e = 4;</p> 
<p> 47     printf("a = %d, b = %d, c = %d, d = %d, e = %d\r\n",</p> 
<p> 48             data.a, data.b, data.c, data.d, data.e); //结构体操作</p> 
<p> 49 </p> 
<p> 50     pData = &amp;data;</p> 
<p> 51     pData-&gt;a = 3;</p> 
<p> 52     pData-&gt;b &amp;= 1;</p> 
<p> 53     pData-&gt;c |= 5;</p> 
<p> 54     pData-&gt;d ^= 1;</p> 
<p> 55     pData-&gt;e = 5;</p> 
<p> 56     printf("a = %d, b = %d, c = %d, d = %d, e = %d\r\n",</p> 
<p> 57             pData-&gt;a, pData-&gt;b, pData-&gt;c, pData-&gt;d, pData-&gt;e); //结构体指针操作</p> 
<p> 58 </p> 
<p> 59     return SYS_OK;</p> 
<p> 60 }</p> 
<p>第一次赋值之后存放的形式如下：</p> 
<p> <img alt="" src="https://images2.imgbox.com/e3/b7/uqoO8cND_o.png"><br> 第二次赋值运算之后存放的形式如下：</p> 
<p> <img alt="" src="https://images2.imgbox.com/9f/20/hcvUUTmB_o.png"><br> </p> 
<p><br> </p> 
<p><br> </p> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/18b7cec8787d4d04ad89669b44436873/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">关于java中的各种关键字</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dc1246b498db0f61c9c8f0f54915d82f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言告警warning: missing braces around initializer详解</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>