<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux内核安装编译 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux内核安装编译" />
<meta property="og:description" content="Linux内核下载及编译 下载Linux内核 可以从官网下载linux内核，也可以通过第三方网站进行下载。
官网网址：https://www.kernel.org/。
由于官网可能存在被墙的原因，所以下在很慢，这里也提供一个更加便捷的下载地址：http://ftp.sjtu.edu.cn/sites/ftp.kernel.org/pub/linux/kernel/。
根据自己的需求下载相应的版本，我这里下载在的是“linux-5.19.tar.gz”版本。
解压linux内核 使用以下命令进行加压下载的linux内核压缩包：
tar -zxvf linux-5.19.tar.gz 解压后使用ls命令展示文件夹类存在的文件。
在清理多余的中间配置文件，使用make distclean命令。清理后文件夹内部信息将会发生变化。
选择参考配置文件 使用以下命令选择配置文件，便于后续config配置：
cp /boot/config-5.15.0-46-generic .config 具体操作如下图所示：
配置内核 在使用make命令前，需要先安装一些相关的依赖库，便于后续的运行。主要需要执行以下命令：
sudo apt-get update sudo apt install make sudo apt-get install gcc sudo apt-get install libncurses5-dev sudo apt-get install flex sudo apt-get install bison 使用“make manuconfig“进行打开可视化终端，按照自己的需要进行更改参数设置。如果不需要更改，则保存退出就可以继续执行后面操作。
编译内核 执行make bzImage命令，需要较长的时间（1～2小时左右，耐心等待）。
其中可能会出现scripts/sign-file.c:25:10: fatal error: openssl/opensslv.h: 没有那个文件或目录等问题。于是执行以下命令安装相关的依赖，应该一次性全部安装完相关的所有依赖，要不然耗时更长。
sudo apt-get install libssl-dev sudo apt-get install libelf-dev sudo apt-get install dwarves sudo apt-get install zstd 如果中间出现以下等错误：make[1]: *** 没有规则可制作目标“[debian](https://so." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/e53db092688a0b90b26cd8a6e1de869c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-15T15:14:43+08:00" />
<meta property="article:modified_time" content="2022-10-15T15:14:43+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux内核安装编译</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Linux_0"></a>Linux内核下载及编译</h2> 
<h3><a id="Linux_2"></a>下载Linux内核</h3> 
<p>可以从官网下载linux内核，也可以通过第三方网站进行下载。</p> 
<p>官网网址：<a href="https://www.kernel.org/" rel="nofollow">https://www.kernel.org/</a>。</p> 
<p><img src="https://images2.imgbox.com/0d/7f/ahlyAaLk_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-D3ePcYYI-1665817721405)(linux内核安装编译/image-20221014164444815.png)]"></p> 
<p>由于官网可能存在被墙的原因，所以下在很慢，这里也提供一个更加便捷的下载地址：<a href="http://ftp.sjtu.edu.cn/sites/ftp.kernel.org/pub/linux/kernel/" rel="nofollow">http://ftp.sjtu.edu.cn/sites/ftp.kernel.org/pub/linux/kernel/</a>。</p> 
<p><img src="https://images2.imgbox.com/b7/53/AYmFRKeR_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-7GMHq4Qv-1665817721406)(linux内核安装编译/image-20221014164656643.png)]"></p> 
<p>根据自己的需求下载相应的版本，我这里下载在的是“<strong>linux-5.19.tar.gz</strong>”版本。</p> 
<h3><a id="linux_18"></a>解压linux内核</h3> 
<p>使用以下命令进行加压下载的linux内核压缩包：</p> 
<pre><code>tar -zxvf linux-5.19.tar.gz 
</code></pre> 
<p>解压后使用<code>ls</code>命令展示文件夹类存在的文件。</p> 
<p><img src="https://images2.imgbox.com/50/ef/R63sSGG6_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ImfswuFn-1665817721407)(linux内核安装编译/image-20221014190053609.png)]"></p> 
<p>在清理多余的中间配置文件，使用<code>make distclean</code>命令。清理后文件夹内部信息将会发生变化。</p> 
<h3><a id="_33"></a>选择参考配置文件</h3> 
<p>使用以下命令选择配置文件，便于后续<strong>config</strong>配置：</p> 
<pre><code class="prism language-sh">cp /boot/config-5.15.0-46-generic .config
</code></pre> 
<p>具体操作如下图所示：</p> 
<p><img src="https://images2.imgbox.com/41/ba/qb1Pz1mX_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-KmaUImaQ-1665817721408)(linux内核安装编译/image-20221014190519931.png)]"></p> 
<h3><a id="_46"></a>配置内核</h3> 
<p>在使用<code>make</code>命令前，需要先安装一些相关的依赖库，便于后续的运行。主要需要执行以下命令：</p> 
<pre><code class="prism language-sh">sudo apt-get update
sudo apt install make
sudo apt-get install gcc
sudo apt-get install libncurses5-dev
sudo apt-get install flex
sudo apt-get install bison
</code></pre> 
<p>使用“<strong>make manuconfig</strong>“进行打开可视化终端，按照自己的需要进行更改参数设置。如果不需要更改，则保存退出就可以继续执行后面操作。</p> 
<p><img src="https://images2.imgbox.com/43/96/SDMi0ibl_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-9S6ygR8C-1665817721408)(linux内核安装编译/image-20221014160251442.png)]"></p> 
<p><img src="https://images2.imgbox.com/a0/26/QH4xAoGT_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-wesFvJ0W-1665817721409)(linux内核安装编译/image-20221014160032148.png)]"></p> 
<p><img src="https://images2.imgbox.com/40/d5/azGjofjT_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-IkAnqnl9-1665817721409)(linux内核安装编译/image-20221014160202555.png)]"></p> 
<h3><a id="_74"></a>编译内核</h3> 
<p>执行<code>make bzImage</code>命令，需要较长的时间（1～2小时左右，耐心等待）。</p> 
<p>其中可能会出现<code>scripts/sign-file.c:25:10: fatal error: openssl/opensslv.h: 没有那个文件或目录</code>等问题。于是执行以下命令安装相关的依赖，应该一次性全部安装完相关的所有依赖，要不然耗时更长。</p> 
<pre><code class="prism language-sh">sudo apt-get install libssl-dev
sudo apt-get install libelf-dev
sudo apt-get install dwarves
sudo apt-get install zstd
</code></pre> 
<p><img src="https://images2.imgbox.com/96/18/PKysfQrq_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-uqZdcMPO-1665817721410)(linux内核安装编译/image-20221014160533758.png)]"></p> 
<p>如果中间出现以下等错误：<code>make[1]: *** 没有规则可制作目标“[debian](https://so.csdn.net/so/search?q=debian&amp;spm=1001.2101.3001.7020)/canonical-certs.pem”,由“certs/x509</code>，那么打开**.config**文件，如下方所是，删除部分内容：如删除“<strong>debian/canonical-certs.pem</strong>”和“<strong>debian/canonical-revoked-certs.pem</strong>”内容，修改为下下图形式。</p> 
<p><img src="https://images2.imgbox.com/ff/b9/DwX4rBU8_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-f2IlXNhr-1665817721410)(linux内核安装编译/image-20221014162314015.png)]"></p> 
<p><img src="https://images2.imgbox.com/10/25/H2TrJRVl_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-jKI9Yh6E-1665817721411)(linux内核安装编译/image-20221014163503371.png)]"></p> 
<p>修改完毕后在次执行“<code>make bzImage</code>”命令将进行编译内核。</p> 
<p>最终内核编译成功将会出现以下信息。</p> 
<p><img src="https://images2.imgbox.com/36/d3/diqZefYY_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-MYmgd3iS-1665817721412)(linux内核安装编译/image-20221014185317402.png)]"></p> 
<h3><a id="_105"></a>编译内核模块</h3> 
<p>使用以下命令进行编译linux内核模块：</p> 
<pre><code class="prism language-sh">make modules
</code></pre> 
<p>将会开始进行编译内核模块，大致需要（2～3小时）。</p> 
<p><img src="https://images2.imgbox.com/60/ad/oyu3R94y_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-HUgHvdyB-1665817721414)(linux内核安装编译/image-20221014185706907.png)]"></p> 
<p>编译成功后将会出现以下信息：</p> 
<p><img src="https://images2.imgbox.com/9b/7c/lD59bwK8_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-NW15J8Y2-1665817721415)(linux内核安装编译/image-20221014224442860.png)]"></p> 
<h3><a id="_123"></a>安装内核模块</h3> 
<p>使用以下命令进行安装内核模块，大概耗时10分钟：</p> 
<pre><code class="prism language-sh">make modules_install
</code></pre> 
<p><img src="https://images2.imgbox.com/64/b6/Kvac5PFl_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-96VoNgnA-1665817721416)(linux内核安装编译/image-20221014224843183-16657589315391.png)]"></p> 
<p>完成安装后，编译好的内核模块会从源码目录复制到<code>/lib/modules/</code>目录下：</p> 
<p><img src="https://images2.imgbox.com/74/c0/RNNvznvQ_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-Fb9UUV2U-1665817721417)(linux内核安装编译/image-20221014225332915-16657592149231.png)]"></p> 
<p>到此，嵌入式Linux内核便下载在编译成功了。</p> 
<p>后续也可以通过参考文献[1]将编译好的Linux进行安装和部署。</p> 
<h2><a id="Reference_143"></a>Reference</h2> 
<p>[1]<a href="https://blog.csdn.net/qq_44631615/article/details/118305753#commentBox">https://blog.csdn.net/qq_44631615/article/details/118305753#commentBox</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1ee81422bfe908b6e288c95ee12a8727/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">计算机网络：应用层 知识点汇总（简化版）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1cdaae4af6735f2791e46c6cadc9c207/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">通过ssh建立两台主机的远程连接实现免密登陆</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>