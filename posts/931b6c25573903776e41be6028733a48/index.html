<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>WPF中修改DataGrid单元格值并保存 - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="WPF中修改DataGrid单元格值并保存" />
<meta property="og:description" content="编辑DataGrid中的单元格的内容然后保存是非常常用的功能。主要涉及到的方法就是DataGrid的CellEditEnding 和BeginningEdit 。其中BeginningEdit 是当单元格选中后，状态为可编辑状态时触发。CellEditEnding 是在单元格失去焦点后触发的事件。 对于编辑DataGrid中单元格内容的实现逻辑比较简单：
1.保存旧的单元格内容。
2.判断修改后的内容是否符合规范。
3.保存到数据库。
以下就是简单的实现逻辑，仅供参考：
前台代码：
&lt;DataGrid Grid.Row=&#34;1&#34; x:Name=&#34;dgData&#34; CellEditEnding=&#34;CellEditEnding&#34; BeginningEdit=&#34;BeginningEdit&#34;&gt; &lt;!--需要完善,除了序号，基本完善--&gt; &lt;DataGrid.Columns&gt; &lt;DataGridTemplateColumn Header=&#34; 序号&#34; Width=&#34;50&#34; MinWidth=&#34;10&#34; IsReadOnly=&#34;True&#34;&gt; &lt;DataGridTemplateColumn.CellTemplate&gt; &lt;DataTemplate&gt; &lt;TextBlock Text=&#34;{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type DataGridRow}}, Path=Header}&#34; HorizontalAlignment=&#34;Left&#34; VerticalAlignment=&#34;Center&#34; Margin=&#34;10,0,0,0&#34;&gt;&lt;/TextBlock&gt; &lt;/DataTemplate&gt; &lt;/DataGridTemplateColumn.CellTemplate&gt; &lt;/DataGridTemplateColumn&gt; &lt;DataGridTextColumn Binding=&#34;{Binding Name}&#34; Width=&#34;*&#34; Header=&#34;账套名称&#34; IsReadOnly=&#34;False&#34;/&gt; &lt;/DataGrid.Columns&gt; &lt;/DataGrid&gt; 后台代码： private void CellEditEnding(object sender, DataGridCellEditEndingEventArgs e) { string newValue = (e.EditingElement as TextBox).Text; //判断新名称和就名称是否一样 if (ZTName!=newValue) { DataAccess.IAccountDAL iaccount = DALResolver.Instance.Resolve&lt;IAccountDAL&gt;(); int count = iaccount." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/931b6c25573903776e41be6028733a48/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-12-26T17:35:44+08:00" />
<meta property="article:modified_time" content="2015-12-26T17:35:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">WPF中修改DataGrid单元格值并保存</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>  <span style="font-size:24px">      编辑DataGrid中的单元格的内容然后保存是非常常用的功能。主要涉及到的方法就是DataGrid的CellEditEnding  和BeginningEdit 。其中BeginningEdit 是当单元格选中后，状态为可编辑状态时触发。CellEditEnding 是在单元格失去焦点后触发的事件。    对于编辑DataGrid中单元格内容的实现逻辑比较简单：</span></p> 
<span style="font-size:24px"><span style="white-space:pre"></span>1.保存旧的单元格内容。<br> <span style="white-space:pre"></span>2.判断修改后的内容是否符合规范。<br> <span style="white-space:pre"></span>3.保存到数据库。<br> <span style="white-space:pre"></span>以下就是简单的实现逻辑，仅供参考：<br> </span> 
<p><span style="font-size:24px">前台代码：</span></p> 
<p><span style="font-size:24px"></span></p> 
<pre><code class="language-plain">  &lt;DataGrid Grid.Row="1" x:Name="dgData" 
                      CellEditEnding="CellEditEnding"
                      BeginningEdit="BeginningEdit"&gt;
            &lt;!--需要完善,除了序号，基本完善--&gt;
            &lt;DataGrid.Columns&gt;

                &lt;DataGridTemplateColumn Header=" 序号" Width="50" MinWidth="10" IsReadOnly="True"&gt;
                    &lt;DataGridTemplateColumn.CellTemplate&gt;
                        &lt;DataTemplate&gt;
                            &lt;TextBlock Text="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type DataGridRow}}, Path=Header}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,0,0,0"&gt;&lt;/TextBlock&gt;

                        &lt;/DataTemplate&gt;
                    &lt;/DataGridTemplateColumn.CellTemplate&gt;
                &lt;/DataGridTemplateColumn&gt;

                &lt;DataGridTextColumn Binding="{Binding Name}" Width="*" Header="账套名称" IsReadOnly="False"/&gt;
              
            &lt;/DataGrid.Columns&gt;
        &lt;/DataGrid&gt;</code></pre> 
<br> 后台代码： 
<p></p> 
<p><span style="font-size:24px"></span></p> 
<pre><code class="language-csharp">        private void CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
        {
           
            
            string newValue = (e.EditingElement as TextBox).Text;

            //判断新名称和就名称是否一样
            if (ZTName!=newValue)
            {


                DataAccess.IAccountDAL iaccount = DALResolver.Instance.Resolve&lt;IAccountDAL&gt;();

                int count = iaccount.Count(newValue);

                if (count&gt;0)
                {
                    MessageBox.Show("账套名称重复，请重新命名！", "警告", MessageBoxButton.OK);
                    (e.EditingElement as TextBox).Text = ZTName;
                    return;
                }
                else
                {
                    int id = (this.dgData.SelectedItem as Founder.Model.Account.ModelAccountInfo).AccountID;
                    if (!iaccount.UpdateZTName(newValue,id))
                    {
                        MessageBox.Show("更新账套名称失败，请重试！","提示",MessageBoxButton.OK);
                    }
                }
                //判断是否重复
                
            }
            
        }

        private string ZTName = string.Empty;
        private void BeginningEdit(object sender, DataGridBeginningEditEventArgs e)
        {
            ZTName = (this.dgData.SelectedItem as Founder.Model.Account.ModelAccountInfo).Name;
            //MessageBox.Show(ZTName);
        }</code></pre> 
<br> 
<span style="white-space:pre"></span>总结：该功能比较简单，主要就是熟悉DataGrid的熟悉和方法。在此，仅作记录。 
<p></p> 
<blockquote style="margin:0px 0px 0px 40px; font-family:'Microsoft YaHei UI','Microsoft YaHei',Georgia,Helvetica,Arial,sans-serif,宋体,PMingLiU,serif; font-size:14.3999996185303px; line-height:16.7999992370605px; widows:auto; border:none; padding:0px"> 
 <div></div> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dc1246b498db0f61c9c8f0f54915d82f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言告警warning: missing braces around initializer详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d8f9bd1a9125b211f323aaf574c4ddd1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Linux内核配置和编译</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>