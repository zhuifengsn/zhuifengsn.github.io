<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Excel之index、MATCH面试题、VLOOKUP函数， - 追风少年的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Excel之index、MATCH面试题、VLOOKUP函数，" />
<meta property="og:description" content="VLOOKUP() 在表格的首列查找指定的数值，并返回表格当前行中指定列处的数值。
结构：=VLOOKUP(查找值,查找区域,列序数,匹配条件)
解释：=VLOOKUP(找谁,在哪里找,第几列,0或1)
1.目的：根据【产品】查找【销量】
公式：=VLOOKUP(E2,$B$1:$C$11,2,0)
说明：“查找值”E2也就是【产品】，“查找区域”根据查找值【产品】在所选的数据表中，也就是$B$1:$C$11中必须位于第一列。“列序数”为3，表示对应结果【销量】在所选区域中排第3列；“匹配条件”为0，表示精确匹配，若为1则代表近似匹配。
2.目的：根据【产品】查找【日期】
公式：=VLOOKUP(E2,$B$1:$D$11,3,0)
说明：“查找值”G2也就是【产品】，由于数据表中【产品】列在【日期】列的后面，无法按照VLOOKUP函数的使用方法（查找区域要根据查找值位于第一列进行）所以我们要将【产品】排列在数据表中的第一列，则增加一列【辅助列】代表【日期】列，数据表所选区域也就是$B$1:$D$11区域。“列序数”为3，表示对应结果【辅助列】在所选区域中排第3列；“匹配条件”为0，表示精确匹配
=VLOOKUP(E2,$B$1:$D$11,3,0)
VLookup():用于从一列或一行或数组中查找一个值。
“=VLOOKUP(A14,A1:A11,B1:B11)”获得了第一个进价。这个公式里有三个参数，值如下：
第一个参数“Lookup_value”：A14，是要查找的值；第二个参数“lookup_vector”：A1:A11，是要查找的范围；第三个参数“Result_vector”：B1:B11，是要获得的值。 index函数 Index函数：根据数据区域中的行列号返回区域中对应的值
INDEX(array, row_num, [column_num])
第1参数：要查找的单元格区域；第2参数：返回单元格区域的某行；第3参数：返回单元格区域的某列； match函数 语法：=MATCH(lookup_value, lookup_array, [match_type])
第一参数：查找值第二参数：查找的数据区域第三参数：匹配类型，在这里我们将其设置为0即可，表示精确匹配 INDEX和MATCH结合使用
=INDEX($G$2:$G$5,MATCH(C2,$F$2:$F$5,1))
countif():在指定区域中按指定的条件对单元格进行计数
=countif（range，criteria）
参数意义：
参数range：表示要计算其中满足条件的非空单元格数目的单元格区域；参数criteria：表示统计条件，其条件的形式可以为数字、表达式或文本，也可以使用通配符。 统计空白单元格
COUNTBLANK函数是计算区域内空白单元格的个数。
COUNTBLANK()
SUMPRODUCT函数：返回相应的数据或区域乘积之和
在列表中计数操作： OFFSET：函数用于返回一个单元格或单元格区域的引用，该引用是相对于另一个单元格或区域的。
OFFSET(reference, rows, cols, [height], [width])
reference 是起始单元格或区域的引用。rows 是从起始单元格或区域开始要偏移的行数（可以是负数，表示向上偏移）。cols 是从起始单元格或区域开始要偏移的列数（可以是负数，表示向左偏移）。[height] 和 [width] 是可选参数，分别表示返回引用区域的高度和宽度。 =SUM(OFFSET(D3,,,,MATCH($B$1,$D$2:$O$2,0)))
通过单独获取累计的操作： SUM(INDEX(D5:O12,MATCH(B15,B5:B12,0),MATCH(B16,D4:O4,0)):INDEX(D5:O12,MATCH(B15,B5:B12,0),MATCH(B17,D4:O4,0)))
解说：
这个Excel公式使用了INDEX和MATCH函数来动态地确定一个范围，并对这个范围内的单元格进行求和。让我们逐步解析这个公式：
MATCH函数:
MATCH(lookup_value, lookup_array, [match_type])
MATCH函数返回lookup_value在lookup_array中的相对位置。match_type参数决定了查找的类型，其中0表示精确匹配。
在你的公式中，有三个MATCH函数：
MATCH(G17,B5:B12,0)：查找G17单元格中的值在B5:B12范围内的位置。MATCH(G18,D4:O4,0)：查找G18单元格中的值在D4:O4范围内的位置（这通常是一个标题行，表示列的标识）。MATCH(G19,D4:O4,0)：查找G19单元格中的值在D4:O4范围内的位置。 INDEX函数:
INDEX(array, row_num, [column_num], [area_num])
INDEX函数返回指定数组中某个单元格的值，该单元格由行号和列号确定。
在你的公式中，有两个INDEX函数：
第一个INDEX函数确定了范围的起始单元格：INDEX(D5:O12,MATCH(G17,B5:B12,0),MATCH(G18,D4:O4,0))。这里，它找到G17在B5:B12中的行号，以及G18在D4:O4中的列号，从而确定了起始单元格。第二个INDEX函数确定了范围的结束单元格：INDEX(D5:O12,MATCH(G17,B5:B12,0),MATCH(G19,D4:O4,0))。与第一个INDEX类似，但它使用G19的值来确定列号，从而确定了结束单元格。 SUM函数:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/019cbdea4361b0615ff39466154a97c2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-22T19:12:15+08:00" />
<meta property="article:modified_time" content="2024-02-22T19:12:15+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="追风少年的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">追风少年的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Excel之index、MATCH面试题、VLOOKUP函数，</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4><strong>VLOOKUP()</strong></h4> 
<p>在表格的首列查找指定的数值，并返回表格当前行中指定列处的数值。</p> 
<p>结构：=VLOOKUP(查找值,查找区域,列序数,匹配条件)</p> 
<p>解释：=VLOOKUP(找谁,在哪里找,第几列,0或1)</p> 
<p><strong>1.目的：根据【产品】查找【销量】</strong></p> 
<p>公式：=VLOOKUP(E2,$B$1:$C$11,2,0)</p> 
<p><img alt="" height="383" src="https://images2.imgbox.com/a7/a2/mjC9Hej6_o.png" width="716"></p> 
<p>说明：“查找值”E2也就是【产品】，“查找区域”根据查找值【产品】在所选的数据表中，也就是$B$1:$C$11中必须位于第一列。“列序数”为3，表示对应结果【销量】在所选区域中排第3列；“匹配条件”为0，表示精确匹配，若为1则代表近似匹配。</p> 
<p><strong>2.目的：根据【产品】查找【日期】</strong></p> 
<p>公式：=VLOOKUP(E2,$B$1:$D$11,3,0)</p> 
<p>说明：“查找值”G2也就是【产品】，由于数据表中【产品】列在【日期】列的后面，无法按照VLOOKUP函数的使用方法（查找区域要根据查找值位于第一列进行）所以我们要将【产品】排列在数据表中的第一列，则增加一列【辅助列】代表【日期】列，数据表所选区域也就是$B$1:$D$11区域。“列序数”为3，表示对应结果【辅助列】在所选区域中排第3列；“匹配条件”为0，表示精确匹配</p> 
<p>=VLOOKUP(E2,$B$1:$D$11,3,0)</p> 
<p><img alt="" height="185" src="https://images2.imgbox.com/41/7d/SkYZ9VK0_o.png" width="1016"></p> 
<p>VLookup():用于从一列或一行或数组中查找一个值。</p> 
<p>“=VLOOKUP(A14,A1:A11,B1:B11)”获得了第一个进价。这个公式里有三个参数，值如下：</p> 
<ul><li>第一个参数“Lookup_value”：A14，是要查找的值；</li><li>第二个参数“lookup_vector”：A1:A11，是要查找的范围；</li><li>第三个参数“Result_vector”：B1:B11，是要获得的值。</li></ul> 
<p><img alt="" height="469" src="https://images2.imgbox.com/3e/c4/9hTE7Hka_o.png" width="605"></p> 
<h4><strong>index函数</strong></h4> 
<p>Index函数：根据数据区域中的行列号返回区域中对应的值</p> 
<p>INDEX(array, row_num, [column_num])</p> 
<ul><li>第1参数：要查找的单元格区域；</li><li>第2参数：返回单元格区域的某行；</li><li>第3参数：返回单元格区域的某列；</li></ul> 
<h4><strong>match函数</strong></h4> 
<p>语法：=MATCH(lookup_value, lookup_array, [match_type])</p> 
<ul><li>第一参数：查找值</li><li>第二参数：查找的数据区域</li><li>第三参数：匹配类型，在这里我们将其设置为0即可，表示精确匹配</li></ul> 
<p><strong>INDEX和MATCH结合使用</strong></p> 
<p>=INDEX($G$2:$G$5,MATCH(C2,$F$2:$F$5,1))</p> 
<p><img alt="" height="280" src="https://images2.imgbox.com/54/35/JOErbRUG_o.png" width="731"></p> 
<p>countif():在指定区域中按指定的条件对单元格进行计数</p> 
<p>=countif（range，criteria）</p> 
<p>参数意义：</p> 
<ul><li>参数range：表示要计算其中满足条件的非空单元格数目的单元格区域；</li><li>参数criteria：表示统计条件，其条件的形式可以为数字、表达式或文本，也可以使用通配符。</li></ul> 
<p>统计空白单元格</p> 
<p>COUNTBLANK函数是计算区域内空白单元格的个数。</p> 
<p>COUNTBLANK()</p> 
<p>SUMPRODUCT函数：返回相应的数据或区域乘积之和</p> 
<h4><strong>在列表中计数操作：</strong></h4> 
<p>OFFSET：函数用于返回一个单元格或单元格区域的引用，该引用是相对于另一个单元格或区域的。</p> 
<p><code>OFFSET(reference, rows, cols, [height], [width])</code></p> 
<ul><li><code>reference</code> 是起始单元格或区域的引用。</li><li><code>rows</code> 是从起始单元格或区域开始要偏移的行数（可以是负数，表示向上偏移）。</li><li><code>cols</code> 是从起始单元格或区域开始要偏移的列数（可以是负数，表示向左偏移）。</li><li><code>[height]</code> 和 <code>[width]</code> 是可选参数，分别表示返回引用区域的高度和宽度。</li></ul> 
<p>=SUM(OFFSET(D3,,,,MATCH($B$1,$D$2:$O$2,0)))</p> 
<p><img alt="" height="239" src="https://images2.imgbox.com/b3/b3/09rdwURM_o.png" width="1200"></p> 
<h4><strong> 通过单独获取累计的操作：</strong></h4> 
<p><span style="color:#0d0016;"> SUM(INDEX(D5:O12,MATCH(B15,B5:B12,0),MATCH(B16,D4:O4,0)):INDEX(D5:O12,MATCH(B15,B5:B12,0),MATCH(B17,D4:O4,0)))</span><img alt="" height="745" src="https://images2.imgbox.com/c7/72/7ps2ojM7_o.png" width="1200"></p> 
<p>解说：</p> 
<p>这个Excel公式使用了<code>INDEX</code>和<code>MATCH</code>函数来动态地确定一个范围，并对这个范围内的单元格进行求和。让我们逐步解析这个公式：</p> 
<ol><li> <p><strong>MATCH函数</strong>:</p> <p><code>MATCH(lookup_value, lookup_array, [match_type])</code></p> <p><code>MATCH</code>函数返回<code>lookup_value</code>在<code>lookup_array</code>中的相对位置。<code>match_type</code>参数决定了查找的类型，其中0表示精确匹配。</p> <p>在你的公式中，有三个<code>MATCH</code>函数：</p> 
  <ul><li><code>MATCH(G17,B5:B12,0)</code>：查找<code>G17</code>单元格中的值在<code>B5:B12</code>范围内的位置。</li><li><code>MATCH(G18,D4:O4,0)</code>：查找<code>G18</code>单元格中的值在<code>D4:O4</code>范围内的位置（这通常是一个标题行，表示列的标识）。</li><li><code>MATCH(G19,D4:O4,0)</code>：查找<code>G19</code>单元格中的值在<code>D4:O4</code>范围内的位置。</li></ul></li><li> <p><strong>INDEX函数</strong>:</p> <p><code>INDEX(array, row_num, [column_num], [area_num])</code></p> <p><code>INDEX</code>函数返回指定数组中某个单元格的值，该单元格由行号和列号确定。</p> <p>在你的公式中，有两个<code>INDEX</code>函数：</p> 
  <ul><li>第一个<code>INDEX</code>函数确定了范围的起始单元格：<code>INDEX(D5:O12,MATCH(G17,B5:B12,0),MATCH(G18,D4:O4,0))</code>。这里，它找到<code>G17</code>在<code>B5:B12</code>中的行号，以及<code>G18</code>在<code>D4:O4</code>中的列号，从而确定了起始单元格。</li><li>第二个<code>INDEX</code>函数确定了范围的结束单元格：<code>INDEX(D5:O12,MATCH(G17,B5:B12,0),MATCH(G19,D4:O4,0))</code>。与第一个<code>INDEX</code>类似，但它使用<code>G19</code>的值来确定列号，从而确定了结束单元格。</li></ul></li><li> <p><strong>SUM函数</strong>:</p> <p><code>SUM(number1, [number2], ...)</code></p> <p><code>SUM</code>函数计算一系列数值的总和。</p> <p>在你的公式中，<code>SUM</code>函数计算了由两个<code>INDEX</code>函数定义的范围内所有单元格的总和。</p> </li></ol> 
<p>综上所述，这个公式的作用是：</p> 
<ul><li>根据<code>G17</code>的值在<code>B5:B12</code>中找到对应的行号。</li><li>根据<code>G18</code>和<code>G19</code>的值在<code>D4:O4</code>中找到对应的列号，从而确定一个范围。</li><li>对这个范围内的所有单元格进行求和。</li></ul> 
<p>例如，如果<code>G17</code>的值对应于<code>B5:B12</code>中的第3行，<code>G18</code>的值对应于<code>D4:O4</code>中的第5列，而<code>G19</code>的值对应于第7列，那么这个公式将计算从<code>D7</code>到<code>O7</code>范围内所有单元格的总和。</p> 
<p></p> 
<p class="img-center"><img alt="文心大模型3.5生成" height="40" src="https://images2.imgbox.com/4d/b6/N8JLcvqg_o.png" width="236"></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ee3ba2621b86f7de9baac5e0920ab5c9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言翻译环境：预编译&#43;编译&#43;汇编&#43;链接详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e137fdb16f297a65c26a3fb63cc86340/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">云原生高级第一次作业</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 追风少年的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>