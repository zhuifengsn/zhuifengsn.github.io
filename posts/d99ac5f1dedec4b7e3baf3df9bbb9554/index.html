<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringBootå®ç°å›ºå®šã€åŠ¨æ€å®šæ—¶ä»»åŠ¡ | ä¸‰ç§å®ç°æ–¹å¼ - è¿½é£å°‘å¹´çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="SpringBootå®ç°å›ºå®šã€åŠ¨æ€å®šæ—¶ä»»åŠ¡ | ä¸‰ç§å®ç°æ–¹å¼" />
<meta property="og:description" content="å‰è¨€ï¼š é˜…è¯»å®Œæœ¬æ–‡ï¼šğŸ±â€ğŸ‘“
çŸ¥æ™“ SpringBoot ç”¨æ³¨è§£å¦‚ä½•å®ç°å®šæ—¶ä»»åŠ¡æ˜ç™½ SpringBoot å¦‚ä½•å®ç°ä¸€ä¸ªåŠ¨æ€å®šæ—¶ä»»åŠ¡ ï¼ˆä¸æ•°æ®åº“ç›¸å…³è”å®ç°ï¼‰ç†è§£ SpringBoot å®ç°è®¾ç½®æ—¶é—´æ‰§è¡Œå®šæ—¶ä»»åŠ¡ ï¼ˆä½¿ç”¨ ThreadPoolTaskScheduler å®ç°ï¼‰ ä¸€ã€æ³¨è§£å®ç°å®šæ—¶ä»»åŠ¡ ç”¨æ³¨è§£å®ç°æ˜¯çœŸçš„ç®€å•ï¼Œåªè¦ä¼š cron è¡¨è¾¾å¼å°±è¡Œã€‚ğŸ§™â€â™‚ï¸
ç¬¬ä¸€æ­¥ï¼š ä¸»å¯åŠ¨ç±»ä¸ŠåŠ ä¸Š @EnableScheduling æ³¨è§£
@EnableScheduling @SpringBootApplication public class SpringBootScheduled { public static void main(String[] args) { SpringApplication.run(SpringBootScheduled.class); } } å¤åˆ¶ä»£ç  ç¬¬äºŒæ­¥ï¼šå†™ä¸€ä¸ªç±»ï¼Œæ³¨å…¥åˆ°Springï¼Œå…³é”®å°±æ˜¯ @Scheduled æ³¨è§£ã€‚ ï¼ˆ) é‡Œå°±æ˜¯ cron è¡¨è¾¾å¼ï¼Œç”¨æ¥è¯´æ˜è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œå‘¨æœŸçš„ã€‚ ğŸ›Œ
/** * å®šæ—¶ä»»åŠ¡ é™æ€å®šæ—¶ä»»åŠ¡ * * ç¬¬ä¸€ä½ï¼Œè¡¨ç¤ºç§’ï¼Œå–å€¼0-59 * ç¬¬äºŒä½ï¼Œè¡¨ç¤ºåˆ†ï¼Œå–å€¼0-59 * ç¬¬ä¸‰ä½ï¼Œè¡¨ç¤ºå°æ—¶ï¼Œå–å€¼0-23 * ç¬¬å››ä½ï¼Œæ—¥æœŸå¤©/æ—¥ï¼Œå–å€¼1-31 * ç¬¬äº”ä½ï¼Œæ—¥æœŸæœˆä»½ï¼Œå–å€¼1-12 * ç¬¬å…­ä½ï¼Œæ˜ŸæœŸï¼Œå–å€¼1-7ï¼Œ1è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼Œ2è¡¨ç¤ºæ˜ŸæœŸä¸€ * ç¬¬ä¸ƒä½ï¼Œå¹´ä»½ï¼Œå¯ä»¥ç•™ç©ºï¼Œå–å€¼1970-2099 * @author crush * @since 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhuifengsn.github.io/posts/d99ac5f1dedec4b7e3baf3df9bbb9554/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-27T15:23:38+08:00" />
<meta property="article:modified_time" content="2023-03-27T15:23:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="è¿½é£å°‘å¹´çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">è¿½é£å°‘å¹´çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringBootå®ç°å›ºå®šã€åŠ¨æ€å®šæ—¶ä»»åŠ¡ | ä¸‰ç§å®ç°æ–¹å¼</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3>å‰è¨€ï¼š</h3> 
<p>é˜…è¯»å®Œæœ¬æ–‡ï¼šğŸ±â€ğŸ‘“</p> 
<ol><li>çŸ¥æ™“ <code>SpringBoot</code> ç”¨æ³¨è§£å¦‚ä½•å®ç°å®šæ—¶ä»»åŠ¡</li><li>æ˜ç™½ <code>SpringBoot</code> å¦‚ä½•å®ç°ä¸€ä¸ªåŠ¨æ€å®šæ—¶ä»»åŠ¡ ï¼ˆä¸æ•°æ®åº“ç›¸å…³è”å®ç°ï¼‰</li><li>ç†è§£ <code>SpringBoot</code> å®ç°è®¾ç½®æ—¶é—´æ‰§è¡Œå®šæ—¶ä»»åŠ¡ ï¼ˆä½¿ç”¨ <code>ThreadPoolTaskScheduler </code>å®ç°ï¼‰</li></ol> 
<h3>ä¸€ã€æ³¨è§£å®ç°å®šæ—¶ä»»åŠ¡</h3> 
<p>ç”¨æ³¨è§£å®ç°æ˜¯çœŸçš„ç®€å•ï¼Œåªè¦ä¼š cron è¡¨è¾¾å¼å°±è¡Œã€‚ğŸ§™â€â™‚ï¸</p> 
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼š ä¸»å¯åŠ¨ç±»ä¸ŠåŠ ä¸Š <code>@EnableScheduling</code> æ³¨è§£</p> 
<pre><code>@EnableScheduling
@SpringBootApplication
public class SpringBootScheduled {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootScheduled.class);
    }
}
å¤åˆ¶ä»£ç </code></pre> 
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼šå†™ä¸€ä¸ªç±»ï¼Œæ³¨å…¥åˆ°Springï¼Œå…³é”®å°±æ˜¯ <code>@Scheduled</code> æ³¨è§£ã€‚ ï¼ˆ) é‡Œå°±æ˜¯ cron è¡¨è¾¾å¼ï¼Œç”¨æ¥è¯´æ˜è¿™ä¸ªæ–¹æ³•çš„æ‰§è¡Œå‘¨æœŸçš„ã€‚ ğŸ›Œ</p> 
<pre><code>/**
 * å®šæ—¶ä»»åŠ¡ é™æ€å®šæ—¶ä»»åŠ¡
 *
 * ç¬¬ä¸€ä½ï¼Œè¡¨ç¤ºç§’ï¼Œå–å€¼0-59
 * ç¬¬äºŒä½ï¼Œè¡¨ç¤ºåˆ†ï¼Œå–å€¼0-59
 * ç¬¬ä¸‰ä½ï¼Œè¡¨ç¤ºå°æ—¶ï¼Œå–å€¼0-23
 * ç¬¬å››ä½ï¼Œæ—¥æœŸå¤©/æ—¥ï¼Œå–å€¼1-31
 * ç¬¬äº”ä½ï¼Œæ—¥æœŸæœˆä»½ï¼Œå–å€¼1-12
 * ç¬¬å…­ä½ï¼Œæ˜ŸæœŸï¼Œå–å€¼1-7ï¼Œ1è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼Œ2è¡¨ç¤ºæ˜ŸæœŸä¸€
 * ç¬¬ä¸ƒä½ï¼Œå¹´ä»½ï¼Œå¯ä»¥ç•™ç©ºï¼Œå–å€¼1970-2099
 * @author crush
 * @since 1.0.0
 * @Date: 2021-07-27 21:13
 */
@Component
public class SchedulingTaskBasic {

    /**
     * æ¯äº”ç§’æ‰§è¡Œä¸€æ¬¡
     */
    @Scheduled(cron = "*/5 * * * * ?")
    private void printNowDate() {
        long nowDateTime = System.currentTimeMillis();
        System.out.println("å›ºå®šå®šæ—¶ä»»åŠ¡æ‰§è¡Œ:---&gt;"+nowDateTime+"ï¼Œæ­¤ä»»åŠ¡ä¸ºæ¯äº”ç§’æ‰§è¡Œä¸€æ¬¡");
    }
}
å¤åˆ¶ä»£ç </code></pre> 
<p>æ‰§è¡Œæ•ˆæœï¼š</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/f7/06/XWOgos39_o.png"></p> 
<p>æºç åœ¨æ–‡æœ«ã€‚ğŸ</p> 
<h3>äºŒã€åŠ¨æ€å®šæ—¶ä»»åŠ¡</h3> 
<p>å…¶å®ä¹Ÿéå¸¸çš„ç®€å•ã€‚</p> 
<h4>2.1ã€å»ºæ•°æ®è¡¨</h4> 
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼šå»ºä¸ªæ•°æ®åº“è¡¨ã€‚</p> 
<pre><code>CREATE TABLE `tb_cron`  (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'åŠ¨æ€å®šæ—¶ä»»åŠ¡æ—¶é—´è¡¨',
  `cron_expression` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'å®šæ—¶ä»»åŠ¡è¡¨è¾¾å¼',
  `cron_describe` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT 'æè¿°',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 3 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;

INSERT INTO `tb_cron` VALUES (1, '0 0/1 * * * ?', 'æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡');
å¤åˆ¶ä»£ç </code></pre> 
<h4>2.2ã€å¯¼å…¥ä¾èµ–ï¼ŒåŸºç¡€ç¼–ç </h4> 
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼šå¯¼å…¥æ•°æ®åº“ç›¸å…³ä¾èµ–ï¼Œåšåˆ°èƒ½ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®ã€‚å¤§å®¶éƒ½ä¼šã€‚ğŸ¤¸â€â™‚ï¸</p> 
<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼š ç¼–ç </p> 
<p>å®ä½“ç±»ï¼š</p> 
<pre><code>@Data
@TableName("tb_cron")
public class Cron {
    private Long id;
    private String cronExpression;
    private String cronDescribe;
}
å¤åˆ¶ä»£ç </code></pre> 
<p>mapperå±‚ï¼š</p> 
<pre><code>@Repository
public interface CronMapper extends BaseMapper&lt;Cron&gt; {
    @Select("select cron_expression from tb_cron where id=1")
    String getCron1();
}
å¤åˆ¶ä»£ç </code></pre> 
<h4>2.3ã€ä¸»è¦å®ç°ä»£ç </h4> 
<p>ç¬¬å››æ­¥ï¼šå†™ä¸€ä¸ªç±» å®ç° <code>SchedulingConfigurer</code>ğŸ»</p> 
<p>å®ç° <code>void configureTasks(ScheduledTaskRegistrar taskRegistrar);</code> æ–¹æ³•ï¼Œæ­¤æ–¹æ³•çš„ä½œç”¨å°±æ˜¯æ ¹æ®ç»™å®šçš„ ScheduledTaskRegistrar æ³¨å†Œ TaskScheduler å’Œç‰¹å®šçš„Taskå®ä¾‹</p> 
<pre><code>@Component
public class CompleteScheduleConfig implements SchedulingConfigurer {

    @Autowired
    @SuppressWarnings("all")
    CronMapper cronMapper;

    /**
     * æ‰§è¡Œå®šæ—¶ä»»åŠ¡.
     */
    @Override
    public void configureTasks(ScheduledTaskRegistrar taskRegistrar) {
        taskRegistrar.addTriggerTask(
                //1.æ·»åŠ ä»»åŠ¡å†…å®¹(Runnable)
                () -&gt; System.out.println("æ‰§è¡ŒåŠ¨æ€å®šæ—¶ä»»åŠ¡1: " + LocalDateTime.now().toLocalTime()+",æ­¤ä»»åŠ¡æ‰§è¡Œå‘¨æœŸç”±æ•°æ®åº“ä¸­çš„cronè¡¨è¾¾å¼å†³å®š"),
                //2.è®¾ç½®æ‰§è¡Œå‘¨æœŸ(Trigger)
                triggerContext -&gt; {
                    //2.1 ä»æ•°æ®åº“è·å–æ‰§è¡Œå‘¨æœŸ
                    String cron = cronMapper.getCron1();
                    //2.2 åˆæ³•æ€§æ ¡éªŒ.
                    if (cron!=null) {
                        // Omitted Code ..
                    }
                    //2.3 è¿”å›æ‰§è¡Œå‘¨æœŸ(Date)
                    return new CronTrigger(cron).nextExecutionTime(triggerContext);
                }
        );
    }
}
å¤åˆ¶ä»£ç </code></pre> 
<h4>2.4ã€æ•ˆæœ</h4> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/66/c3/FOWe0iNN_o.png"></p> 
<p>æ³¨æ„ï¼šå½“ä½ ä¿®æ”¹äº†ä»»åŠ¡æ‰§è¡Œå‘¨æœŸåï¼Œç”Ÿæ•ˆæ—¶é—´ä¸ºæ‰§è¡Œå®Œæœ€è¿‘ä¸€æ¬¡ä»»åŠ¡åã€‚è¿™ä¸€ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„ï¼Œç”¨ç”Ÿæ´»ä¸­çš„ä¾‹å­ç†è§£å°±æ˜¯æˆ‘ä»¬å–æ¶ˆç”µè¯å¡çš„å¥—é¤ä¹Ÿè¦ä¸‹ä¸ªæœˆç”Ÿæ•ˆï¼Œå«ä¹‰æ˜¯ä¸€æ ·çš„ã€‚</p> 
<p>æºç åŒæ ·åœ¨æ–‡æœ«ã€‚</p> 
<h3>ä¸‰ã€å®ç°è®¾ç½®æ—¶é—´å®šæ—¶ä»»åŠ¡</h3> 
<p>é€šå¸¸ä¸šåŠ¡åœºæ™¯æ˜¯æˆ‘å‰è¨€ä¸­è¯´çš„é‚£æ ·ï¼Œæ˜¯ä¸€æ¬¡æ€§çš„å®šæ—¶ä»»åŠ¡ã€‚å¦‚ï¼šæˆ‘è®¾ç½®äº†æˆ‘å†™çš„è¿™ç¯‡æ–‡ç« çš„å‘å¸ƒæ—¶é—´ä¸ºä»Šå¤©ä¸‹åˆçš„ä¸¤ç‚¹ï¼Œæ‰§è¡Œå®Œå°±åˆ é™¤æ²¡æœ‰äº†ã€‚ä¸€æ¬¡æ€§çš„ã€‚</p> 
<p>å®ç°ä¸»è¦ä¾é äº <code>TaskScheduler</code> çš„<code>ScheduledFuture&lt;?&gt; schedule(Runnable task, Trigger trigger);</code>æ–¹æ³•æ¥å®ç°ã€‚å…¶æœ¬è´¨å’ŒåŠ¨æ€å®šæ—¶ä»»åŠ¡çš„å®ç°æ˜¯ä¸€æ ·çš„ã€‚</p> 
<h4>3.1ã€å®ç°é‡ç‚¹</h4> 
<p>ä»£ç ä¸­éƒ½å«æœ‰æ³¨è§£ï¼Œä¸å¤šåšé˜è¿°ã€‚</p> 
<pre><code>import cn.hutool.core.convert.ConverterRegistry;
import com.crush.scheduled.entity.Task;
import lombok.extern.slf4j.Slf4j;
import org.springframework.scheduling.concurrent.ThreadPoolTaskScheduler;
import org.springframework.stereotype.Component;

import java.time.LocalDateTime;
import java.util.*;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.CopyOnWriteArrayList;
import java.util.concurrent.ScheduledFuture;

/**
 * @author crush
 */
@Component
@Slf4j
public class DynamicTaskService {

    /**
     * ä»¥ä¸‹ä¸¤ä¸ªéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»ã€‚
     */
    public Map&lt;String, ScheduledFuture&lt;?&gt;&gt; taskMap = new ConcurrentHashMap&lt;&gt;();
    public List&lt;String&gt; taskList = new CopyOnWriteArrayList&lt;String&gt;();


    private final ThreadPoolTaskScheduler syncScheduler;

    public DynamicTaskService(ThreadPoolTaskScheduler syncScheduler) {
        this.syncScheduler = syncScheduler;
    }

    /**
     * æŸ¥çœ‹å·²å¼€å¯ä½†è¿˜æœªæ‰§è¡Œçš„åŠ¨æ€ä»»åŠ¡
     * @return
     */
    public List&lt;String&gt; getTaskList() {
        return taskList;
    }


    /**
     * æ·»åŠ ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡
     *
     * @param task
     * @return
     */
    public boolean add(Task task) {
        // æ­¤å¤„çš„é€»è¾‘æ˜¯ ï¼Œå¦‚æœå½“å‰å·²ç»æœ‰è¿™ä¸ªåå­—çš„ä»»åŠ¡å­˜åœ¨ï¼Œå…ˆåˆ é™¤ä¹‹å‰çš„ï¼Œå†æ·»åŠ ç°åœ¨çš„ã€‚ï¼ˆå³é‡å¤å°±è¦†ç›–ï¼‰
        if (null != taskMap.get(task.getName())) {
            stop(task.getName());
        }

        // hutool å·¥å…·åŒ…ä¸‹çš„ä¸€ä¸ªè½¬æ¢ç±»å‹å·¥å…·ç±» å¥½ç”¨çš„å¾ˆ
        ConverterRegistry converterRegistry = ConverterRegistry.getInstance();
        Date startTime = converterRegistry.convert(Date.class, task.getStart());

        // schedule :è°ƒåº¦ç»™å®šçš„Runnable ï¼Œåœ¨æŒ‡å®šçš„æ‰§è¡Œæ—¶é—´è°ƒç”¨å®ƒã€‚
        //ä¸€æ—¦è°ƒåº¦ç¨‹åºå…³é—­æˆ–è¿”å›çš„ScheduledFutureè¢«å–æ¶ˆï¼Œæ‰§è¡Œå°†ç»“æŸã€‚
        //å‚æ•°ï¼š
        //ä»»åŠ¡ â€“ è§¦å‘å™¨è§¦å‘æ—¶æ‰§è¡Œçš„ Runnable
        //startTime â€“ ä»»åŠ¡æ‰€éœ€çš„æ‰§è¡Œæ—¶é—´ï¼ˆå¦‚æœè¿™æ˜¯è¿‡å»ï¼Œåˆ™ä»»åŠ¡å°†ç«‹å³æ‰§è¡Œï¼Œå³å°½å¿«æ‰§è¡Œï¼‰
        ScheduledFuture&lt;?&gt; schedule = syncScheduler.schedule(getRunnable(task), startTime);
        taskMap.put(task.getName(), schedule);
        taskList.add(task.getName());
        return true;
    }


    /**
     * è¿è¡Œä»»åŠ¡
     *
     * @param task
     * @return
     */
    public Runnable getRunnable(Task task) {
        return () -&gt; {
            log.info("---åŠ¨æ€å®šæ—¶ä»»åŠ¡è¿è¡Œ---");
            try {
                System.out.println("æ­¤æ—¶æ—¶é—´==&gt;" + LocalDateTime.now());
                System.out.println("taskä¸­è®¾å®šçš„æ—¶é—´==&gt;" + task);
                Thread.sleep(10);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            log.info("---end--------");
        };
    }

    /**
     * åœæ­¢ä»»åŠ¡
     *
     * @param name
     * @return
     */
    public boolean stop(String name) {
        if (null == taskMap.get(name)) {
            return false;
        }
        ScheduledFuture&lt;?&gt; scheduledFuture = taskMap.get(name);
        scheduledFuture.cancel(true);
        taskMap.remove(name);
        taskList.remove(name);
        return true;
    }
}
å¤åˆ¶ä»£ç </code></pre> 
<h4>3.2ã€å¼‚æ­¥çº¿ç¨‹æ± çš„é…ç½®</h4> 
<pre><code>/**
 * å¼‚æ­¥çº¿ç¨‹æ± ThreadPoolExecutor é…ç½®ç±»
 *
 * @Author: crush
 * @Date: 2021-07-23 14:14
 */
@Configuration
public class ThreadPoolTaskExecutorConfig {

    @Bean
    public ThreadPoolTaskScheduler syncScheduler() {
        ThreadPoolTaskScheduler syncScheduler = new ThreadPoolTaskScheduler();
        syncScheduler.setPoolSize(5);
        // è¿™é‡Œç»™çº¿ç¨‹è®¾ç½®åå­—ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨é¡¹ç›®èƒ½å¤Ÿæ›´å¿«é€Ÿçš„å®šä½é”™è¯¯ã€‚
        syncScheduler.setThreadGroupName("syncTg");
        syncScheduler.setThreadNamePrefix("syncThread-");
        syncScheduler.initialize();
        return syncScheduler;
    }
}

å¤åˆ¶ä»£ç </code></pre> 
<h4>3.3ã€ä¸šåŠ¡ä»£ç </h4> 
<p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ç»™é¡¹ç›®ä¸­çš„ <code>LocalDateTime</code> åšäº†ç±»å‹è½¬æ¢ã€‚è¿™é‡Œæ²¡è´´å‡ºæ¥ï¼ˆä¸»è¦æ˜¯å¤åˆ¶ä»¥å‰çš„ä»£ç é—ç•™ä¸‹æ¥çš„ï¼Œæºç ä¸­éƒ½æœ‰ï¼‰</p> 
<p>å¤§å®¶ç®€å•ä½¿ç”¨ï¼Œå¯ä»¥ç›´æ¥ç”¨æ³¨è§£ æ ‡æ³¨åœ¨ <code>LocalDateTime</code> å±æ€§ä¸Šå³å¯ã€‚</p> 
<pre><code>package com.crush.scheduled.controller;
import com.crush.scheduled.entity.Task;
import com.crush.scheduled.service.DynamicTaskService;
import org.springframework.web.bind.annotation.*;

import java.util.List;

/**
 * @Author: crush
 * @Date: 2021-07-29 15:26
 * version 1.0
 */
@RestController
@RequestMapping("/dynamicTask")
public class DynamicTaskController {

    private final DynamicTaskService dynamicTask;

    public DynamicTaskController(DynamicTaskService dynamicTask) {
        this.dynamicTask = dynamicTask;
    }

    /**
     * æŸ¥çœ‹å·²å¼€å¯ä½†è¿˜æœªæ‰§è¡Œçš„åŠ¨æ€ä»»åŠ¡
     * @return
     */
    @GetMapping
    public List&lt;String&gt; getStartingDynamicTask(){
        return dynamicTask.getTaskList();
    }


    /**
     * å¼€å¯ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡
     * @param task
     * @return
     */
    @PostMapping("/dynamic")
    public String startDynamicTask(@RequestBody Task task){
        // å°†è¿™ä¸ªæ·»åŠ åˆ°åŠ¨æ€å®šæ—¶ä»»åŠ¡ä¸­å»
        dynamicTask.add(task);
         return "åŠ¨æ€ä»»åŠ¡:"+task.getName()+" å·²å¼€å¯";
    }


    /**
     *  æ ¹æ®åç§° åœæ­¢ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡
     * @param name
     * @return
     */
    @DeleteMapping("/{name}")
    public String stopDynamicTask(@PathVariable("name") String name){
        // å°†è¿™ä¸ªæ·»åŠ åˆ°åŠ¨æ€å®šæ—¶ä»»åŠ¡ä¸­å»
        if(!dynamicTask.stop(name)){
            return "åœæ­¢å¤±è´¥,ä»»åŠ¡å·²åœ¨è¿›è¡Œä¸­.";
        }
        return "ä»»åŠ¡å·²åœæ­¢";
    }

}
å¤åˆ¶ä»£ç </code></pre> 
<p>ç®€å•å°è£…çš„ä¸€ä¸ªå®ä½“ç±»ï¼š</p> 
<pre><code>/**
 * @Author: crush
 * @Date: 2021-07-29 15:35
 * version 1.0
 */
@Data
@Accessors(chain = true) // æ–¹ä¾¿é“¾å¼ç¼–å†™ ä¹ æƒ¯æ‰€ç„¶ 
public class Task {
    /**
     * åŠ¨æ€ä»»åŠ¡åæ›¾
     */
    private String name;

    /**
     * è®¾å®šåŠ¨æ€ä»»åŠ¡å¼€å§‹æ—¶é—´
     */
    private LocalDateTime start;
}
å¤åˆ¶ä»£ç </code></pre> 
<h4>3.4ã€æ•ˆæœ</h4> 
<p>ğŸ’«ğŸ’¨</p> 
<p>å¼€å¯ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡ï¼š</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/09/d7/vlUEbtQb_o.png"></p> 
<p>æŸ¥çœ‹å¼€å¯è¿˜æœªæ‰§è¡Œçš„åŠ¨æ€ä»»åŠ¡ï¼š</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/29/4a/XwJZb3rl_o.png"></p> 
<p>æ‰§è¡Œç»“æœï¼š</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/c7/5d/6avIYcZn_o.png"></p> 
<p>å’Œæˆ‘ä»¬ä»£ç ä¸­æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/03/4a/3UdSXfqn_o.png"></p> 
<p>åœæ­¢ä»»åŠ¡ï¼š</p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/46/e3/dAzmykWP_o.png"></p> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/63/25/ONONGI9e_o.png"></p> 
<p>å†å»æŸ¥çœ‹å°±æ˜¯å·²ç»åœæ­¢çš„æ‹‰</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9b7f76357b5457688005515ed33b9c32/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">pipé•œåƒå®‰è£…ä»£ç </p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/732316599221699f8af53d338f015337/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">GAMES101-ç°ä»£è®¡ç®—æœºå›¾å½¢å­¦å…¥é—¨-é—«ä»¤çªâ€”â€”ç¬¬ä¸€èŠ‚</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 è¿½é£å°‘å¹´çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>